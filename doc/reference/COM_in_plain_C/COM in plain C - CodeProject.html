<!DOCTYPE html>
<html lang="en" class=" qgspzs ofspwdt vojfmstxs idc0_348"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

	

	
	<link rel="preconnect" href="https://apps.developermedia.com/">
	<link rel="preconnect" href="https://cdn1.developermedia.com/">
	<link rel="preconnect" href="https://cdn.ampproject.org/">
	<link rel="preconnect" href="https://fonts.googleapis.com/">
	<link rel="preconnect" href="https://ajax.googleapis.com/">
	<link rel="preconnect" href="https://adservice.google.com/">
	<link rel="preconnect" href="https://www.googletagservices.com/">
	<link rel="preconnect" href="https://www.googletagmanager.com/">
	<link rel="preconnect" href="https://www.google.com/">
	<link rel="preconnect" href="https://www.google-analytics.com/">
	<link rel="preconnect" href="https://pagead2.googlesyndication.com/">

	<link rel="preconnect" href="https://codeproject.freetls.fastly.net/">


	<link rel="preload" href="COM%20in%20plain%20C%20-%20CodeProject_files/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="COM%20in%20plain%20C%20-%20CodeProject_files/jquery-3.4.1.min.js" as="script" type="text/javascript">


	<title>COM in plain C - CodeProject</title> 
    
	<!-- inlined file /App_Themes/CodeProject/Css/article.critical.min.css. Minimized in Release. -->
<style type="text/css">
.blank-background{background-color:#fff}html,div,span,applet,object,iframe,a,abbr,acronym,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,fieldset,form,label,table,tbody,tfoot,thead,tr,th,td,li,ol,ul{margin:0;padding:0;border:0}html{font-size:16px;-webkit-font-smoothing:antialiased;font-smooth:always}body,p,h1,h2,h3,h4,h5,h6,li,tr,td,th,dd,dt{font-family:"Segoe UI",Arial,Sans-Serif;font-size:16px;line-height:1.4;color:#111}body{margin:0}h1,h3,h4,h5,th{font-weight:bold}h1{color:#333;padding:0;margin:0 0 7px;text-align:left}h2{margin:20px 0 11px;padding:0;padding-bottom:10px;color:#333}h1{font-size:38px;font-weight:400}h2{font-size:29px;font-weight:400}h4{font-size:17px}table{background-color:Transparent}img{-ms-interpolation-mode:bicubic}a{text-decoration:none;color:#005782}a:visited{color:#800080}a:hover{text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}input[type="text"],input[type="url"],input[type="search"],input[type="email"],input[type="number"],input[type="password"],select,textarea{border:1px solid #d7d7d7;font-size:16px;padding:5px}a.button,a.button-large,.button,.button-large{color:#fff;background-color:#e08900;border:1px solid #ccc;text-decoration:none;white-space:nowrap;font-size:100%;padding:4px;cursor:pointer;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}table.small-text td,ul.small-text li,ol.small-text li,.small-text{font-size:14px}.invisible{display:none}.subdue,.subdue li,tr.subdue td{color:#808080}.align-left{text-align:left}.align-right{text-align:right}.align-center{text-align:center}.float-right{float:right}.float-left{float:left}.sticky{position:sticky;top:0}.extended{width:100%;box-sizing:border-box}.padded-top{padding-top:20px}.tight{margin:0;padding:0}.nowrap{white-space:nowrap}.fixed-layout{table-layout:fixed}.clipped{overflow:hidden}.raised{background-color:#fff8df;border:1px solid #ccc;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}ol,ul{padding-left:40px;margin:10px 0}ol.compact li,ul.compact li,ol li.compact,ul li.compact{font-size:14px}.callout{margin:20px 0;background-color:#ffffe1;color:#333;border:1px solid #ccc;padding:15px;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}.trace{padding:20px;background-color:#eee;color:#333;border:1px solid #f00;font-size:13px}textarea,input[type="text"],input[type="button"],input[type="submit"]{-webkit-appearance:none;border-radius:0}.container-content{background-color:#fff;position:relative;zoom:1;padding:0 9px;cursor:default}.container-content-wrap{margin:auto;max-width:1270px}.flex-container{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.flex-extend{justify-content:space-between}.flex-wrap{flex-wrap:wrap}.flex-item{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.flex-item-tight{flex:0 1 auto}.hover-container{display:block;position:relative}.clearfix:after,.container:after{display:block;content:'.';visibility:hidden;height:0;clear:both}.clearfix,.container{display:inline-block;display:block}.access-link,.access-link img{position:absolute;top:0;left:0;width:1px;height:1px;z-index:101;border-style:none;margin-top:-1px;overflow:hidden}.site-top-menu{white-space:nowrap;position:absolute;z-index:101;width:100%}.site-top-menu .main-content{width:100%}.site-top-menu .main-content .memberbar{margin-left:90px;margin-right:10px}.site-top-menu.fixed .main-content{margin:auto;max-width:1270px}.site-header{background-image:url('/App_Themes/CodeProject/Img/logo135-bg.gif');white-space:nowrap;overflow:hidden}.site-header .main-content{position:relative;overflow:hidden;white-space:nowrap}.site-header .logo{display:inline-block}.site-header .promo{display:inline-block;position:absolute;top:33px;right:0}.site-header.fixed .main-content{margin:auto;max-width:1270px}.sub-headerbar{padding-right:9px;position:relative;margin:auto;max-width:1270px}.sub-headerbar-divider{margin-left:10px;height:1px;border-bottom:1px solid #ccc;position:absolute;bottom:2px;left:0;right:9px}.memberbar{height:25px;padding-top:10px;color:#999;font-size:14px}.memberbar a{color:#808080;font-size:14px}div.navbar{white-space:nowrap}.navmenu{background:#fff;color:#4d4d4d;padding:0;margin:0;list-style:none;height:25px}.navmenu ul,.navmenu li{margin:0;padding:0}.navmenu .has-submenu{position:absolute;right:5px;padding-left:10px}.navmenu>li:hover>a,.navmenu>li>a:active{border:1px solid #ccc}.navmenu ul,.navmenu>li.open:hover>a,.navmenu>li.open>a:active{border:1px solid #ccc;border-bottom-color:#fff}.navmenu>li{margin:0 11px 2px 2px}.navmenu>li:active,.navmenu>li:active>a,.navmenu>li:hover,.navmenu>li>a:active{background:#fff;color:#4d4d4d}.navmenu>li>a{padding:2px 7px 6px 7px;border:1px solid transparent;font-weight:bold}.navmenu a{display:block;float:left;color:#666;background:#fff;font-size:17px;padding:0 9px;text-decoration:none;white-space:nowrap}.navmenu a.fly{white-space:nowrap}.navmenu ul{background:#fff;position:absolute;left:-9999px;top:-9999px;list-style:none}.navmenu li{float:left;color:#4d4d4d}.navmenu li.last{height:9px}.navmenu li a:active,.navmenu li a:hover{color:#fff;background-color:#f90}.navmenu li>a:active,.navmenu li:hover,.navmenu li:hover>a,.navmenu li:hover.heading,.navmenu li a.selected{position:relative;color:#fff;background-color:#f90}.navmenu li.openable:hover ul{left:0;top:30px;z-index:500}.navmenu li.openable:hover>ul ul{position:absolute;left:-9999px;top:-9999px;width:auto}.navmenu li.open{position:relative}.navmenu li.open a{color:#fff;background-color:#f90}.navmenu li.open ul{left:0;top:30px;z-index:500}.navmenu li ul{border-bottom:5px solid #f90}.navmenu li li{float:none}.navmenu li li:active>a.fly,.navmenu li li:hover>a.fly{color:#fff;background-color:#f90}.navmenu li li a{float:none;font-size:16px;font-weight:normal}.navmenu li li a.fly{color:#4d4d4d;background-color:#fff;padding:2px 20px}.navmenu li li a.break{margin-bottom:15px}.navmenu li li a.highlight1,.navmenu li li a.highlight1:active,.navmenu li li a.highlight1:hover{background-color:#090}.navmenu li li a.highlight2,.navmenu li li a.highlight2:active,.navmenu li li a.highlight2:hover{background-color:#f90}.navmenu li li a.highlight3,.navmenu li li a.highlight3:active,.navmenu li li a.highlight3:hover{background-color:#000}.navmenu li li a.highlight1,.navmenu li li a.highlight2,.navmenu li li a.highlight3{color:#fff;font-size:16px;margin:5px 0;padding:9px 20px}.site-footer{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;padding-top:5px;width:100%;font-size:13px;color:#999}.site-footer .align-left,.site-footer .align-center,.site-footer .align-right{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.site-footer .align-left{flex:1 0 100px}.site-footer .align-center{flex:0 1 0%;white-space:nowrap}.site-footer .align-right{flex:1 0 100px}.site-footer .page-width .active{border-bottom:2px solid #f90}.searchbar{padding:0}.searchbar .search{margin-bottom:4px;padding:2px 5px 0;border:1px solid #ccc}.searchbar .search.subdue{color:#ccc}.searchbar input.search{width:190px;border:none;font-size:13px;padding:4px 2px}.searchbar .search-advanced{padding:8px;width:203px;z-index:1000;background-color:#fff;border:solid 1px #ccc;position:absolute;top:-4px;right:0}.searchbar .popup{display:none}.search td{background-color:#fff}.article-container-parts{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.article-container{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;background-color:#fff;color:#111;zoom:1;position:relative;max-width:100%;min-height:675px}.article-container .article{margin:0 20px 0 10px;line-height:143%}.article-container span.stats{margin-left:30px}.article-left-sidebar{width:120px;min-width:120px;min-height:400px;font-size:14px;border-right:1px solid #f2f2f2;padding:0}.article-left-sidebar .article-left-sidebar-inner{width:120px;min-width:120px}.article-left-sidebar .tabs>div{padding:5px 0 5px 10px}.article-left-sidebar .selected{font-weight:bold;background:transparent url("/images/right-selected.gif") no-repeat scroll right 9px}.article-left-sidebar .original{color:#808080;margin:-10px 0 0 15px}.article-left-sidebar h4{color:#f90;font-size:14px;font-weight:bold}.article-left-sidebar .stats div div div{padding:0 0 10px 10px;color:#666}.article-right-sidebar{width:300px;margin-left:10px;font-size:14px}.article-right-sidebar .gototop{text-align:center;padding:10px 0;opacity:0;-webkit-transition:opacity .3s linear 0ms;-moz-transition:opacity .3s linear 0ms;-o-transition:opacity .3s linear 0ms;transition:opacity .3s linear 0ms}.container-content .edit-links{margin:21px 0 0 10px}.article-summary{padding:0 10px 0 10px;overflow:hidden}.article h1{margin:0 0 15px 0}.article h2{color:#f90}.article .header .title{color:#808080}.article .header .author{font-weight:bold;min-width:100px}.article .header .author a{color:#808080}.article .header .avatar{max-width:48px;max-height:48px;overflow:unset}.article .header .avatar-wrap{width:48px;height:48px;margin-right:10px;text-align:center}.article .header .date{white-space:nowrap}.article .header .license{margin-left:15px}.article .header .stats{margin-left:30px}.article .summary{color:#808080;padding:40px 0 15px 0}.article .text{padding-top:10px}.article-nav{text-align:right;margin-top:21px;vertical-align:middle;line-height:15px}span.math{display:inline-block}.msg-728x90{width:728px;height:90px;overflow:hidden}.msg-300x250{width:300px;height:250px;overflow:hidden}.tags{line-height:190%}.tags .t{background:none repeat scroll 0 0 transparent;border:1px solid #fbedbb;border-radius:12px 0 0 12px;line-height:1.4;padding:0 2px 2px 3px;position:relative;text-decoration:none;margin:2px 5px 4px 0;white-space:nowrap}.tags .t a{color:#666;display:inline-block;margin-right:3px;padding-left:5px;text-overflow:ellipsis}.container-breadcrumb{font-size:14px;margin-top:7px;color:#808080;margin:12px 0 35px}.container-breadcrumb a{color:#808080}.speech-bubble-container-down,.speech-bubble-container-up,.speech-bubble-container-up-right,.speech-bubble-container-left,.speech-bubble-container-right{position:relative}.ie .speech-bubble-container-up,.firefox .speech-bubble-container-up,.chrome .speech-bubble-container-up,.ie .speech-bubble-container-up-right,.firefox .speech-bubble-container-up-right,.chrome .speech-bubble-container-up-right{margin-top:-4px}.tooltip{position:relative;text-decoration:none}.tooltip .speech-bubble-container-up,.tooltip .speech-bubble-container-down,.tooltip .speech-bubble-container-left,.tooltip .speech-bubble-container-right,.tooltip .speech-bubble-container-up-right,.tooltip .tooltip-flyout{display:none;opacity:0;-webkit-transition:opacity .5s linear 0ms;-moz-transition:opacity .5s linear 0ms;-o-transition:opacity .5s linear 0ms;transition:opacity .5s linear 0ms}.micromodal{display:none}.bottom-promo{height:90px;margin-top:10px;overflow:hidden}.bottom-promo .msg-728x90{width:728px;margin:0 auto}.msg-728x90{overflow:hidden;position:relative;height:90px;min-width:728px}body .msg-728x90{*float:right}body .bottom-promo .msg-728x90{*float:none}table.forum{table-layout:fixed;margin:0 0 20px 0;padding:0;width:100%}.forum table{border-collapse:separate}.forum .header1,.forum .header1 TD{color:#333;font-size:14px;vertical-align:middle}.forum .header2,.forum .header2 TD{color:#fff;background-color:#f90;font-size:14px;vertical-align:middle}.forum .header2 input,.forum .header2 TD input,.forum .header2 select,.forum .header2 TD select{padding:2px}.forum .button{border:1px solid #fc6;margin:1px}.forum .searchbar{border:1px solid #ccc;padding:4px 0 0 0;margin:3px 0}.forum .searchbar .search{width:200px}.forum .searchbar input[type=image]{vertical-align:middle}.forum .dropdown{background-color:#fffdfa;font-size:95%;margin-left:5px}.forum .footer,.forum .footer td,.forum .navbar,.forum .navbar td{font-size:14px;padding:8px 0;border:0;border-top:1px solid #808080}.author-wrapper{position:relative}.author-wrapper .profile-pic{border:1px solid #333;margin:0 13px 0 0;padding:10px;-moz-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);-webkit-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);max-height:100px}.author-wrapper .container-member .author{font-size:29px;color:#333;font-weight:600}.rating-container .rating-prompt{padding-right:5px;white-space:nowrap;line-height:25px;margin-right:2px;font-weight:bold;color:#808080}.rating-container .rating-votes{margin-left:5px}.rating-container.large-stars,.rating-container.medium-stars,.rating-container.small-stars{margin-left:7px}.rating-container.large-stars .rating-votes,.rating-container.large-stars .rating-prompt,.rating-container.large-stars .rating-poor,.rating-container.large-stars .rating-good{line-height:25px}@media(min-width:1024px){.desktop-lg-block-only{display:none}.desktop-only{display:inherit}.desktop-block-only{display:block}.tablet-only,.tablet-block-only{display:none}.mobile-only,.mobile-block-only{display:none}.desktop-only.tablet-only{display:inherit}.desktop-block-only.tablet-block-only{display:block}}@media(min-width:821px){.desktop-lg-block-only{display:none}.tablet-only,.mobile-only{display:none}.tablet-block-only,.mobile-block-only{display:none}.tablet-only.desktop-only{display:inherit}.tablet-block-only.desktop-block-only{display:block}}.rrssb-buttons,.rrssb-buttons li,.rrssb-buttons li a{-moz-box-sizing:border-box;box-sizing:border-box}.clearfix{*zoom:1}.clearfix:after{clear:both}.clearfix:before,.clearfix:after{content:" ";display:table}.rrssb-buttons{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;height:40px;margin:0;padding:0;width:100%}.rrssb-buttons li{float:left;height:100%;list-style:none;margin:0;padding:0 2.5px;line-height:13px}.rrssb-buttons li.email a{background-color:#0a88ff}.rrssb-buttons li.facebook a{background-color:#306199}.rrssb-buttons li.linkedin a{background-color:#007bb6}.rrssb-buttons li.twitter a{background-color:#26c4f1}.rrssb-buttons li.reddit a{background-color:#8bbbe3}.rrssb-buttons li.pinterest a{background-color:#b81621}.rrssb-buttons li.compact{padding:0 4.5px}.rrssb-buttons li.compact a{border-radius:50%;padding:0 7px 0 32px}.rrssb-buttons li.compact a .icon{left:7px;top:-3px;width:5%;transform:scale(.85)}.rrssb-buttons li.compact a .icon svg{height:auto;width:auto}.rrssb-buttons li a{background-color:#ccc;border-radius:3px;display:block;font-size:11px;font-weight:bold;height:100%;padding:11px 7px 12px 27px;position:relative;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:100%;-webkit-transition:background-color .2s ease-in-out;-moz-transition:background-color .2s ease-in-out;-o-transition:background-color .2s ease-in-out;transition:background-color .2s ease-in-out}.rrssb-buttons li a .icon{display:block;height:100%;left:10px;padding-top:9px;position:absolute;top:0;width:10%}.rrssb-buttons li a .icon svg{height:17px;width:17px}.rrssb-buttons li a .icon svg path,.rrssb-buttons li a .icon svg polygon{fill:#fff}
</style>
<link rel="stylesheet" type="text/css" href="COM%20in%20plain%20C%20-%20CodeProject_files/Main.min.css" media="all" onload="if(media!='all')media='all'">
<noscript><link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8:2023-08-14:1"></noscript>


    <script type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/jquery-3.4.1.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/article.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/client" defer="defer" async=""></script>
<script type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/advertisement.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/MemberProfilePopup.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/a.min.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="How to create/use COM components in plain C, without MFC, ATL, WTL, or any other framework.">
<meta name="Keywords" content="VC6, VS6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="3/29/2006 2:16:00 AM">
<meta property="article:modified_time" content="3/29/2006 2:16:00 AM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Jeff Glatt">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="34 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/13601/COM-in-plain-C">
<meta property="og:title" content="COM in plain C">
<meta property="og:description" content="How to create/use COM components in plain C, without MFC, ATL, WTL, or any other framework.">
<meta property="og:image" content="https://www.codeproject.com/KB/COM/com_in_c1/Thumbnail.gif">
<meta name="twitter:image" content="https://www.codeproject.com/KB/COM/com_in_c1/Thumbnail.gif">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Python" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=34">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">

<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/13601/COM-in-plain-C"
   },
  "name": "COM in plain C",
  "headline": "COM in plain C",
  "url": "https://www.codeproject.com/Articles/13601/COM-in-plain-C",
  "discussionUrl": "https://www.codeproject.com/Articles/13601/COM-in-plain-C#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/COM/com_in_c1/Thumbnail.gif",
  "keywords": "VC6,VS6,C++,C,Windows,Visual-Studio,Dev,COM,Beginner",
  "commentCount": "236",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "How to create/use COM components in plain C, without MFC, ATL, WTL, or any other framework.",
  "articleSection": "C",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-03-29",
  "dateCreated": "2006-03-29",
  "dateModified": "2006-03-29"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.98,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Languages",
      "name" : "Programming Languages"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=C",
      "name" : "C"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/13601/COM-in-plain-C" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-YZNPNQ0F2S' );
    </script>

<style type="text/css"></style><link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="COM%20in%20plain%20C%20-%20CodeProject_files/style.css"><style id="googleidentityservice_button_styles">.qJTHM{-moz-user-select:none;color:#202124;direction:ltr;font-family:"Roboto-Regular",arial,sans-serif;font-weight:400;margin:0;overflow:hidden}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-moz-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;transition:background-color .218s,border-color .218s;-moz-user-select:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;flex-direction:row;justify-content:space-between;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-moz-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><style></style><link href="data:text/css,%5Bid*%3D'google_ads_iframe'%5D%2C%5Bid*%3D'taboola-'%5D%2C.taboolaHeight%2C.taboola-placeholder%2C%23credential_picker_container%2C%23credentials-picker-container%2C%23credential_picker_iframe%2C%5Bid*%3D'google-one-tap-iframe'%5D%2C%23google-one-tap-popup-container%2C.google-one-tap-modal-div%2C%23amp_floatingAdDiv%2C%23ez-content-blocker-container%2C%23notify-adblock%7Bdisplay%3Anone!important%3Bmin-height%3A0!important%3Bheight%3A0!important%3B%7D" rel="stylesheet" type="text/css"></head>	

<body class="firefox firefox116"><div class="cc-revoke cc-bottom cc-animate cc-color-override--316233370" style="display: none;">Cookie Policy</div><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-banner cc-type-opt-in-out cc-theme-edgeless cc-bottom cc-color-override--316233370 " style=""><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href="https://www.codeproject.com/info/cookie.aspx">Cookie Policy</a>, <a href="https://www.codeproject.com/info/privacy.aspx">Privacy Policy</a>, and our <a href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Service</a>. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://www.codeproject.com/info/privacy.aspx" rel="noopener noreferrer nofollow" target="_blank">Learn more</a></span><div class="cc-compliance cc-highlight"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Ask me later</a><a aria-label="deny cookies" role="button" tabindex="0" class="cc-btn cc-deny">Decline</a><a aria-label="allow cookies" role="button" tabindex="0" class="cc-btn cc-allow">Allow cookies</a></div><!--googleon: all--></div>

	<div id="ctl00_OneTap_OneTap">
    <div id="g_id_onload" data-client_id="857795997829.apps.googleusercontent.com" data-login_uri="/script/Membership/OAuthLogOn.aspx?auth=Google">
    </div>
</div>



	<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">15,723,129 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f13601%2fCOM-in-plain-C"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f13601%2fCOM-in-plain-C"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin">
				<a data-micromodal-trigger="modal-1" href="javascript:;">Sign in</a>
				<!--<a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f13601%2fCOM-in-plain-C">Sign in</a>-->

				<div class="micromodal" id="modal-1" aria-hidden="true">

					<div class="modal__overlay" tabindex="-1" data-micromodal-close="">
					  <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">

						<header class="modal_header">
							<h4 class="modal_title" id="modal-1-title">
								Sign in
							</h4>
							<button class="modal_close" aria-label="Close modal" data-micromodal-close=""></button>
						</header>

						<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f13601%2fCOM-in-plain-C" method="post" class="tight align-left">

							
							<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

							<div>Email</div>
							<div><input type="email" name="Email" id="Email" autocomplete="email" data-ddg-inputtype="credentials.username"></div>
							<div>Password</div>
							<div><input type="password" name="Password" id="Password" autocomplete="current-password" data-ddg-inputtype="credentials.password"></div>
							<div class="action">
								<input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
								<input type="hidden" name="fld_quicksign" value="true">
								<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
							</div>

							<div class="container">						
								<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Articles/13601/COM-in-plain-C">Forgot your password?</a>
							</div>
						</form>

						<hr class="divider-dark">

						Sign in with &nbsp;<a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/octicons_github-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/facebook-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/google-plus-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/microsoft-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>



					  </div>
					</div>
				  </div>

            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesC" data-country="US" data-tags="VC6, VS6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=32983"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=32983"  width="728px" height="90px" target="_blank"/></a></noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar flex-container flex-extend flex-wrap fixed">
		<div class="flex-item" style="min-width:20rem">
			

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Browse Topics<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=268" style="padding-left:30px">View Python questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=91" style="padding-left:30px">View Java questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_CodeProjectAI" class="fly" href="https://www.codeproject.com/Feature/CodeProjectAI-Discussions.aspx">CodeProject.AI Server</a></li>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1969389/Artificial-Intelligence">Artificial Intelligence</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1969388/Internet-of-Things">Internet of Things</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1988311/Python">Python</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/WPF">WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">features</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_SiteBlog" class="fly break" href="https://www.codeproject.com/Members/CodeProject#_comments">The CodeProject Blog</a></li>

		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
		</div>
		<div class="flex-item-tight align-right">
			

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q" data-ddg-inputtype="unknown"></td><td><input type="image" src="COM%20in%20plain%20C%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
		</div>
		<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Languages">Programming Languages</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=C">C</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C%20-%20CodeProject_files/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner sticky">

                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=13601">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=13601">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=13601">Revisions</a></div>
<div><a href="#_comments">Comments (236)</a></div>
<div>Posted 28 Mar 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VC6" data-id="4">VC6</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VS6" data-id="51">VS6</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>1.1M views</div><div>10.6K downloads</div><div>617 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="DtnzxPJZ1AWliGWAZhElitW21n5wyyMG3mFy7L6iW+nCH77kv/Bv4SYl4XYQdsCTN3ehh3SN1QA6oTGatEknrlDFLgavu8YjR06d5HX7GtDWIqQmGdrUcNa2ZZwuxVlvJ49ggcVZlFRSi8cnwpU7DzrGrw+VwVCcURRIUT1vEFj/49II7kpNuhtYp9LELJkPdZFLG0j3jfNEmw0iuCxMIoe0+/Hdd/YQ4GHUOFKQxBzCFQHCGgPoB9BwblDJekRms8D+kP4iO2kKjEMhuOshVS9p296FGEoZArLtVVzbQmi4PRg9QS/ko1YlaGCrq5x3ECUPlepw6/f6xWpC9PLAZfr/GFalhnsgdgYqbF+2MRb1qZyGkIY0tavrrilag7opOtTuII0Asg8+njg3S7mIFGg8r21UGcilWmvZOyYnGOnQCnCZ5xE3EL1LFd3VWuOEKJFtkOYFIACHSSyAR/S2Sdgb++NptQ/nJ0jF1IbcEi8wvinZTPogfYsGtYQ837dm23S/Dczf18S0wqIGmF/lS241ygton3caFuIy95gl9jKbBeCl0/ImHPce+lz3V8TWsqcDZ16k0JSqNf6rhweAvAR05dr2DKpXIJL5jMhWSooJgU7t5PIC6WN2/PIE2z5cbZHnFWHAv9tnRcmUdxmYOaeS4qvxOrtMSgDQhOrpskQX+szzLdMHZKDwWSSN5lbMEZpoxW7/c+we1TXFQuVbfb8CNA1P0aENxsdx/MWJtdiZOEtTZhIN/ShLqLA1w3WzT9EznAHxCqJIH+NpiWIYv7Tx2l1Lk/z6fagMxZEZcrC5sCrVkNKtmblQ6uMW604F8e/xpZLV0w6X1zstcXzEJSMj2ocKqciACaZ2XA3qqWiilXZDY7JsJeKX0rcZj5sDsQxXhJCDxWYzje9wSH6og63c8yiZy/97qTRkXlkNQNZwIy7aPhhF/1JvVlPyPL3og3Y/3qwHno3x3hwbYtQInG3+K/q643+PGUy1W0qpoI5iLsdJEPTAVyX+vZilEab8HG9ZLBG6rnX4Ah8r27f1XzZru/QgE7vwB9sw7q3jtC7DBdS55dJNoezHMp8L7aRf07FYR12RX+OxGmTIYbsxIL98JcJGQmtmHndPQqUH5TVUSOwBytG7n92E+hP78PfoOgk5vUDwL+ow4iM9llZK+s2ONBpqSvc+Y2GecOnaWIVlC3RB1C248U+tQSa2jcCHpxeJ5/1lYPWOhnNDejRmNANkK1rVA1kyqX/F8CIW5au0h7t6rYrchyEBJ6PEZ+qGGZGhLw9R8bTxaMOWTEWVTcCtfUdjH7xBhKnu9J0vxIqGwXTsWWwMAa8d7HuwglM7KDl9Mx15ttSvNp1Bdnl7WWYJ1VjjdRykvoZmMKkpSkYdI8qCn0X+7Qmi+jeOp6DeYicVLivcwtoLV0tJLnpkS0ek3hLDPl+AOIlJYHP10suelk/iO3PYHeMfdo5Qy71tyF9oKoMnoiFhcwkaPaJ8Uq0dvew+1dzG+QxXooRnsatL1pDOeRkpVKKWg9HHoHjIbcLm3/BiAdSzN0W3nTgqSRUYZF3ZTFqr2rKbZ7Wtbjurr+w3aEcZEZpBYX9INO/vLaKyPu62lyORvGUU87C6hRuj5+vn6W3v4KhXTuI9lFV5zTVaNX6VCI8MTA6hArHxr7gx8v18Af55mnR7C0hISntPAnoYe2iGyur2du5eWMZ0c1QN+SlBVkKZNB2pKJcdrSjnOd7I0T+slPbvidmule05dfAQ1Oxz5DCxqQ3hSAKZhejGyyxwYexbNECb37VXaFbBBl555/ix+Ma+yISKzALPXtbOYEh3lgWyNo3em12KtYiK">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_13601_1">

	<meta itemprop="upvoteCount" content="492">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="COM%20in%20plain%20C%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:23px;" class="clipped"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:1px;position:relative" class="clipped"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f13601%2fCOM-in-plain-C">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.98/5  (502 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">28 Mar 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">34 min read</span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">How to create/use COM components in plain C, without MFC, ATL, WTL, or any other framework.</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/KB/COM/com_in_c1/Thumbnail.gif"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c1/com_in_c1_src.zip">Download source files - 17.6 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#VTABLE">A COM object and its VTable</a> 
</li><li><a href="#GUID">A GUID</a> 
</li><li><a href="#FUNCS">QueryInterface(), AddRef(), and Release()</a> 
</li><li><a href="#CLASS">An IClassFactory object</a> 
</li><li><a href="#DLL">Packaging into a DLL</a> 
</li><li><a href="#H">Our C++/C include file</a> 
</li><li><a href="#DEF">The Definition (DEF) file</a> 
</li><li><a href="#REG">Install the DLL, and register the object</a> 
</li><li><a href="#C">An example C program</a> 
</li><li><a href="#CPLUS">An example C++ program</a> 
</li><li><a href="#MOD">Modifying the code</a> 
</li><li><a href="#NEXT">What's next?</a> </li></ul>
<h2>Introduction</h2>
<p>There are numerous examples that demonstrate how to use/create 
COM/OLE/ActiveX components. But these examples typically use Microsoft 
Foundation Classes (MFC), .NET, C#, WTL, or at least ATL, because those 
frameworks have pre-fabricated "wrappers" to give you some boilerplate 
code. Unfortunately, these frameworks tend to hide all of the low level 
details from a programmer, so you never really do learn how to use COM 
components per se. Rather, you learn how to use a particular framework 
riding on top of COM.</p>
<p>If you're trying to use plain C, without MFC, WTL, .NET, ATL, C#, or 
even any C++ code at all, then there is a dearth of examples and 
information on how to deal with COM objects. This is the first in a 
series of articles that will examine how to utilize COM in plain C, 
without any frameworks.</p>
<p>With standard Win32 controls such as a Static, Edit, Listbox, Combobox, etc., you obtain a handle to the control (i.e., an <code>HWND</code>) and pass messages (via <code>SendMessage</code>)
 to it in order to manipulate it. Also, the control passes messages back
 to you (i.e., by putting them in your own message queue, and you fetch 
them with <code>GetMessage</code>) when it wants to inform you of something or give you some data.</p>
<p>Not so with an OLE/COM object. You don't pass messages back and 
forth. Instead, the COM object gives you some pointers to certain 
functions that you can call to manipulate the object. For example, one 
of Internet Explorer's objects will give you a pointer to a function you
 can call to cause the browser to load and display a web page in one of 
your windows. One of Office's objects will give you a pointer to a 
function you can call to load a document. And if the COM object needs to
 notify you of something or pass data to you, then you will be required 
to write certain functions in your program, and provide (to the COM 
object) pointers to those functions so the object can call those 
functions when needed. In other words, you need to create your own COM 
object(s) inside your program. Most of the real hassle in C will involve
 defining your own COM object. To do this, you'll need to know the 
minute details about a COM object -- stuff that most of the 
pre-fabricated frameworks hide from you, but which we'll examine in this
 series.</p>
<blockquote>
<p><b>In conclusion</b>, you call functions in the COM object to 
manipulate it, and it calls functions in your program to notify you of 
things or pass you data or interact with your program in some way. This 
scheme is analogous to calling functions in a DLL, but as if the DLL is 
also able to call functions inside your C program -- sort of like with a
 "callback". But unlike with a DLL, you don't use <code>LoadLibrary()</code> and <code>GetProcAddress()</code>
 to obtain the pointers to the COM object's functions. As we'll soon 
discover, you instead use a different operating system function to get a
 pointer to an object, and then use that object to obtain pointers to 
its functions.</p></blockquote>
<h2><a name="VTABLE">A</a> COM object and its VTable</h2>
<p>Before we can learn how to use a COM object, we first need to learn 
what it is. And the best way to do that is to create our own COM object.</p>
<p>But before we do that, let's examine a C <code>struct</code> data type. As a C programmer, you should be quite familiar with <code>struct</code>. Here's an example definition of a simple struct (called "<code>IExample</code>") that contains two members -- a <code>DWORD</code> (accessed via the member name "<code>count</code>"), and an 80 <code>char</code> array (accessed via the member name "<code>buffer</code>").</p><div class="pre-lang" id="premain748543"><div></div><div class="pre-action-link"><span id="copycode748543" class="copy-code" data-index="748543" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre748543" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">struct</span> IExample {
   DWORD   count;
   <span class="code-keyword">char</span>    buffer[80];
};</pre>
<p>Let's use a <code>typedef</code> to make it easier to work with:</p><div class="pre-lang" id="premain573936"><div></div><div class="pre-action-link"><span id="copycode573936" class="copy-code" data-index="573936" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre573936" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   DWORD   count;
   <span class="code-keyword">char</span>    buffer[80];
} IExample;</pre>
<p>And here's an example of allocating an instance of the above struct (error checking omitted), and initializing its members:</p><div class="pre-lang" id="premain445141"><div></div><div class="pre-action-link"><span id="copycode445141" class="copy-code" data-index="445141" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre445141" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">IExample * example;

example = (IExample *)GlobalAlloc(GMEM_FIXED, <span class="code-keyword">sizeof</span>(IExample));
example-&gt;count = <span class="code-digit">1</span>;
example-&gt;buffer[0] = <span class="code-digit">0</span>;</pre>
<p>Did you know that a struct can store a pointer to some function? 
Hopefully, you did, but here's an example. Let's say we have a function 
which is passed a <code>char</code> pointer, and returns a <code>long</code>. Here's our function:</p><div class="pre-lang" id="premain695155"><div></div><div class="pre-action-link"><span id="copycode695155" class="copy-code" data-index="695155" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre695155" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">long</span> SetString(<span class="code-keyword">char</span> * str)
{
   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}</pre>
<p>Now we want to store a pointer to this function inside <code>IExample</code>. Here's how we define <code>IExample</code>, adding a member ("<code>SetString</code>") to store a pointer to the above function (and I'll use a <code>typedef</code> to make this more readable):</p><div class="pre-lang" id="premain469502"><div></div><div class="pre-action-link"><span id="copycode469502" class="copy-code" data-index="469502" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre469502" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">long</span> SetStringPtr(<span class="code-keyword">char</span> *);

typedef <span class="code-keyword">struct</span> {
   SetStringPtr * SetString;
   DWORD          count;
   <span class="code-keyword">char</span>           buffer[80];
} IExample;</pre>
<p>And here's how we store a pointer to <code>SetString</code> inside our allocated <code>IExample</code>, and then call <code>SetString</code> using that pointer:</p><div class="pre-lang" id="premain834328"><div></div><div class="pre-action-link"><span id="copycode834328" class="copy-code" data-index="834328" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre834328" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">example-&gt;SetString = SetString;

<span class="code-keyword">long</span> <span class="code-sdkkeyword">value</span> = example-&gt;SetString(<span class="code-string">"</span><span class="code-string">Some text"</span>);</pre>
<p>OK, maybe we want to store pointers to two functions. Here's a second function:</p><div class="pre-lang" id="premain927863"><div></div><div class="pre-action-link"><span id="copycode927863" class="copy-code" data-index="927863" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre927863" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">long</span> GetString(<span class="code-keyword">char</span> *buffer, <span class="code-keyword">long</span> length)
{
   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}</pre>
<p>Let's re-define <code>IExample</code>, adding another member ("<code>GetString</code>") to store a pointer to this second function:</p><div class="pre-lang" id="premain636599"><div></div><div class="pre-action-link"><span id="copycode636599" class="copy-code" data-index="636599" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre636599" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">long</span> GetStringPtr(<span class="code-keyword">char</span> *, <span class="code-keyword">long</span>);

typedef <span class="code-keyword">struct</span> {
   SetStringPtr * SetString;
   GetStringPtr * GetString;
   DWORD          count;
   <span class="code-keyword">char</span>           buffer[80];
} IExample;</pre>
<p>And here we initialize this member:</p><div class="pre-lang" id="premain10479"><div></div><div class="pre-action-link"><span id="copycode10479" class="copy-code" data-index="10479" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre10479" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">example-&gt;GetString = GetString;</pre>
<p>But let's say we don't want to store the function pointers directly inside of <code>IExample</code>.
 Instead, we'd rather have an array of function pointers. For example, 
let's define a second struct whose sole purpose is to store our two 
function pointers. We'll call this a <code>IExampleVtbl</code> struct, and define it as so:</p><div class="pre-lang" id="premain851375"><div></div><div class="pre-action-link"><span id="copycode851375" class="copy-code" data-index="851375" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre851375" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   SetStringPtr * SetString;
   GetStringPtr * GetString;
} IExampleVtbl;</pre>
<p>Now, we'll store a pointer to the above array inside of <code>IExample</code>. We'll add a new member called "<code>lpVtbl</code>" for that purpose (and of course, we'll remove the <code>SetString</code> and <code>GetString</code> members since they've been moved to the <code>IExampleVtbl</code> struct):</p><div class="pre-lang" id="premain3383"><div></div><div class="pre-action-link"><span id="copycode3383" class="copy-code" data-index="3383" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre3383" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   IExampleVtbl * lpVtbl;
   DWORD          count;
   <span class="code-keyword">char</span>           buffer[80];
} IExample;</pre>
<p>So here's an example of allocating and initializing a <code>IExample</code> (and of course, a <code>IExampleVtbl</code>):</p><div class="pre-lang" id="premain788580"><div></div><div class="pre-action-link"><span id="copycode788580" class="copy-code" data-index="788580" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre788580" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> Since the contents of IExample_Vtbl will never change, we'll</span>
<span class="code-comment">//</span><span class="code-comment"> just declare it static and initialize it that way. It can</span>
<span class="code-comment">//</span><span class="code-comment"> be reused for lots of instances of IExample.</span>
<span class="code-keyword">static</span> <span class="code-keyword">const</span> IExampleVtbl IExample_Vtbl = {SetString, GetString};

IExample * example;

<span class="code-comment">//</span><span class="code-comment"> Create (allocate) a IExample struct.</span>
example = (IExample *)GlobalAlloc(GMEM_FIXED, <span class="code-keyword">sizeof</span>(IExample));

<span class="code-comment">//</span><span class="code-comment"> Initialize the IExample (ie, store a pointer to</span>
<span class="code-comment">//</span><span class="code-comment"> IExample_Vtbl in it).</span>
example-&gt;lpVtbl = &amp;IExample_Vtbl;
example-&gt;count = <span class="code-digit">1</span>;
example-&gt;buffer[0] = <span class="code-digit">0</span>;</pre>
<p>And to call our functions, we do:</p><div class="pre-lang" id="premain666222"><div></div><div class="pre-action-link"><span id="copycode666222" class="copy-code" data-index="666222" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre666222" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">char</span> buffer[80];

example-&gt;lpVtbl-&gt;SetString(<span class="code-string">"</span><span class="code-string">Some text"</span>);
example-&gt;lpVtbl-&gt;GetString(buffer, <span class="code-keyword">sizeof</span>(buffer));</pre>
<p>One more thing. Let's say we've decided that our functions may need to access the "<code>count</code>" and "<code>buffer</code>"
 members of the struct used to call them. So, what we'll do is always 
pass a pointer to that struct as the first argument. Let's rewrite our 
functions to accommodate this:</p><div class="pre-lang" id="premain934333"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="934333" id="preShrink934333">Shrink </span> &nbsp; <span id="copycode934333" class="copy-code" data-index="934333" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre934333" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">long</span> SetStringPtr(IExample *, <span class="code-keyword">char</span> *);
typedef <span class="code-keyword">long</span> GetStringPtr(IExample *, <span class="code-keyword">char</span> *, <span class="code-keyword">long</span>);

<span class="code-keyword">long</span> SetString(IExample *this, <span class="code-keyword">char</span> * str)
{
   DWORD  i;

   <span class="code-comment">//</span><span class="code-comment"> Let's copy the passed str to IExample's buffer</span>
   i = lstrlen(str);
   <span class="code-keyword">if</span> (i &gt; <span class="code-digit">79</span>) i = <span class="code-digit">79</span>;
   CopyMemory(this-&gt;buffer, str, i);
   this-&gt;buffer[i] = <span class="code-digit">0</span>;

   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}

<span class="code-keyword">long</span> GetString(IExample *this, <span class="code-keyword">char</span> *buffer, <span class="code-keyword">long</span> length)
{
   DWORD  i;

   <span class="code-comment">//</span><span class="code-comment"> Let's copy IExample's buffer to the passed buffer</span>
   i = lstrlen(this-&gt;buffer);
   --length;
   <span class="code-keyword">if</span> (i &gt; length) i = length;
   CopyMemory(buffer, this-&gt;buffer, i);
   buffer[i] = <span class="code-digit">0</span>;

   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}</pre>
<p>And let's pass a pointer to the <code>IExample</code> struct when calling its functions:</p><div class="pre-lang" id="premain271008"><div></div><div class="pre-action-link"><span id="copycode271008" class="copy-code" data-index="271008" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre271008" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">example-&gt;lpVtbl-&gt;SetString(example, <span class="code-string">"</span><span class="code-string">Some text"</span>);
example-&gt;lpVtbl-&gt;GetString(example, buffer, <span class="code-keyword">sizeof</span>(buffer));</pre>
<p>If you've ever used C++, you may be thinking <i>"Wait a minute. This seems strangely familiar."</i> It should. What we've done above is to recreate a C++ class, using plain C. The <code>IExample</code>
 struct is really a C++ class (one that doesn't inherit from any other 
class). A C++ class is really nothing more than a struct whose first 
member is always a pointer to an array -- an array that contains 
pointers to all the functions inside of that class. And the first 
argument passed to each function is always a pointer to the class (i.e.,
 struct) itself. (This is referred to as the hidden "<code>this</code>" pointer.)</p>
<p>At its simplest, a COM object is really just a C++ class. You're thinking <i>"Wow! <code>IExample</code> is now a COM object? That's all there is to it?? That was easy!"</i> Hold on. <code>IExample</code>
 is getting closer, but there's much more to it. It's not that easy. If 
it were, this wouldn't be a "Microsoft technology", now would it?</p>
<p>First of all, let's introduce some COM technobabble. You see that array of pointers above -- the <code>IExampleVtbl</code> struct? COM documentation refers to that as an <b>interface</b> or <b>VTable</b>.</p>
<p>One requirement of a COM object is that the first three members of our VTable (i.e., our <code>IExampleVtbl</code> struct) must be called <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>.
 And of course, we have to write those three functions. Microsoft has 
already determined what arguments must be passed to these functions, 
what they must return, and what calling convention they use. We'll need 
to <code>#include</code> some Microsoft include files (that either ship with your C compiler, or you download the Microsoft SDK). We'll re-define our <code>IExampleVtbl</code> struct as so:</p><div class="pre-lang" id="premain547447"><div></div><div class="pre-action-link"><span id="copycode547447" class="copy-code" data-index="547447" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre547447" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">#include &lt;windows.h&gt;
#include &lt;objbase.h&gt;
#include &lt;INITGUID.H&gt;

typedef HRESULT STDMETHODCALLTYPE QueryInterfacePtr(IExample *, REFIID, <span class="code-keyword">void</span> **);
typedef ULONG STDMETHODCALLTYPE AddRefPtr(IExample *);
typedef ULONG STDMETHODCALLTYPE ReleasePtr(IExample *);

typedef <span class="code-keyword">struct</span> {
   <span class="code-comment">//</span><span class="code-comment"> First 3 members must be called QueryInterface, AddRef, and Release</span>
   QueryInterfacePtr  *QueryInterface;
   AddRefPtr          *AddRef;
   ReleasePtr         *Release;
   SetStringPtr       *SetString;
   GetStringPtr       *GetString;
} IExampleVtbl;</pre>
<p>Let's examine that <code>typedef</code> for <code>QueryInterface</code>. First of all, the function returns an <code>HRESULT</code>. This is defined simply as a <code>long</code>. Next, it uses <code>STDMETHODCALLTYPE</code>.
 This means that arguments are not passed in registers, but rather, on 
the stack. And this also determines who does cleanup of the stack. In 
fact, for a COM object, we should make sure that all of our functions 
are declared with <code>STDMETHODCALLTYPE</code>, and return a <code>long</code> (<code>HRESULT</code>). The first argument passed to <code>QueryInterface</code> is a pointer to the object used to call the function. Aren't we turning <code>IExample</code>
 into a COM object? Yes, and that's what we're going to pass for this 
argument. (Remember we decided that the first argument we pass to any of
 our functions will be a pointer to the struct used to call that 
function? COM is simply enforcing, and relying upon, this design.)</p>
<p>Later, we'll examine what a <code>REFIID</code> is, and also talk about what that third argument to <code>QueryInterface</code> is for. But for now, note that <code>AddRef</code> and <code>Release</code> also are passed that same pointer to our struct we use to call them.</p>
<p>OK, before we forget, let's add <code>HRESULT STDMETHODCALLTYPE</code> to <code>SetString</code> and <code>GetString</code>:</p><div class="pre-lang" id="premain932770"><div></div><div class="pre-action-link"><span id="copycode932770" class="copy-code" data-index="932770" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre932770" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef HRESULT STDMETHODCALLTYPE SetStringPtr(IExample *, <span class="code-keyword">char</span> *);
typedef HRESULT STDMETHODCALLTYPE GetStringPtr(IExample *, <span class="code-keyword">char</span> *, <span class="code-keyword">long</span>);

HRESULT STDMETHODCALLTYPE SetString(IExample *this, <span class="code-keyword">char</span> * str)
{
   ...

   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}

HRESULT STDMETHODCALLTYPE GetString(IExample *this, <span class="code-keyword">char</span> *buffer, <span class="code-keyword">long</span> <span class="code-sdkkeyword">value</span>)
{
   ...

   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}</pre>
<blockquote>
<p><b>In conclusion</b>, a COM object is basically a C++ class. A C++ 
class is just a struct that always starts with a pointer to its VTable 
(an array of function pointers). And the first three pointers in the 
VTable will always be named <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>.
 What additional functions may be in its VTable, and what the name of 
their pointers are, depends upon what type of object it is. (You 
determine what other functions you want to add to your COM object.) For 
example, Internet Explorer's browser object will undoubtedly have 
different functions than some object that plays music. But all COM 
objects begin with a pointer to their VTable, and the first three VTable
 pointers are to the object's <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>
 functions. The first argument passed to an object's function is a 
pointer to the object (struct) itself. That is the law. Obey it.</p></blockquote>
<h2><a name="GUID">A</a> GUID</h2>
<p>Let's continue on our journey to make <code>IExample</code> a real COM object. We have yet to actually write our <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>
 functions. But before we can do that, we must talk about something 
called a Globally Universal Identifier (GUID). Ack. What's that? It's a 
16 byte array that is filled in with a unique series of bytes. And when I
 say unique, I do mean unique. One GUID (i.e., 16 byte array) <b>cannot</b>
 have the same series of bytes as another GUID... anywhere in the world.
 Every GUID ever created has a unique series of 16 bytes.</p>
<p>And how do you create that series of 16 unique bytes? You use a Microsoft utility called <i>GUIDGEN.EXE</i>. It either ships with your compiler, or you get it with the SDK. Run it and you see this window:</p>
<p align="center"><img height="339" src="COM%20in%20plain%20C%20-%20CodeProject_files/server1.gif" width="375"></p>
<p>As soon as you run <i>GUIDGEN</i>, it automatically generates a new 
GUID for you, and displays it in the Result box. Note that what you see 
in your Result box will be different than the above. After all, every 
single GUID generated will be different than any other. So you had 
better be seeing something different than I see. Go ahead and click on 
the "New GUID" button to see some different numbers appear in the Result
 box. Click all day and entertain yourself by seeing if you ever 
generate the same series of numbers more than once. You won't. And 
what's more, nobody else will ever generate <b>any</b> of those number series you generate.</p>
<p>You can click on the "Copy" button to transfer the text to the 
clipboard, and paste it somewhere else (like in your source code). Here 
is what I pasted when I did that:</p><div class="pre-lang" id="premain970135"><div></div><div class="pre-action-link"><span id="copycode970135" class="copy-code" data-index="970135" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre970135" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> {0B5B3D8E-574C-4fa3-9010-25B8E4CE24C2}</span>
DEFINE_GUID(&lt;&lt;name&gt;&gt;, <span class="code-digit">0xb5b3d8e</span>, <span class="code-digit">0x574c</span>, <span class="code-digit">0x4fa3</span>, 
            <span class="code-digit">0x90</span>, <span class="code-digit">0x10</span>, <span class="code-digit">0x25</span>, <span class="code-digit">0xb8</span>, <span class="code-digit">0xe4</span>, <span class="code-digit">0xce</span>, <span class="code-digit">0x24</span>, <span class="code-digit">0xc2</span>);</pre>
<p>The above is a macro. A <code>#define</code> in one of the Microsoft include files allows your compiler to compile the above into a 16 byte array.</p>
<p>But there is one thing that we must do. We must replace <code>&lt;&lt;name&gt;&gt;</code> with some C variable name we want to use for this GUID. Let's call it <code>CLSID_IExample</code>.</p><div class="pre-lang" id="premain221653"><div></div><div class="pre-action-link"><span id="copycode221653" class="copy-code" data-index="221653" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre221653" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> {0B5B3D8E-574C-4fa3-9010-25B8E4CE24C2}</span>
DEFINE_GUID(CLSID_IExample, <span class="code-digit">0xb5b3d8e</span>, <span class="code-digit">0x574c</span>, <span class="code-digit">0x4fa3</span>, 
      <span class="code-digit">0x90</span>, <span class="code-digit">0x10</span>, <span class="code-digit">0x25</span>, <span class="code-digit">0xb8</span>, <span class="code-digit">0xe4</span>, <span class="code-digit">0xce</span>, <span class="code-digit">0x24</span>, <span class="code-digit">0xc2</span>);</pre>
<p>Now we have a GUID we can use with <code>IExample</code>.</p>
<p>We also need a GUID for <code>IExample</code>'s VTable ("interface"), i.e., our <code>IExampleVtbl</code> struct. So go ahead and click on <i>GUIDGEN.EXE</i>'s New GUID button, and copy/paste it somewhere. This time, we're going to replace <code>&lt;&lt;name&gt;&gt;</code> with the C variable name <code>IID_IExample</code>. Here's what I pasted/edited:</p><div class="pre-lang" id="premain300199"><div></div><div class="pre-action-link"><span id="copycode300199" class="copy-code" data-index="300199" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre300199" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> {74666CAC-C2B1-4fa8-A049-97F3214802F0}</span>
DEFINE_GUID(IID_IExample, <span class="code-digit">0x74666cac</span>, <span class="code-digit">0xc2b1</span>, <span class="code-digit">0x4fa8</span>, 
      <span class="code-digit">0xa0</span>, <span class="code-digit">0x49</span>, <span class="code-digit">0x97</span>, <span class="code-digit">0xf3</span>, <span class="code-digit">0x21</span>, <span class="code-digit">0x48</span>, <span class="code-digit">0x2</span>, <span class="code-digit">0xf0</span>);</pre>
<blockquote>
<p><b>In conclusion</b>, every COM object has its own GUID, which is an 
array of 16 bytes that are different from any other GUID. A GUID is 
created with the <i>GUIDGEN.EXE</i> utility. A COM object's VTable (i.e., interface) also has a GUID.</p></blockquote>
<h2><a name="FUNCS">QueryInterface(),</a> AddRef(), and Release()</h2>
<p>Assume we want to allow another program to get hold of some <code>IExample</code>
 struct (i.e., COM object) we create/initialize, so the program can call
 our functions. (We won't yet examine the details of how another program
 gets hold of our <code>IExample</code>. We'll discuss that later).</p>
<p>Besides our own COM object, there may be lots of other COM components
 installed upon a given computer. (And again, we'll defer discussing how
 to install our COM component.) And different computers may have 
different COM components installed. How does that program determine if 
our <code>IExample</code> COM object is installed, and distinguish it from all of the other COM objects?</p>
<p>Remember that each COM object has a totally unique GUID, as does our <code>IExample</code> object. And our VTable for <code>IExample</code> has a GUID too. What we need to do is tell the developer writing that program what the GUIDs for our <code>IExample</code> object and its VTable are. Typically, you do that by giving him an include (<i>.H</i>) file with the above two GUID macros you got from <i>GUIDGEN.EXE</i>. OK, so the other program knows <code>IExample</code>'s and its VTable's GUIDs. What does it do with them?</p>
<p>That's where our <code>QueryInterface</code> function comes in. Remember that every COM object must have a <code>QueryInterface</code> function (as well as <code>AddRef</code> and <code>Release</code>). The other program is going to pass our <code>IExample</code> VTable GUID to our <code>QueryInterface</code> function, and we're going to check it to make sure it is indeed the <code>IExample</code> VTable's GUID. If it is, then we'll return something to let the program know that it indeed has an <code>IExample</code> object. If the wrong GUID is passed, we're going to return some error that and let it know that what it has isn't an <code>IExample</code> object. So, all of the COM objects on the computer will return an error if their <code>QueryInterface</code> is passed the <code>IExample</code> VTable's GUID, except our own <code>QueryInterface</code>.</p>
<p>That second argument passed to <code>QueryInterface</code> is the 
GUID we need to check. The third argument is (a handle) where we will 
return the same object pointer passed to us, if the GUID matches the <code>IExample</code> VTable's GUID. If not, we'll zero out that handle. In addition, <code>QueryInterface</code> returns the <code>long</code> value <code>NOERROR</code> (i.e., <code>#define</code>'d as 0) if the GUID matches, or some non-zero error value (<code>E_NOINTERFACE</code>) if not. So, let's look at <code>IExample</code>'s <code>QueryInterface</code>:</p><div class="pre-lang" id="premain134"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="134" id="preShrink134">Shrink </span> &nbsp; <span id="copycode134" class="copy-code" data-index="134" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre134" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT STDMETHODCALLTYPE QueryInterface(IExample *this, 
                          REFIID vTableGuid, <span class="code-keyword">void</span> **ppv)
{
   <span class="code-comment">//</span><span class="code-comment"> Check if the GUID matches IExample</span>
   <span class="code-comment">//</span><span class="code-comment"> VTable's GUID. Remember that we gave the</span>
   <span class="code-comment">//</span><span class="code-comment"> C variable name IID_IExample to our</span>
   <span class="code-comment">//</span><span class="code-comment"> VTable GUID. We can use an OLE function called</span>
   <span class="code-comment">//</span><span class="code-comment"> IsEqualIID to do the comparison for us.</span>
   <span class="code-keyword">if</span> (!IsEqualIID(riid, &amp;IID_IExample))
   {
      <span class="code-comment">//</span><span class="code-comment"> We don't recognize the GUID passed</span>
      <span class="code-comment">//</span><span class="code-comment"> to us. Let the caller know this,</span>
      <span class="code-comment">//</span><span class="code-comment"> by clearing his handle, </span>
      <span class="code-comment">//</span><span class="code-comment"> and returning E_NOINTERFACE.</span>
      *ppv = <span class="code-digit">0</span>;
      <span class="code-keyword">return</span>(E_NOINTERFACE);
   }

   <span class="code-comment">//</span><span class="code-comment"> It's a match!</span>

   <span class="code-comment">//</span><span class="code-comment"> First, we fill in his handle with</span>
   <span class="code-comment">//</span><span class="code-comment"> the same object pointer he passed us. That's</span>
   <span class="code-comment">//</span><span class="code-comment"> our IExample we created/initialized,</span>
   <span class="code-comment">//</span><span class="code-comment"> and he obtained from us.</span>
   *ppv = <span class="code-keyword">this</span>;

   <span class="code-comment">//</span><span class="code-comment"> Now we call our own AddRef function,</span>
   <span class="code-comment">//</span><span class="code-comment"> passing the IExample. </span>
   this-&gt;lpVtbl-&gt;AddRef(<span class="code-keyword">this</span>);

   <span class="code-comment">//</span><span class="code-comment"> Let him know he indeed has a IExample. </span>
   <span class="code-keyword">return</span>(NOERROR);
}</pre>
<p>Now let's talk about our <code>AddRef</code> and <code>Release</code> functions. You'll notice we called <code>AddRef</code> in <code>QueryInterface</code>... if we really did have a <code>IExample</code>.</p>
<p>Remember that we're allocating the <code>IExample</code> on behalf of
 the other program. He's simply gaining access to it. And it's our 
responsibility to free it when the other program is done using it. How 
do we know when that is?</p>
<p>We're going to use something called "reference counting". If you look back at the definition of <code>IExample</code>, you'll see that I put a <code>DWORD</code> member in there (<code>count</code>). We're going to make use of this member. When we create a <code>IExample</code>, we'll initialize it to 0. Then, we're going to increment this member (by 1) every time <code>AddRef</code> is called, and decrement it by 1 every time <code>Release</code> is called.</p>
<p>So, when our <code>IExample</code> is passed to <code>QueryInterface</code>, we call <code>AddRef</code> to increment its <code>count</code> member. When the other program is done using it, the program will pass our <code>IExample</code> to our <code>Release</code> function, where we will decrement that member. And if it's 0, we'll free <code>IExample</code> then.</p>
<p><b>This is another important rule of COM.</b> If you get hold of a COM object created by someone else, you must call its <code>Release</code> function when you're done with it. We certainly expect the other program to call our <code>Release</code> function when it is done with our <code>IExample</code> object.</p>
<p>Here then are our <code>AddRef</code> and <code>Release</code> functions:</p><div class="pre-lang" id="premain208781"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="208781" id="preShrink208781">Shrink </span> &nbsp; <span id="copycode208781" class="copy-code" data-index="208781" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre208781" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">ULONG STDMETHODCALLTYPE AddRef(IExample *this)
{
   <span class="code-comment">//</span><span class="code-comment"> Increment the reference count (count member).</span>
   ++this-&gt;count;

   <span class="code-comment">//</span><span class="code-comment"> We're supposed to return the updated count.</span>
   <span class="code-keyword">return</span>(this-&gt;count);
}

ULONG STDMETHODCALLTYPE Release(IExample *this)
{
   <span class="code-comment">//</span><span class="code-comment"> Decrement the reference count.</span>
   --this-&gt;count;

   <span class="code-comment">//</span><span class="code-comment"> If it's now zero, we can free IExample.</span>
   <span class="code-keyword">if</span> (this-&gt;count == <span class="code-digit">0</span>)
   {
      GlobalFree(<span class="code-keyword">this</span>);
      <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
   }

   <span class="code-comment">//</span><span class="code-comment"> We're supposed to return the updated count.</span>
   <span class="code-keyword">return</span>(this-&gt;count);
}</pre>
<p>There's one more thing we're going to do. Microsoft has defined a COM object known as an <code>IUnknown</code>. What's that? An <code>IUnknown</code> object is just like <code>IExample</code>, except its VTable contains <b>only</b> the <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions (i.e., it doesn't contain additional functions like our <code>IExample</code> VTable has <code>SetString</code> and <code>GetString</code>). In other words, an <code>IUnknown</code> is the bare minimum COM object. And Microsoft created a special GUID for an <code>IUnknown</code> object. But you know what? Our <code>IExample</code> object can also masquerade as an <code>IUnknown</code> object. After all, it has the <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions in it. Nobody needs to know it's really an <code>IExample</code>
 object if all they care about are just those first three functions. 
We're going to change one line of code so that we report success if the 
other program passes us either our <code>IExample</code> GUID or an <code>IUnknown</code> GUID. And by the way, Microsoft's include files give the <code>IUnknown</code> GUID the C variable name <code>IID_IUnknown</code>:</p><div class="pre-lang" id="premain627841"><div></div><div class="pre-action-link"><span id="copycode627841" class="copy-code" data-index="627841" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre627841" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> Check if the GUID matches IExample's GUID or IUnknown's GUID.</span>
<span class="code-keyword">if</span> (!IsEqualIID(vTableGuid, &amp;IID_IExample) &amp;&amp; 
        !IsEqualIID(vTableGuid, &amp;IID_IUnknown))</pre>
<blockquote>
<p><b>In conclusion</b>, for our own COM object, we allocate it on 
behalf of some other program (which gains access to the object and uses 
it to call our functions). We're responsible for freeing the object. We 
use reference counting in conjunction with our <code>AddRef</code> and <code>Release</code> functions to accomplish this safely. Our <code>QueryInterface</code>
 allows other programs to verify they have the object they want, and 
also allows us to increment the reference count. (Actually, the <code>QueryInterface</code>
 primarily serves a different purpose that we'll examine later. But at 
this point, it will suffice to think of its purpose this way.)</p></blockquote>
<p>So, is <code>IExample</code> now a real COM object? Yes it is! Great! Not too hard! We're done!</p>
<p>Wrong! We still have to package this thing into a form that another 
program can use (i.e., a Dynamic Link Library), and write code to do a 
special install routine, and examine how the other program gets hold of 
our <code>IExample</code> we create (and that will involve us writing more code).</p>
<h2><a name="CLASS">An</a> IClassFactory object</h2>
<p>Now we need to look at how a program gets hold of one of our <code>IExample</code>
 objects, and ultimately, we have to write more code to realize this. 
Microsoft has devised a standardized method for this. It involves us 
putting a second COM object (and its functions) inside our DLL. This COM
 object is called an <code>IClassFactory</code>, and it has a specific 
set of functions already defined in Microsoft's include files. It also 
has its own GUID already defined, and given the C variable name of <code>IID_IClassFactory</code>.</p>
<p>Our <code>IClassFactory</code>'s VTable has five specific functions in it, which are <code>QueryInterface</code>, <code>AddRef</code>, <code>Release</code>, <code>CreateInstance</code>, and <code>LockServer</code>. Notice that the <code>IClassFactory</code> has its own <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions, just like our <code>IExample</code> object. After all, our <code>IClassFactory</code>
 is a COM object too, and the VTable of all COM objects must start with 
those three functions. (But to avoid a name conflict with <code>IExample</code>'s functions, we'll preface our <code>IClassFactory</code>'s function names with "class", such as <code>classQueryInterface</code>, <code>classAddRef</code>, and <code>classRelease</code>. As long as <code>IClassFactory</code>'s VTable defines its first three members as <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code>, that's OK.)</p>
<p>The really important function is <code>CreateInstance</code>. The program calls our <code>IClassFactory</code>'s <code>CreateInstance</code> whenever the program wants us to create one of our <code>IExample</code> objects, initialize it, and return it. In fact, if the program wants several of our <code>IExample</code> objects, it can call <code>CreateInstance</code> numerous times. OK, so that's how a program gets hold of one of our <code>IExample</code> objects. <i>"But how does the program get hold of our <code>IClassFactory</code> object?"</i>, you may ask. We'll get to that later. For now, let's simply write our <code>IClassFactory</code>'s five functions, and make its VTable.</p>
<p>Making the VTable is easy. Unlike our <code>IExample</code> object's <code>IExampleVtbl</code>, we don't have to define our <code>IClassFactory</code>'s VTable struct. Microsoft has already done that for us by defining a <code>IClassFactoryVtbl</code> struct in some include file. All we need to do is declare our VTable and fill it in with pointers to our five <code>IClassFactory</code> functions. Let's create a static VTable using the variable name <code>IClassFactory_Vtbl</code>, and fill it in:</p><div class="pre-lang" id="premain776968"><div></div><div class="pre-action-link"><span id="copycode776968" class="copy-code" data-index="776968" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre776968" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">static</span> <span class="code-keyword">const</span> IClassFactoryVtbl IClassFactory_Vtbl = {classQueryInterface,
classAddRef,
classRelease,
classCreateInstance,
classLockServer};</pre>
<p>Likewise, creating an actual <code>IClassFactory</code> object is easy because Microsoft has already defined that struct too. We need only one of them, so let's declare a static <code>IClassFactory</code> using the variable name <code>MyIClassFactoryObj</code>, and initialize its <code>lpVtbl</code> member to point to our above VTable:</p><div class="pre-lang" id="premain838196"><div></div><div class="pre-action-link"><span id="copycode838196" class="copy-code" data-index="838196" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre838196" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">static</span> IClassFactory MyIClassFactoryObj = {&amp;IClassFactory_Vtbl};</pre>
<p>Now, we just need to write those above five functions. Our <code>classAddRef</code> and <code>classRelease</code> functions are trivial. Because we never actually allocate our <code>IClassFactory</code> (i.e., we simple declare it as a static), we don't need to free anything. So, <code>classAddRef</code> will simply return a 1 (to indicate that there is always one <code>IClassFactory</code> hanging around). And <code>classRelease</code> will do likewise. We don't need to do any reference counting for our <code>IClassFactory</code> since we don't have to free it.</p><div class="pre-lang" id="premain166295"><div></div><div class="pre-action-link"><span id="copycode166295" class="copy-code" data-index="166295" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre166295" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">ULONG STDMETHODCALLTYPE classAddRef(IClassFactory *this)
{
   <span class="code-keyword">return</span>(<span class="code-digit">1</span>);
}

ULONG STDMETHODCALLTYPE classRelease(IClassFactory *this)
{
   <span class="code-keyword">return</span>(<span class="code-digit">1</span>);
}</pre>
<p>Now, let's look at our <code>QueryInterface</code>. It needs to check if the GUID passed to it is either an <code>IUnknown</code>'s GUID (since our <code>IClassFactory</code> has the <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions, it too can masquerade as an <code>IUnknown</code> object) or an <code>IClassFactory</code>'s GUID. Otherwise, we do the same thing as we did in <code>IExample</code>'s <code>QueryInterface</code>.</p><div class="pre-lang" id="premain991602"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="991602" id="preShrink991602">Shrink </span> &nbsp; <span id="copycode991602" class="copy-code" data-index="991602" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre991602" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT STDMETHODCALLTYPE classQueryInterface(IClassFactory *this, 
                          REFIID factoryGuid, <span class="code-keyword">void</span> **ppv)
{
   <span class="code-comment">//</span><span class="code-comment"> Check if the GUID matches an IClassFactory or IUnknown GUID.</span>
   <span class="code-keyword">if</span> (!IsEqualIID(factoryGuid, &amp;IID_IUnknown) &amp;&amp; 
       !IsEqualIID(factoryGuid, &amp;IID_IClassFactory))
   {
      <span class="code-comment">//</span><span class="code-comment"> It doesn't. Clear his handle, and return E_NOINTERFACE.</span>
      *ppv = <span class="code-digit">0</span>;
      <span class="code-keyword">return</span>(E_NOINTERFACE);
   }

   <span class="code-comment">//</span><span class="code-comment"> It's a match!</span>

   <span class="code-comment">//</span><span class="code-comment"> First, we fill in his handle with the same object pointer he passed us.</span>
   <span class="code-comment">//</span><span class="code-comment"> That's our IClassFactory (MyIClassFactoryObj) he obtained from us.</span>
   *ppv = <span class="code-keyword">this</span>;

   <span class="code-comment">//</span><span class="code-comment"> Call our IClassFactory's AddRef, passing the IClassFactory. </span>
   this-&gt;lpVtbl-&gt;AddRef(<span class="code-keyword">this</span>);

   <span class="code-comment">//</span><span class="code-comment"> Let him know he indeed has an IClassFactory. </span>
   <span class="code-keyword">return</span>(NOERROR);
}</pre>
<p>Our <code>IClassFactory</code>'s <code>LockServer</code> can be just a stub for now:</p><div class="pre-lang" id="premain822301"><div></div><div class="pre-action-link"><span id="copycode822301" class="copy-code" data-index="822301" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre822301" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT STDMETHODCALLTYPE classLockServer(IClassFactory *this, BOOL flock)
{
   <span class="code-keyword">return</span>(NOERROR);
}</pre>
<p>There's one more function to write -- <code>CreateInstance</code>. This is defined as follows:</p><div class="pre-lang" id="premain267284"><div></div><div class="pre-action-link"><span id="copycode267284" class="copy-code" data-index="267284" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre267284" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT STDMETHODCALLTYPE classCreateInstance(IClassFactory *, 
                          IUnknown *, REFIID, <span class="code-keyword">void</span> **);</pre>
<p>As usual, the first argument is going to be a pointer to our <code>IClassFactory</code> object (<code>MyIClassFactoryObj</code>) which was used to call <code>CreateInstance</code>.</p>
<p>We use the second argument only if we implement something called <i>aggregation</i>.
 We won't get into this now. If this is non-zero, then someone wants us 
to support aggregation, which we're not going to do, and we will 
indicate that by returning an error.</p>
<p>The third argument will be the <code>IExample</code> VTable's GUID (if someone indeed wants us to allocate, initialize, and return a <code>IExample</code> object).</p>
<p>The fourth argument is a handle where we'll return the <code>IExample</code> object we create.</p>
<p>So let's dive into our <code>CreateInstance</code> function (named <code>classCreateInstance</code>):</p><div class="pre-lang" id="premain922438"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="922438" id="preShrink922438">Shrink </span> &nbsp; <span id="copycode922438" class="copy-code" data-index="922438" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre922438" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT STDMETHODCALLTYPE classCreateInstance(IClassFactory *this, 
        IUnknown *punkOuter, REFIID vTableGuid, <span class="code-keyword">void</span> **ppv)
{
   HRESULT          hr;
   <span class="code-keyword">struct</span> IExample *thisobj;

   <span class="code-comment">//</span><span class="code-comment"> Assume an error by clearing caller's handle.</span>
   *ppv = <span class="code-digit">0</span>;

   <span class="code-comment">//</span><span class="code-comment"> We don't support aggregation in IExample.</span>
   <span class="code-keyword">if</span> (punkOuter)
      hr = CLASS_E_NOAGGREGATION;
   <span class="code-keyword">else</span>
   {
      <span class="code-comment">//</span><span class="code-comment"> Create our IExample object, and initialize it.</span>
      <span class="code-keyword">if</span> (!(thisobj = GlobalAlloc(GMEM_FIXED, 
                      <span class="code-keyword">sizeof</span>(<span class="code-keyword">struct</span> IExample))))
         hr = E_OUTOFMEMORY;
      <span class="code-keyword">else</span>
      {
         <span class="code-comment">//</span><span class="code-comment"> Store IExample's VTable. We declared it</span>
         <span class="code-comment">//</span><span class="code-comment"> as a static variable IExample_Vtbl.</span>
         thisobj-&gt;lpVtbl = &amp;IExample_Vtbl;

         <span class="code-comment">//</span><span class="code-comment"> Increment reference count so we</span>
         <span class="code-comment">//</span><span class="code-comment"> can call Release() below and it will</span>
         <span class="code-comment">//</span><span class="code-comment"> deallocate only if there</span>
         <span class="code-comment">//</span><span class="code-comment"> is an error with QueryInterface().</span>
         thisobj-&gt;count = <span class="code-digit">1</span>;

         <span class="code-comment">//</span><span class="code-comment"> Fill in the caller's handle</span>
         <span class="code-comment">//</span><span class="code-comment"> with a pointer to the IExample we just</span>
         <span class="code-comment">//</span><span class="code-comment"> allocated above. We'll let IExample's</span>
         <span class="code-comment">//</span><span class="code-comment"> QueryInterface do that, because</span>
         <span class="code-comment">//</span><span class="code-comment"> it also checks the GUID the caller</span>
         <span class="code-comment">//</span><span class="code-comment"> passed, and also increments the</span>
         <span class="code-comment">//</span><span class="code-comment"> reference count (to 2) if all goes well.</span>
         hr = IExample_Vtbl.QueryInterface(thisobj, vTableGuid, ppv);

         <span class="code-comment">//</span><span class="code-comment"> Decrement reference count.</span>
         <span class="code-comment">//</span><span class="code-comment"> NOTE: If there was an error in QueryInterface()</span>
         <span class="code-comment">//</span><span class="code-comment"> then Release() will be decrementing</span>
         <span class="code-comment">//</span><span class="code-comment"> the count back to 0 and will free the</span>
         <span class="code-comment">//</span><span class="code-comment"> IExample for us. One error that may</span>
         <span class="code-comment">//</span><span class="code-comment"> occur is that the caller is asking for</span>
         <span class="code-comment">//</span><span class="code-comment"> some sort of object that we don't</span>
         <span class="code-comment">//</span><span class="code-comment"> support (ie, it's a GUID we don't recognize).</span>
         IExample_Vtbl.Release(thisobj);
      }
   }

   <span class="code-keyword">return</span>(hr);
}</pre>
<p>That takes care of implementing our <code>IClassFactory</code> object.</p>
<h2><a name="DLL">Packaging</a> into a DLL</h2>
<p>In order to facilitate another program getting hold of our <code>IClassFactory</code> (and to call its <code>CreateInstance</code> function to obtain some <code>IExample</code>
 objects), we'll package our above source code into a Dynamic Link 
Library (DLL). This tutorial does not discuss how to create a DLL per 
se, so if you're unfamiliar with that, then you should first read a 
tutorial about DLLs.</p>
<p>Above, we've already written all the code for our <code>IExample</code> and <code>IClassFactory</code> objects. All we need to do is paste this into our source for the DLL.</p>
<p>But there's still more to do. Microsoft also dictates that we must add a function to our DLL called <code>DllGetClassObject</code>.
 Microsoft has already defined what arguments it is passed, what it 
should do, and what it should return. A program is going to call our <code>DllGetClassObject</code> to obtain a pointer to our <code>IClassFactory</code> object. (Actually, as we'll see later, the program is going to call an OLE function named <code>CoGetClassObject</code>, which in turn calls our <code>DllGetClassObject</code>.) So, this is how the program gets hold of our <code>IClassFactory</code> object -- by calling our <code>DllGetClassObject</code>. Our <code>DllGetClassObject</code> function must perform this job. Here's how it's defined:</p><div class="pre-lang" id="premain194913"><div></div><div class="pre-action-link"><span id="copycode194913" class="copy-code" data-index="194913" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre194913" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT PASCAL DllGetClassObject(REFCLSID objGuid, 
        REFIID factoryGuid, <span class="code-keyword">void</span> **factoryHandle);</pre>
<p>The first argument passed is going to be the GUID for our <code>IExample</code> object (not its VTable's GUID). We need to check this to make sure that the caller definitely intended to call our DLL's <code>DllGetClassObject</code>. Note that every COM DLL has a <code>DllGetClassObject</code> function in it, so again, we need that GUID to distinguish our <code>DllGetClassObject</code> from every other COM DLL's <code>DllGetClassObject</code>.</p>
<p>The second argument is going to be the GUID of an <code>IClassFactory</code>.</p>
<p>The third argument is a handle to where the program expects us to return a pointer to our <code>IClassFactory</code> (if the program did indeed pass <code>IExample</code>'s GUID, and not some other COM object's GUID).</p><div class="pre-lang" id="premain685111"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="685111" id="preShrink685111">Shrink </span> &nbsp; <span id="copycode685111" class="copy-code" data-index="685111" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre685111" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT PASCAL DllGetClassObject(REFCLSID objGuid, 
        REFIID factoryGuid, <span class="code-keyword">void</span> **factoryHandle)
{
   HRESULT  hr;

   <span class="code-comment">//</span><span class="code-comment"> Check that the caller is passing</span>
   <span class="code-comment">//</span><span class="code-comment"> our IExample GUID. That's the COM</span>
   <span class="code-comment">//</span><span class="code-comment"> object our DLL implements.</span>
   <span class="code-keyword">if</span> (IsEqualCLSID(objGuid, &amp;CLSID_IExample))
   {
      <span class="code-comment">//</span><span class="code-comment"> Fill in the caller's handle</span>
      <span class="code-comment">//</span><span class="code-comment"> with a pointer to our IClassFactory object.</span>
      <span class="code-comment">//</span><span class="code-comment"> We'll let our IClassFactory's</span>
      <span class="code-comment">//</span><span class="code-comment"> QueryInterface do that, because it also</span>
      <span class="code-comment">//</span><span class="code-comment"> checks the IClassFactory GUID and does other book-keeping.</span>
      hr = classQueryInterface(&amp;MyIClassFactoryObj, 
                          factoryGuid, factoryHandle);
   }
   <span class="code-keyword">else</span>
   {
      <span class="code-comment">//</span><span class="code-comment"> We don't understand this GUID.</span>
      <span class="code-comment">//</span><span class="code-comment"> It's obviously not for our DLL.</span>
      <span class="code-comment">//</span><span class="code-comment"> Let the caller know this by</span>
      <span class="code-comment">//</span><span class="code-comment"> clearing his handle and returning</span>
      <span class="code-comment">//</span><span class="code-comment"> CLASS_E_CLASSNOTAVAILABLE.</span>
      *factoryHandle = <span class="code-digit">0</span>;
      hr = CLASS_E_CLASSNOTAVAILABLE;
   }

   <span class="code-keyword">return</span>(hr);
}</pre>
<p>We're almost done with what we need to create our DLL. There's just 
one more thing. It's not really the program that loads our DLL. Rather, 
the operating system does so on behalf of the program when the program 
calls <code>CoGetDllClassObject</code> (i.e., <code>CoGetClassObject</code> locates our DLL file, does a <code>LoadLibrary</code> on it, uses <code>GetProcAddress</code> to get our above <code>DllGetClassObject</code>,
 and calls it on behalf of the program). And unfortunately, Microsoft 
didn't work out any way for the program to tell the OS when the program 
is done using our DLL and the OS should unload (<code>FreeLibrary</code>) our DLL. So we have to help out the OS to let it know when it is safe to unload our DLL. We must provide a function called <code>DllCanUnloadNow</code> which will return <code>S_OK</code> if it's safe to unload our DLL, or <code>S_FALSE</code> if not.</p>
<p>And how will we know when it is safe?</p>
<p>We're going to have to do more reference counting. Specifically, 
every time we allocate an object for a program, we're going to have to 
increment a count. Each time the program calls that object's <code>Release</code>
 function, and we free that object, we'll decrement that same count. 
Only when the count is zero will we tell the OS that our DLL is safe to 
unload, because that's when we know for sure that the program isn't 
using any of our objects. So, we'll declare a static <code>DWORD</code> variable named <code>OutstandingObjects</code> to maintain this count. (And of course, when our DLL is first loaded, this needs to be initialized to 0.)</p>
<p>So, where is the most convenient place to increment this variable? In our <code>IClassFactory</code>'s <code>CreateInstance</code> function, after we actually <code>GlobalAlloc</code> the object and make sure everything went OK. So, we'll add a line in that function, right after the call to <code>Release</code>:</p><div class="pre-lang" id="premain50364"><div></div><div class="pre-action-link"><span id="copycode50364" class="copy-code" data-index="50364" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre50364" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">static</span> DWORD OutstandingObjects = <span class="code-digit">0</span>;

HRESULT STDMETHODCALLTYPE classCreateInstance(IClassFactory *this, 
        IUnknown *punkOuter, REFIID vTableGuid, <span class="code-keyword">void</span> **ppv)
{
   ...

         IExampleVtbl.Release(thisobj);

         <span class="code-comment">//</span><span class="code-comment"> Increment our count of outstanding objects if all</span>
         <span class="code-comment">//</span><span class="code-comment"> went well.</span>
         <span class="code-keyword">if</span> (!hr) InterlockedIncrement(&amp;OutstandingObjects);;
      }
   }

   <span class="code-keyword">return</span>(hr);
}</pre>
<p>And where is the most convenient place to decrement this variable? In our <code>IExample</code>'s <code>Release</code> function, right after we <code>GlobalFree</code> the object. So we add a line after <code>GlobalFree</code>:</p><div class="pre-lang" id="premain586100"><div></div><div class="pre-action-link"><span id="copycode586100" class="copy-code" data-index="586100" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre586100" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">InterlockedDecrement(&amp;OutstandingObjects);</pre>
<p>But there's more. (Do the messy details <b>never</b> end with 
Microsoft?) Microsoft has decided that there should be a way for a 
program to lock our DLL in memory if it desires. For that purpose, it 
can call our <code>IClassFactory</code>'s <code>LockServer</code> 
function, passing a 1 if it wants us to increment a count of locks on 
our DLL, or 0 if it wants to decrement a count of locks on our DLL. So, 
we also need a second static <code>DWORD</code> reference count which we'll call <code>LockCount</code>. (And of course, this also needs to be initialized to 0 when our DLL loads.) Our <code>LockServer</code> function now becomes:</p><div class="pre-lang" id="premain45929"><div></div><div class="pre-action-link"><span id="copycode45929" class="copy-code" data-index="45929" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre45929" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">static</span> DWORD LockCount = <span class="code-digit">0</span>;

HRESULT STDMETHODCALLTYPE 
        classLockServer(IClassFactory *this, BOOL flock)
{
   <span class="code-keyword">if</span> (flock) InterlockedIncrement(&amp;LockCount);
   <span class="code-keyword">else</span> InterlockedDecrement(&amp;LockCount);

   <span class="code-keyword">return</span>(NOERROR);
}</pre>
<p>Now we're ready to write our <code>DllCanUnloadNow</code> function:</p><div class="pre-lang" id="premain452610"><div></div><div class="pre-action-link"><span id="copycode452610" class="copy-code" data-index="452610" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre452610" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT PASCAL DllCanUnloadNow(<span class="code-keyword">void</span>)
{
   <span class="code-comment">//</span><span class="code-comment"> If someone has retrieved pointers to any of our objects, and</span>
   <span class="code-comment">//</span><span class="code-comment"> not yet Release()'ed them, then we return S_FALSE to indicate</span>
   <span class="code-comment">//</span><span class="code-comment"> not to unload this DLL. Also, if someone has us locked, return</span>
   <span class="code-comment">//</span><span class="code-comment"> S_FALSE</span>
   <span class="code-keyword">return</span>((OutstandingObjects | LockCount) ? S_FALSE : S_OK);
}</pre>
<p>If you download the example project, the source file for our DLL (<i>IExample.c</i>) is in the directory <i>IExample</i>. Also supplied are Microsoft Visual C++ project files that create a DLL (<i>IExample.dll</i>) from this source.</p>
<h2><a name="H">Our</a> C++/C include file</h2>
<p>As mentioned earlier, in order for a program written in C++/C to use our <code>IExample</code> DLL, we need to give that program's author our <code>IExample</code>'s, and its VTable's, GUIDs. We'll put those GUID macros in an include (<i>.H</i>) file which we can distribute to others, and also include in our DLL source. We also need to put the definition of our <code>IExampleVtbl</code>, and <code>IExample</code>, structs in this include file, so the program can call our functions via the <code>IExample</code> we give it.</p>
<p>Up to now, we defined our <code>IExampleVtbl</code>, and <code>IExample</code>, structs as so:</p><div class="pre-lang" id="premain32924"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="32924" id="preShrink32924">Shrink </span> &nbsp; <span id="copycode32924" class="copy-code" data-index="32924" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre32924" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef HRESULT STDMETHODCALLTYPE QueryInterfacePtr(IExample *, REFIID, <span class="code-keyword">void</span> **);
typedef ULONG STDMETHODCALLTYPE AddRefPtr(IExample *);
typedef ULONG STDMETHODCALLTYPE ReleasePtr(IExample *);
typedef HRESULT STDMETHODCALLTYPE SetStringPtr(IExample *, <span class="code-keyword">char</span> *);
typedef HRESULT STDMETHODCALLTYPE GetStringPtr(IExample *, <span class="code-keyword">char</span> *, <span class="code-keyword">long</span>);

typedef <span class="code-keyword">struct</span> {
   QueryInterfacePtr  *QueryInterface;
   AddRefPtr          *AddRef;
   ReleasePtr         *Release;
   SetStringPtr       *SetString;
   GetStringPtr       *GetString;
} IExampleVtbl;

typedef <span class="code-keyword">struct</span> {
   IExampleVtbl *lpVtbl;
   DWORD         count;
   <span class="code-keyword">char</span>          buffer[80];
} IExample;</pre>
<p>There is one problem with the above. We don't want to let the other program know about our "<code>count</code>" and "<code>buffer</code>"
 members. We want to hide them from the program. A program should never 
be allowed to directly access our object's data members. It should know 
only about the "<code>lpVtbl</code>" member so that it can call our functions. So, as far as the program is concerned, we want our <code>IExample</code> to be defined as so:</p><div class="pre-lang" id="premain310648"><div></div><div class="pre-action-link"><span id="copycode310648" class="copy-code" data-index="310648" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre310648" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   IExampleVtbl *lpVtbl;
} IExample;</pre>
<p>Furthermore, although the <code>typedef</code>s for the function 
definitions make things easier to read, if you have a lot of functions 
in your object, this could get verbose and error-prone.</p>
<p>Finally, there is the problem that the above is a C definition. It 
really doesn't make things easy for a C++ program which wants to use our
 COM object. After all, even though we've written <code>IExample</code> in C, our <code>IExample</code> struct is really a C++ class. And it's a lot easier for a C++ program to use it defined as a C++ class than a C struct.</p>
<p>Instead of defining things as above, Microsoft provides a macro we 
can use to define our VTable and object in a way that works for both C 
and C++, and hides the extra data members. To use this macro, we must 
first define the symbol <code>INTERFACE</code> to the name of our object (which in this case is <code>IExample</code>). And prior to that, we must <code>undef</code> that symbol to avoid a compiler warning. Then, we use the <code>DECLARE_INTERFACE_</code> macro. Inside of the macro, we list our <code>IExample</code> functions. Here's what it will look like:</p><div class="pre-lang" id="premain466182"><div></div><div class="pre-action-link"><span id="copycode466182" class="copy-code" data-index="466182" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre466182" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-preprocessor">#undef  INTERFACE
</span><span class="code-preprocessor">#define INTERFACE   IExample
</span>DECLARE_INTERFACE_ (INTERFACE, IUnknown)
{
   STDMETHOD  (QueryInterface)  (THIS_ REFIID, <span class="code-keyword">void</span> **) PURE;
   STDMETHOD_ (ULONG, AddRef)   (THIS) PURE;
   STDMETHOD_ (ULONG, Release)  (THIS) PURE;
   STDMETHOD  (SetString)       (THIS_ <span class="code-keyword">char</span> *) PURE;
   STDMETHOD  (GetString)       (THIS_ <span class="code-keyword">char</span> *, DWORD) PURE;
};</pre>
<p>This probably looks a bit bizarre.</p>
<p>When defining a function, <code>STDMETHOD</code> is used whenever the function returns an <code>HRESULT</code>. Our <code>QueryInterface</code>, <code>SetString</code>, and <code>GetString</code> functions return an <code>HRESULT</code>. <code>AddRef</code> and <code>Release</code> do not. Those latter two return a <code>ULONG</code>. So that's why we instead use <code>STDMETHOD_</code>
 (with an ending underscore) for those two. Then, we put the name of the
 function in parentheses. If the function doesn't return an <code>HRESULT</code>,
 we need to put what type it returns, and then a comma, before the 
function name. After the function name, we list the function's arguments
 in parentheses. <code>THIS</code> refers to a pointer to our object (i.e., <code>IExample</code>). If the only thing passed to the function is that pointer, then you simply put <code>THIS</code> in parentheses. That's the case for the <code>AddRef</code> and <code>Release</code> functions. But the other functions have additional arguments. So, we must use <code>THIS_</code> (with an ending underscore). Then we list the remaining arguments. Notice that there is <b>no</b> comma between <code>THIS_</code> and the remaining arguments. But there is a comma in between each of the remaining arguments. Finally, we put the word <code>PURE</code> and a semicolon.</p>
<p>To be sure, this is a weird macro, and it's this way mostly to define
 a COM object so that it works both for a plain C compiler as well as a 
C++ compiler.</p>
<p><i>"But where's the definition of our <code>IExample</code> struct?"</i>, you may ask. This macro is very weird indeed. It causes the C compiler to automatically generate the definition of a <code>IExample</code> struct that contains only the "<code>lpVtbl</code>" member. So just by defining our VTable this way, we automatically get a definition of <code>IExample</code> suitable for some other programmer.</p>
<p>Paste our two GUID macros into this include file, and we're all set. I did that to create the file <i>IExample.h</i>.</p>
<p>But as you know, our <code>IExample</code> really has two more data members. So what we're going to have to do is define a "variation" of our <code>IExample</code>, inside of our DLL source file. We'll call it a "<code>MyRealIExample</code>", and it will be the real definition of our <code>IExample</code>:</p><div class="pre-lang" id="premain11592"><div></div><div class="pre-action-link"><span id="copycode11592" class="copy-code" data-index="11592" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre11592" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   IExampleVtbl *lpVtbl;
   DWORD         count;
   <span class="code-keyword">char</span>          buffer[80];
} MyRealIExample;</pre>
<p>And we'll change a line in our <code>IClassFactory</code>'s <code>CreateInstance</code> so that we allocate a <code>MyRealIExample</code> struct:</p><div class="pre-lang" id="premain539561"><div></div><div class="pre-action-link"><span id="copycode539561" class="copy-code" data-index="539561" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre539561" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">if</span> (!(thisobj = GlobalAlloc(GMEM_FIXED, <span class="code-keyword">sizeof</span>(<span class="code-keyword">struct</span> MyRealIExample))))</pre>
<p>The program doesn't need to know that we're actually giving it an 
object that has some extra data members inside it (which are for all 
practical purposes, hidden from that program). After all, both of these 
structs have the same "<code>lpVtbl</code>" member pointing to the same 
array of function pointers. But now, our DLL functions can get access to
 those "hidden" members just by typecasting a <code>IExample</code> pointer to a <code>MyRealIExample</code> pointer.</p>
<h2><a name="DEF">The</a> Definition (DEF) file</h2>
<p>We also need a DEF file to expose the two functions <code>DllCanUnloadNow</code> and <code>DllGetClassObject</code>. Microsoft's compiler also wants them to be defined as <code>PRIVATE</code>. Here's our DEF file, which must be fed to the linker:</p><div class="pre-lang" id="premain740268"><div> </div><div class="pre-action-link"><span id="copycode740268" class="copy-code" data-index="740268" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre740268" style="margin-top:0;" data-language="text" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">LIBRARY IExample
EXPORTS
DllCanUnloadNow   PRIVATE
DllGetClassObject PRIVATE</pre>
<h2><a name="REG">Install</a> the DLL, and register the object</h2>
<p>We've now completed everything we need to do in order to make our <i>IExample.dll</i>. We can go ahead and compile <i>IExample.dll</i>.</p>
<p>But that's not the end of our job. Before any other program can use our <code>IExample</code> object (i.e., DLL), we need to do two things:</p>
<ol>
<li>Install our DLL somewhere that can be found by the computer running the program. 
</li><li>Register our DLL as a COM component. </li></ol>
<p>We need to create an install program that will copy <i>IExample.DLL</i> to a well-chosen location. For example, perhaps we'll create a "<i>IExample</i>" directory in the <i>Program Files</i>
 directory, and copy the DLL there. (Of course, our installer should do 
version checking, so that if there is a later version of our DLL already
 installed there, we don't overwrite it with an earlier version.)</p>
<p>We then need to register this DLL. This involves creating several registry keys.</p>
<p>We first need to create a key under <b>HKEY_LOCAL_MACHINE\Software\Classes\CLSID</b>. For the name of this new key, we must use our <code>IExample</code> object's GUID, but it must be formatted in a particular, text string format.</p>
<p>If you download the example project, the directory <i>RegIExample</i> contains an example installer for <i>IExample.dll</i>. The function <code>stringFromCLSID</code> demonstrates how to format our <code>IExample</code> GUID into a text string suitable for creating a registry key name with it.</p>
<p><b>Note:</b> This example installer does not copy the DLL to some 
well-chosen location before registering it. Rather, it allows you to 
pick out wherever you've compiled <i>IExample.dll</i> and register it in
 that location. This is just for convenience in developing/testing. A 
production quality installer should copy the DLL to a well-chosen 
location, and do version checking. These needed enhancements are left 
for you to do with your own installer.</p>
<p>Under our "GUID key", we must create a subkey named <b>InprocServer32</b>. This subkey's default value is then set to the full path where our DLL has been installed.</p>
<p>We must also set a value named <b>ThreadingModel</b> to the string 
value "both", if we don't need to restrict a program to calling our 
DLL's functions only from a single thread. Since we don't use global 
data in our <code>IExample</code> functions, we're thread-safe.</p>
<p>After we run our installer, <i>IExample.dll</i> is now registered as a COM component on our computer, and some program can now use it.</p>
<p><b>Note:</b> The directory <i>UnregIExample</i> contains an example uninstaller for <i>IExample.dll</i>. It essentially removes the registry keys that <code>RegIExample</code> created. A production quality uninstaller should also remove <i>IExample.dll</i> and any directories created by the installer.</p>
<h2><a name="C">An</a> example C program</h2>
<p>Now we're ready to write a C program that uses our <code>IExample</code> COM object. If you download the example project, the directory <i>IExampleApp</i> contains an example C program.</p>
<p>First of all, the C program <code>#include</code>s our <i>IExample.h</i> include file, so it can reference our <code>IExample</code> object's, and its VTable's, GUIDs.</p>
<p>Before a program can use any COM object, it must initialize COM, which is done by calling the function <code>CoInitialize</code>. This need be done only once, so a good place to do it is at the very start of the program.</p>
<p>Next, the program calls <code>CoGetClassObject</code> to get a pointer to <i>IExample.dll</i>'s <code>IClassFactory</code> object. Note that we pass the <code>IExample</code> object's GUID as the first argument. We also pass a pointer to our variable <code>classFactory</code> which is where a pointer to the <code>IClassFactory</code> will be returned to us, if all goes well.</p>
<p>Once we have the <code>IClassFactory</code> object, we can call its <code>CreateInstance</code> function to get a <code>IExample</code> object. Note how we use the <code>IClassFactory</code> to call its <code>CreateInstance</code> function. We get the function via <code>IClassFactory</code>'s VTable (i.e., its <code>lpVtbl</code> member). Also note that we pass the <code>IClassFactory</code> pointer as the first argument. Remember that this is standard COM.</p>
<p>Note that we pass <code>IExample</code>'s VTable GUID as the third argument. And for the fourth argument, we pass a pointer to our variable <code>exampleObj</code> which is where a pointer to an <code>IExample</code> object will be returned to us, if all goes well.</p>
<p>Once we have an <code>IExample</code> object, we can <code>Release</code> the <code>IClassFactory</code> object. Remember that a program must call an object's <code>Release</code> function when done with the object. The <code>IClassFactory</code> is an object, just like <code>IExample</code> is an object. Each has its own <code>Release</code> function, which must be called when we're done with the object. We don't need the <code>IClassFactory</code> any more. We don't want to obtain any more <code>IExample</code> objects, nor call any of the <code>IClassFactory</code>'s other functions. So, we can <code>Release</code> it now. Note that this does not affect our <code>IExample</code> object at all.</p>
<p>So next, we call the <code>IClassFactory</code>'s <code>Release</code> function. Once we do this, our <code>classFactory</code> variable no longer contains a valid pointer to anything. It's garbage now.</p>
<p>But we still have our <code>IExample</code> pointer. We haven't yet <code>Release</code>d that. So next, we decide to call some of <code>IExample</code>'s functions. We call <code>SetString</code>. Then we follow up with a call to <code>GetString</code>. Note how we use the <code>IExample</code> pointer to call its <code>SetString</code> function. We get the function via <code>IExample</code>'s VTable. And also notice that we pass the <code>IExample</code> pointer as the first argument. Again, standard COM.</p>
<p>When we're finally done with the <code>IExample</code>, we <code>Release</code> it. Once we do this, our <code>exampleObj</code> variable no longer contains a valid pointer to anything.</p>
<p>Finally, we must call <code>CoUninitialize</code> to allow COM to 
clean up some internal stuff. This needs to be done once only, so it's 
best to do it at the end of our program (but only if <code>CoInitialize</code> succeeded).</p>
<blockquote>There's also a function called <code>CoCreateInstance</code> that can be used to replace the call to <code>CoGetClassObject</code> (to get the DLL's <code>IClassFactory</code>), and then the call to the <code>IClassFactory</code>'s <code>CreateInstance</code>. <code>CoCreateInstance</code> itself calls <code>CoGetClassObject</code>, and then calls the <code>IClassFactory</code>'s <code>CreateInstance</code>. <code>CoCreateInstance</code> directly returns our <code>IExample</code>, bypassing the need for us to get the <code>IClassFactory</code>. Here's an example use:
<p></p><div class="pre-lang" id="premain790544"><div></div><div class="pre-action-link"><span id="copycode790544" class="copy-code" data-index="790544" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre790544" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">if</span> ((hr = CoCreateInstance(&amp;CLSID_IExample, <span class="code-digit">0</span>, 
        CLSCTX_INPROC_SERVER, &amp;IID_IExample, &amp;exampleObj)))
   MessageBox(<span class="code-digit">0</span>, <span class="code-string">"</span><span class="code-string">Can't create IExample object"</span>, 
              <span class="code-string">"</span><span class="code-string">CoCreateInstance error"</span>, 
              MB_OK|MB_ICONEXCLAMATION);</pre></blockquote>
<h2><a name="CPLUS">An</a> example C++ program</h2>
<p>The directory <i>IExampleCPlusApp</i> contains an example C++ 
program. It does exactly what the C example does. But, you'll note some 
important differences. First, because the macro in <i>IExample.h</i> defines <code>IExample</code> as a C++ class (instead of a struct), and because C++ handles classes in a special way, the C++ program calls our <code>IExample</code> function in a different format.</p>
<p>In C, we get an <code>IExample</code> function by directly accessing the VTable (via the <code>lpVtbl</code> member), and we always pass the <code>IExample</code> as the first argument.</p>
<p>The C++ compiler knows that a class has a VTable as its first member, and automatically accesses its <code>lpVtbl</code> member to get a function in it. So, we don't have to specify the <code>lpVtbl</code> part. Also, the C++ compiler automatically passes the object as the first argument.</p>
<p>So whereas in C, we code:</p><div class="pre-lang" id="premain36588"><div></div><div class="pre-action-link"><span id="copycode36588" class="copy-code" data-index="36588" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre36588" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">classFactory-&gt;lpVtbl-&gt;CreateInstance(classFactory, <span class="code-digit">0</span>, 
                      &amp;IID_IExample, &amp;exampleObj);</pre>
<p>in C++, we instead code:</p><div class="pre-lang" id="premain281119"><div></div><div class="pre-action-link"><span id="copycode281119" class="copy-code" data-index="281119" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre281119" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">classFactory-&gt;CreateInstance(<span class="code-digit">0</span>, IID_IExample, &amp;exampleObj);</pre>
<p><b>Note:</b> We also omit the <code>&amp;</code> on the <code>IID_IExample</code> GUID. The GUID macro for C++ doesn't require that it be specified.</p>
<h2><a name="MOD">Modifying</a> the code</h2>
<p>To create your own object, make a copy of the <i>IExample</i> directory. Delete the <i>Debug</i> and <i>Release</i> sub-directories, and the following files:</p><div class="pre-lang" id="premain589311"><div> </div><div class="pre-action-link"><span id="copycode589311" class="copy-code" data-index="589311" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre589311" style="margin-top:0;" data-language="text" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">IExample.dsp
IExample.dsw
IExample.ncb
IExample.opt
IExample.plg</pre>
<p>In the remaining files (<i>IExample.c</i>, <i>IExample.h</i>, <i>IExample.def</i>), search and replace the string <i>IExample</i> with the name of your own object, for example <code>IMyObject</code>. Rename these files per your new object name (i.e., <i>IMyObject.c</i>, etc.).</p>
<p>Create a new Visual C++ project with your new object's name, and in 
this directory. For the type of project, choose "Win32 Dynamic-Link 
Library". Create an empty project. Then add the above three files to it.</p>
<p>Make sure you use <i>GUIDGEN.EXE</i> to generate your own GUIDs for your object and its VTable. <b>Do not use the GUIDs that I generated.</b> Replace the GUID macros in the <i>.H</i> file (and remember to replace the <code>&lt;&lt;name&gt;&gt;</code> part of the GUID macro too).</p>
<p>Remove the functions <code>SetString</code> and <code>GetString</code> in the <i>.C</i> and <i>.H</i> files, and add your own functions instead. Modify the <code>INTERFACE</code> macro in the <i>.H</i> file to define the functions you added.</p>
<p>Change the data members of <code>MyRealIExample</code> (i.e., <code>MyRealIMyObject</code>, whatever) to what you want.</p>
<p>Modify the installer to change the first three strings in the source.</p>
<p>In the example programs, search and replace the string <i>IExample</i> with the name of your object.</p>
<h2><a name="NEXT">What's</a> next?</h2>
<p>Although a C or C++ program, or a program written in most compiled 
languages, can use our COM object, we have yet to add some support that 
will allow most interpreted languages to use our object, such as Visual 
Basic, VBscript, JScript, Python, etc. This will be the subject of Part 
II of this series.</p>


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    

<div class="author-wrapper">

    <div class="desktop-only tablet-only" style="position:absolute; top:-30px;right:20px">
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div style="padding-right:100px">
        <div class="subdue" style="margin-bottom:7px">Written By</div>

        <div class="container-member">
             <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>
        </div>

        <div class="company text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	        <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
        </div>

        <div class="text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/US.gif" alt="United States" width="16" height="11">&nbsp;United States</span>
        </div>
    </div>

</div>

<div class="description" style="padding-top:1rem">
    This member has not yet provided a Biography. Assume it's 
interesting and varied, and probably something to do with programming.
</div>

<div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_SocialRow" class="follow flex-container flex-extend" style="margin-top:20px">
    <div class="flex-item">
        
    </div>
    <div class="flex-item-tight" style="margin-right:25px">
        
    </div>
</div>

<br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesC" data-country="US" data-loadonview="true" data-tags="VC6, VS6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=32983"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=32983"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2 class="padded-top">Comments and Discussions</h2>

                    
			        <div id="ctl00_SharePH" class="share-list float-right desktop-only tablet-only" style="margin-top:-3.5rem">
				        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aHow%20to%20create%2fuse%20COM%20components%20in%20plain%20C%2c%20without%20MFC%2c%20ATL%2c%20WTL%2c%20or%20any%20other%20framework.%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f13601%2fCOM-in-plain-C%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f13601%2fCOM-in-plain-C" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13601%2fCOM-in-plain-C" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13601%2fCOM-in-plain-C&amp;title=COM+in+plain+C+-+CodeProject&amp;summary=How+to+create%2fuse+COM+components+in+plain+C%2c+without+MFC%2c+ATL%2c+WTL%2c+or+any+other+framework.&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13601%2fCOM-in-plain-C&amp;title=COM+in+plain+C+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f13601%2fCOM-in-plain-C&amp;description=COM+in+plain+C+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



			        </div><a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f13601%2fCOM-in-plain-C%3ffid%3d285767%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="285767"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="q" value="Search Comments"><input type="image" src="COM%20in%20plain%20C%20-%20CodeProject_files/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f13601%2fCOM-in-plain-C" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="285767"><input type="hidden" name="currentQS" value="fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f13601%2fCOM-in-plain-C"><input type="hidden" name="floc" value="/Articles/13601/COM-in-plain-C">Spacing<select size="1" class="dropdown" name="spc" data-ddg-inputtype="unknown">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view" data-ddg-inputtype="unknown">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp" data-ddg-inputtype="unknown">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background msg-list">
<tbody><tr id="F5939180_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5939180xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5939180" parent="0" thread="5939180" href="https://www.codeproject.com/Messages/5939180/Thanks-a-Lot">Thanks a Lot</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 15981989</span><span class="date">23-Apr-23  23:20</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=15981989">Member 15981989</a></span></td><td class="date"><span>23-Apr-23  23:20&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5939180_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thanks a Lot  <img src="COM%20in%20plain%20C%20-%20CodeProject_files/smiley_wink.gif" align="top" alt="Wink | ;)"> <br>
Excellent Job<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5939180" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5939180" name="react-item_5939180" id="MRF5939180" class="reaction-result"></span><span data-objectref="3_5939180" data-votingtype="GoodOrBad" name="RateItem_5939180" id="MVF5939180" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5939180" href="https://www.codeproject.com/Messages/5939180/Thanks-a-Lot" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5744626_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5744626xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5744626" parent="0" thread="5744626" href="https://www.codeproject.com/Messages/5744626/No-suitable-constructor-exists-to-convert-from-con">No suitable constructor exists to convert from "const GUID *" to "_GUID" IsEqualIID(vTableGuid, &amp;IID_IExample)</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">aka_Pipo</span><span class="date">20-Aug-20  20:24</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=14533348">aka_Pipo</a></span></td><td class="date"><span>20-Aug-20  20:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5744626_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Jeff.<br>
<br>
I get such error in Visual Studio 2012.<br>
I have configured C/C++ advanced options setting "Compile as C".<br>
Also i have added this line <div class="pre-lang" id="premain415129"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="415129" id="preShrink415129">Shrink </span> &nbsp; <span id="copycode415129" class="copy-code" data-index="415129" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre415129" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-preprocessor">#define CINTERFACE</span></pre><br>
<br>
If a remove "&amp;" <div class="pre-lang" id="premain465094"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="465094" id="preShrink465094">Shrink </span> &nbsp; <span id="copycode465094" class="copy-code" data-index="465094" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre465094" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">IsEqualIID(vTableGuid, IID_IExample</pre> i get this error <div class="pre-lang" id="premain839213"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="839213" id="preShrink839213">Shrink </span> &nbsp; <span id="copycode839213" class="copy-code" data-index="839213" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre839213" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">Error	<span class="code-digit">2</span>	error C2172: <span class="code-string">'</span><span class="code-string">memcmp'</span> : actual parameter <span class="code-keyword">is</span> not a pointer : parameter <span class="code-digit">2</span></pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5744626" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5744626" name="react-item_5744626" id="MRF5744626" class="reaction-result"></span><span data-objectref="3_5744626" data-votingtype="GoodOrBad" name="RateItem_5744626" id="MVF5744626" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5744626" href="https://www.codeproject.com/Messages/5744626/No-suitable-constructor-exists-to-convert-from-con" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5753623_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5753623xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5753623" parent="5744626" thread="5744626" href="https://www.codeproject.com/Messages/5753623/Re-No-suitable-constructor-exists-to-convert-from">Re: No suitable constructor exists to convert from "const GUID *" to "_GUID" IsEqualIID(vTableGuid, &amp;IID_IExample)</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">aka_Pipo</span><span class="date">4-Oct-20  23:46</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=14533348">aka_Pipo</a></span></td><td class="date"><span>4-Oct-20  23:46&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5753623_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5744626);" href="https://www.codeproject.com/Messages/5744626/No-suitable-constructor-exists-to-convert-from-con"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>It was a Visual Studio's IntelliSence issue. Despite this errors a project compiles successfully.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5744626" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5753623" name="react-item_5753623" id="MRF5753623" class="reaction-result"></span><span data-objectref="3_5753623" data-votingtype="GoodOrBad" name="RateItem_5753623" id="MVF5753623" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5753623" href="https://www.codeproject.com/Messages/5753623/Re-No-suitable-constructor-exists-to-convert-from" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5720433_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5720433xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5720433" parent="0" thread="5720433" href="https://www.codeproject.com/Messages/5720433/High-five">High five</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">H_salmon</span><span class="date">6-May-20  17:07</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=14573575">H_salmon</a></span></td><td class="date"><span>6-May-20  17:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5720433_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Great article <br>
thank you very much<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5720433" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5720433" name="react-item_5720433" id="MRF5720433" class="reaction-result"></span><span data-objectref="3_5720433" data-votingtype="GoodOrBad" name="RateItem_5720433" id="MVF5720433" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5720433" href="https://www.codeproject.com/Messages/5720433/High-five" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5570223_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5570223xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_kudos.gif" alt="Praise" title="Praise"></td><td class="subject hover-container"><a class="message-link" name="5570223" parent="0" thread="5570223" href="https://www.codeproject.com/Messages/5570223/Brilliant-article-on-the-subject">Brilliant article on the subject</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 11786541</span><span class="date">12-Nov-18  20:59</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11786541">Member 11786541</a></span></td><td class="date"><span>12-Nov-18  20:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5570223_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">The explanation is lucid and author's mastery of the subject is undisputed.<br>
Thank You so much Jeff.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5570223" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5570223" name="react-item_5570223" id="MRF5570223" class="reaction-result"></span><span data-objectref="3_5570223" data-votingtype="GoodOrBad" name="RateItem_5570223" id="MVF5570223" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5570223" href="https://www.codeproject.com/Messages/5570223/Brilliant-article-on-the-subject" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5546266_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5546266xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5546266" parent="0" thread="5546266" href="https://www.codeproject.com/Messages/5546266/Passing-used-made-structures-through-COM-Inteface">Passing used made structures through COM Inteface function</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 11966285</span><span class="date">15-Aug-18  14:13</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11966285">Member 11966285</a></span></td><td class="date"><span>15-Aug-18  14:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5546266_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Jeff,<br>
<br>
I have been working with an ActiveX module (.ocx). AFAIK ActiveX uses 
COM. This module has defined an interface to support callbacks. In MFC 
technology, you would normally register these callbacks in the event 
sink map.<br>
<br>
If I use the #import directive, vc generates a header file, and inside 
of the interface that supports the callbacks, there are functions 
defined like this one:<br>
<div class="pre-lang" id="premain415129"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="415129" id="preShrink415129">Shrink </span> &nbsp; <span id="copycode415129" class="copy-code" data-index="415129" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre415129" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT callBackFunctionName(<span class="code-keyword">short</span> * pResp )</pre><br>
My concern is with the parameter <div class="pre-lang" id="premain465094"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="465094" id="preShrink465094">Shrink </span> &nbsp; <span id="copycode465094" class="copy-code" data-index="465094" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre465094" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">short</span> * pResp</pre>.
 The way it is designed, this parameter is meant to be reinterpret 
casted to an structure (defined in another header that was also 
provided). I hosted this ActiveX using .Net. The problem is that .Net 
and its interop module interpret this short pointer as a primitive short
 value (no pointers exist in c# or vb). The question is: Can the 
provider redefine its ocx in a way that these callbacks return a 
custom/user made structure as a parameter OR COM can only be used with a
 limited set of Automation Data Types?  <br>
I tried also with Active QT, and the issue is the same, short * is translated to int&amp; in this case by QTs tool dumpcpp.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5546266" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5546266" name="react-item_5546266" id="MRF5546266" class="reaction-result"></span><span data-objectref="3_5546266" data-votingtype="GoodOrBad" name="RateItem_5546266" id="MVF5546266" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5546266" href="https://www.codeproject.com/Messages/5546266/Passing-used-made-structures-through-COM-Inteface" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5438765_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5438765xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5438765" parent="0" thread="5438765" href="https://www.codeproject.com/Messages/5438765/Very-helpful-to-c-programmer">Very helpful to c programmer</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">viqfoai</span><span class="date">26-Sep-17  21:04</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5525897">viqfoai</a></span></td><td class="date"><span>26-Sep-17  21:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5438765_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">This article is very helpful to C programmer, does the 
author has any plan to disclose how to develop the standard windows 
control like Button, ListView etc., such control as author said, can be 
manipulated by SendMessage() functions.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5438765" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5438765" name="react-item_5438765" id="MRF5438765" class="reaction-result"></span><span data-objectref="3_5438765" data-votingtype="GoodOrBad" name="RateItem_5438765" id="MVF5438765" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5438765" href="https://www.codeproject.com/Messages/5438765/Very-helpful-to-c-programmer" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5181672_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5181672xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5181672" parent="0" thread="5181672" href="https://www.codeproject.com/Messages/5181672/thanks">thanks</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 12163063</span><span class="date">3-Jan-16  16:13</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12163063">Member 12163063</a></span></td><td class="date"><span>3-Jan-16  16:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5181672_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5181672" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5181672" name="react-item_5181672" id="MRF5181672" class="reaction-result"></span><span data-objectref="3_5181672" data-votingtype="GoodOrBad" name="RateItem_5181672" id="MVF5181672" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5181672" href="https://www.codeproject.com/Messages/5181672/thanks" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5160841_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5160841xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5160841" parent="0" thread="5160841" href="https://www.codeproject.com/Messages/5160841/must-use-idl">must use idl?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 12097556</span><span class="date">15-Nov-15  18:38</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12097556">Member 12097556</a></span></td><td class="date"><span>15-Nov-15  18:38&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5160841_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="pre-lang" id="premain415129"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="415129" id="preShrink415129">Shrink </span> &nbsp; <span id="copycode415129" class="copy-code" data-index="415129" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre415129" style="margin-top:0;" class="lang-csharp notranslate" data-language="cs" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">DEFINE_GUID(IID_IClassFactory, <span class="code-digit">0x00000001</span>, <span class="code-digit">0x0000</span>, <span class="code-digit">0x0000</span>, <span class="code-digit">0xC0</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x46</span>);
DEFINE_GUID(IID_IUnknown, <span class="code-digit">0x00000000</span>, <span class="code-digit">0x0000</span>, <span class="code-digit">0x0000</span>, <span class="code-digit">0xC0</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x00</span>, <span class="code-digit">0x46</span>);</pre><br>
<br>
I add  IID_IClassFactory and  IID_IUnknown  GUID  in IExample.h file  
,but have some errors .    why do  you not write IID_IClassFactory and  
IID_IUnknown of GUID   in IExample.h file ?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5160841" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5160841" name="react-item_5160841" id="MRF5160841" class="reaction-result"></span><span data-objectref="3_5160841" data-votingtype="GoodOrBad" name="RateItem_5160841" id="MVF5160841" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5160841" href="https://www.codeproject.com/Messages/5160841/must-use-idl" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5111064_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5111064xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="5111064" parent="0" thread="5111064" href="https://www.codeproject.com/Messages/5111064/why-its-not-running">why its not running...??</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">vikas Kumar mandal</span><span class="date">18-Aug-15  1:56</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11904137">vikas Kumar mandal</a></span></td><td class="date"><span>18-Aug-15  1:56&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5111064_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">whenever i try to run the downloaded code its giving error  msg " Can't get IClassFactory".<br>
plz... reply<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5111064" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5111064" name="react-item_5111064" id="MRF5111064" class="reaction-result"></span><span data-objectref="3_5111064" data-votingtype="GoodOrBad" name="RateItem_5111064" id="MVF5111064" class="rating-result"><span>1.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5111064" href="https://www.codeproject.com/Messages/5111064/why-its-not-running" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5128947_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5128947xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5128947" parent="5111064" thread="5111064" href="https://www.codeproject.com/Messages/5128947/32-or-64-bit">32 or 64 bit</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">peterkm</span><span class="date">16-Sep-15  23:35</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6430">peterkm</a></span></td><td class="date"><span>16-Sep-15  23:35&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5128947_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,5111064);" href="https://www.codeproject.com/Messages/5111064/why-its-not-running"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Just an ad hoc simplistic remark: <br>
perhaps is there 32-bit / 64-bit dependence,<br>
unless you are testing on 32-bit ...<br>
Regards,<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5111064" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5128947" name="react-item_5128947" id="MRF5128947" class="reaction-result"></span><span data-objectref="3_5128947" data-votingtype="GoodOrBad" name="RateItem_5128947" id="MVF5128947" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5128947" href="https://www.codeproject.com/Messages/5128947/32-or-64-bit" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5009478_h0" class="header hover-row root">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5009478xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_idea.gif" alt="Suggestion" title="Suggestion"></td><td class="subject hover-container"><a class="message-link" name="5009478" parent="0" thread="5009478" href="https://www.codeproject.com/Messages/5009478/typo-in-the-article">typo in the article</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Member 1666188</span><span class="date">25-Feb-15  2:17</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1666188">Member 1666188</a></span></td><td class="date"><span>25-Feb-15  2:17&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5009478_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Excellent article, thanks!<br>
I just found a typo where you first explain how to use IExample's QueryInterface:<br>
<br>
if (!IsEqualIID(riid, &amp;IID_IExample)) <br>
should be <br>
if (!IsEqualIID(vTableGuid, &amp;IID_IExample))<br>
<br>
Note: the code in the project is correct.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5009478" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5009478" name="react-item_5009478" id="MRF5009478" class="reaction-result"></span><span data-objectref="3_5009478" data-votingtype="GoodOrBad" name="RateItem_5009478" id="MVF5009478" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5009478" href="https://www.codeproject.com/Messages/5009478/typo-in-the-article" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4749558_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4749558xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4749558" parent="0" thread="4749558" href="https://www.codeproject.com/Messages/4749558/Microsoft-should-pay-your-for-doing-their-work">Microsoft should pay your for doing their work!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Elmue</span><span class="date">1-Feb-14  5:47</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=480064">Elmue</a></span></td><td class="date"><span>1-Feb-14  5:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4749558_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Your article should be in the MSDN!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4749558" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4749558" name="react-item_4749558" id="MRF4749558" class="reaction-result"></span><span data-objectref="3_4749558" data-votingtype="GoodOrBad" name="RateItem_4749558" id="MVF4749558" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4749558" href="https://www.codeproject.com/Messages/4749558/Microsoft-should-pay-your-for-doing-their-work" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4674135_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4674135xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4674135" parent="0" thread="4674135" href="https://www.codeproject.com/Messages/4674135/Your-job-is-useful-for-me">Your job  is  useful  for me.</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">gongfuxiaozi11</span><span class="date">6-Oct-13  16:02</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9770798">gongfuxiaozi11</a></span></td><td class="date"><span>6-Oct-13  16:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4674135_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank  you very much.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4674135" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4674135" name="react-item_4674135" id="MRF4674135" class="reaction-result"></span><span data-objectref="3_4674135" data-votingtype="GoodOrBad" name="RateItem_4674135" id="MVF4674135" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4674135" href="https://www.codeproject.com/Messages/4674135/Your-job-is-useful-for-me" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4673808_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4673808xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4673808" parent="0" thread="4673808" href="https://www.codeproject.com/Messages/4673808/How-can-I-use-the-demo">How  can  I  use  the demo</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">gongfuxiaozi11</span><span class="date">5-Oct-13  17:15</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9770798">gongfuxiaozi11</a></span></td><td class="date"><span>5-Oct-13  17:15&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4673808_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I  have try  several  times  and  can't  understand how 
 to use  the demo program.I have changed the GUID.I wonder whether I  
should run the register  regiexample and then run the exampleapp. I have
  tried  this way.But I failed.I  hope you can  give me some 
suggestion.Thank you very much.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4673808" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4673808" name="react-item_4673808" id="MRF4673808" class="reaction-result"></span><span data-objectref="3_4673808" data-votingtype="GoodOrBad" name="RateItem_4673808" id="MVF4673808" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4673808" href="https://www.codeproject.com/Messages/4673808/How-can-I-use-the-demo" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4674137_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4674137xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="4674137" parent="4673808" thread="4673808" href="https://www.codeproject.com/Messages/4674137/Re-How-can-I-use-the-demo">Re: How  can  I  use  the demo</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">gongfuxiaozi11</span><span class="date">6-Oct-13  16:04</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9770798">gongfuxiaozi11</a></span></td><td class="date"><span>6-Oct-13  16:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4674137_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4673808);" href="https://www.codeproject.com/Messages/4673808/How-can-I-use-the-demo"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I  have solve  the problem. Thank you!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4673808" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4674137" name="react-item_4674137" id="MRF4674137" class="reaction-result"></span><span data-objectref="3_4674137" data-votingtype="GoodOrBad" name="RateItem_4674137" id="MVF4674137" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4674137" href="https://www.codeproject.com/Messages/4674137/Re-How-can-I-use-the-demo" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4728575_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx4728575xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4728575" parent="4674137" thread="4673808" href="https://www.codeproject.com/Messages/4728575/Re-How-can-I-use-the-demo">Re: How  can  I  use  the demo</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">proton1h1</span><span class="date">28-Dec-13  0:52</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10491234">proton1h1</a></span></td><td class="date"><span>28-Dec-13  0:52&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4728575_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,4674137);" href="https://www.codeproject.com/Messages/4674137/Re-How-can-I-use-the-demo"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Can you please tell me...how to run the project. I'm confused...should i make a win32Console applciation or win32 application...<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4673808" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4728575" name="react-item_4728575" id="MRF4728575" class="reaction-result"></span><span data-objectref="3_4728575" data-votingtype="GoodOrBad" name="RateItem_4728575" id="MVF4728575" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4728575" href="https://www.codeproject.com/Messages/4728575/Re-How-can-I-use-the-demo" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4647322_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4647322xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4647322" parent="0" thread="4647322" href="https://www.codeproject.com/Messages/4647322/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Logicshi</span><span class="date">28-Aug-13  7:51</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10238360">Logicshi</a></span></td><td class="date"><span>28-Aug-13  7:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4647322_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Help Me A Lot!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4647322" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4647322" name="react-item_4647322" id="MRF4647322" class="reaction-result"></span><span data-objectref="3_4647322" data-votingtype="GoodOrBad" name="RateItem_4647322" id="MVF4647322" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4647322" href="https://www.codeproject.com/Messages/4647322/My-vote-of-5" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4628247_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4628247xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4628247" parent="0" thread="4628247" href="https://www.codeproject.com/Messages/4628247/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Richard Chambers</span><span class="date">4-Aug-13  4:33</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=40262">Richard Chambers</a></span></td><td class="date"><span>4-Aug-13  4:33&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4628247_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I have been wanting a reasonably clear overview of COM objects and I found your article.  Thank you so much.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4628247" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4628247" name="react-item_4628247" id="MRF4628247" class="reaction-result"></span><span data-objectref="3_4628247" data-votingtype="GoodOrBad" name="RateItem_4628247" id="MVF4628247" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4628247" href="https://www.codeproject.com/Messages/4628247/My-vote-of-5" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4606048_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4606048xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4606048" parent="0" thread="4606048" href="https://www.codeproject.com/Messages/4606048/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">hakz.code</span><span class="date">7-Jul-13  22:26</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=5407982">hakz.code</a></span></td><td class="date"><span>7-Jul-13  22:26&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4606048_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">This is one of the best articles on web,that explains COM without using any frameworks very well.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4606048" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4606048" name="react-item_4606048" id="MRF4606048" class="reaction-result"></span><span data-objectref="3_4606048" data-votingtype="GoodOrBad" name="RateItem_4606048" id="MVF4606048" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4606048" href="https://www.codeproject.com/Messages/4606048/My-vote-of-5" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4589406_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4589406xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4589406" parent="0" thread="4589406" href="https://www.codeproject.com/Messages/4589406/GUID">GUID</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">LuisR14</span><span class="date">16-Jun-13  3:19</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4843018">LuisR14</a></span></td><td class="date"><span>16-Jun-13  3:19&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4589406_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">just wanted to point out one thing, GUID doesn't stand for Globally Universal ID, it stands for Globally <b>Unique</b> ID<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4589406" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4589406" name="react-item_4589406" id="MRF4589406" class="reaction-result"></span><span data-objectref="3_4589406" data-votingtype="GoodOrBad" name="RateItem_4589406" id="MVF4589406" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4589406" href="https://www.codeproject.com/Messages/4589406/GUID" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4559086_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4559086xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4559086" parent="0" thread="4559086" href="https://www.codeproject.com/Messages/4559086/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Victor Noagbodji</span><span class="date">7-May-13  8:41</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4810282">Victor Noagbodji</a></span></td><td class="date"><span>7-May-13  8:41&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4559086_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">This article is very well written.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4559086" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4559086" name="react-item_4559086" id="MRF4559086" class="reaction-result"></span><span data-objectref="3_4559086" data-votingtype="GoodOrBad" name="RateItem_4559086" id="MVF4559086" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4559086" href="https://www.codeproject.com/Messages/4559086/My-vote-of-5" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4544784_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4544784xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4544784" parent="0" thread="4544784" href="https://www.codeproject.com/Messages/4544784/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Johannes Frank</span><span class="date">18-Apr-13  12:44</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9949591">Johannes Frank</a></span></td><td class="date"><span>18-Apr-13  12:44&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4544784_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Learning the basics is unbeatable<br>
Great article!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4544784" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4544784" name="react-item_4544784" id="MRF4544784" class="reaction-result"></span><span data-objectref="3_4544784" data-votingtype="GoodOrBad" name="RateItem_4544784" id="MVF4544784" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4544784" href="https://www.codeproject.com/Messages/4544784/My-vote-of-5" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4455703_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4455703xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4455703" parent="0" thread="4455703" href="https://www.codeproject.com/Messages/4455703/My-vote-of-5">My vote of 5</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">headio</span><span class="date">18-Dec-12  21:54</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=6234524">headio</a></span></td><td class="date"><span>18-Dec-12  21:54&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4455703_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I'm use CPP  , this article is also very useful to explain how CPP   Class work. excellent!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4455703" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4455703" name="react-item_4455703" id="MRF4455703" class="reaction-result"></span><span data-objectref="3_4455703" data-votingtype="GoodOrBad" name="RateItem_4455703" id="MVF4455703" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4455703" href="https://www.codeproject.com/Messages/4455703/My-vote-of-5" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4453254_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4453254xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4453254" parent="0" thread="4453254" href="https://www.codeproject.com/Messages/4453254/Excellent-Job">Excellent Job!</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">WiStRoM</span><span class="date">15-Dec-12  17:23</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7196369">WiStRoM</a></span></td><td class="date"><span>15-Dec-12  17:23&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4453254_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><b>Great article helps me understand how COM tech origins. Thanks to your efforts!</b><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/13601/COM-in-plain-C" rel="nofollow noopener">Sign In</a><wbr><a href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4453254" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4453254" name="react-item_4453254" id="MRF4453254" class="reaction-result"></span><span data-objectref="3_4453254" data-votingtype="GoodOrBad" name="RateItem_4453254" id="MVF4453254" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4453254" href="https://www.codeproject.com/Messages/4453254/Excellent-Job" rel="nofollow noopener"><img src="COM%20in%20plain%20C%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 26-Aug-23  7:22</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26"><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">2</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=51#xx0xx">3</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=76#xx0xx">4</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=101#xx0xx">5</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=126#xx0xx">6</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=151#xx0xx">7</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=176#xx0xx">8</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=201#xx0xx">9</a><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=226#xx0xx">10</a> <a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?fid=285767&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=26#xx0xx">Next </a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C%20-%20CodeProject_files/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				
				

				

                <div id="ctl00_RHSticky" class="container-article-info-sticky sticky">

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="senseai" data-country="US" data-tags="VC6, VS6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&sz=300x250&c=32983"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&sz=300x250&c=32983"  width="300px" height="250px" target="_blank"/></a></noscript></div>
					</div>

        		    

<div class="article-summary">

    <ul class="prize-list">
<li>MFC/C++ Feb 2006 </li>
</ul>
    

</div>

				    

                    

				    

				    

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesC" data-country="US" data-loadonview="true" data-tags="VC6, VS6, C++, C, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=300x250&c=32983"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=300x250&c=32983"  width="300px" height="250px" target="_blank"/></a></noscript></div>
					</div>

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/13601/COM-in-plain-C?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright  <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2023 <br>
                <br>
				Web02 
				2.8:2023-08-14:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C%20-%20CodeProject_files/DFPAudiencePixel" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

function Join() {
    document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
    return false;
}

var qndjyjsodm = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new qndjyjsodm).init()}catch(i){(new qndjyjsodm).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new qndjyjsodm).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('<div class="small-text muted hidden">Advertisement</div>');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() > 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;
var forumCtrl_ctl00_MessageBoard_reaction;
var forumCtrl_ctl00_MessageBoard__reactionConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 285767,
};
var subscriptions_ctl00_MessageBoard;

var semjubf = false;
var DMReportsOK = null;
function showDMAlert() { 
  var $div = $('div.msg-728x90');
  $div.append($('<img src="/images/alert-top-block.gif" style="right:0;position:absolute;z-index:0">'));
}
function onDMcallBack(event)
{
   if (event.originalEvent) event = event.originalEvent;
   jQuery.support.cors = true;
   if (event.data === 'DM-disabled') DMReportsOK = false;
   else if (event.data=='DM-enabled') DMReportsOK = true;
   else if (typeof event.data == 'object' && event.data.sender &&             event.data.sender == 'DeveloperMedia' && event.data.application=='apps' &&
            event.data.action == 'reportEnabled') {
            DMReportsOK = event.data.data.enabled;
   }
   lbmjribvtx = !DMReportsOK;
}
function checkLoaded() { 
 var showBlockMsg = false;
 var block        = 'None';
 if (block === 'None' && typeof DMAds === 'undefined')
     block = 'ResourceBlocked';
 if (block === 'None' && !document.getElementById('adbp-tester'))     block = 'ResourceBlocked';
 if (block === 'None' && DMReportsOK === false)     block = 'DomModified';
 lbmjribvtx = block != 'None';
 if (semjubf) {
  $.ajax({ url:'/script/Content/Ajax/VS.aspx',    data:{'cadm':block},     cache:false, async:true });
};
 if (showBlockMsg && block != 'None')
    showDMAlert();
}
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	MicroModal.init();
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_13601_1',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            88625,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    allowReactions      : false,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    reactionControl     : null,
	    codeblockProcessor  : new CodeBlocks(),
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in-out',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href=\'/info/cookie.aspx\'>Cookie Policy</a>, <a href=\'/info/privacy.aspx\'>Privacy Policy</a>, and our <a href=\'/info/TermsOfUse.aspx\'>Terms of Service</a>.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });
	
	$(window).on('message', onDMcallBack);
	setTimeout(checkLoaded, 4000);

})
</script>










<div id="adbp-tester">an advertisement</div><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><script async="" type="text/javascript" src="COM%20in%20plain%20C%20-%20CodeProject_files/gpt.js"></script><script type="text/javascript">if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",CloseAdImageUrl="https://cdn1.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://cdn1.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png";String.prototype.includes||(String.prototype.includes=function(n,t){"use strict";return(typeof t!="number"&&(t=0),t+n.length>this.length)?!1:this.indexOf(n,t)!==-1});var DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&&n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="<select class='reportReason' style='max-width:150px !important; padding: 0px !important'><option>Offensive<\/option><option>Abusive<\/option><option>Off topic<\/option><option>Don't like the Ad<\/option > <option>Wrong language<\/option><\/select > ",f="<input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'><\/input>";return t===728&&i===90?k(r,u,f):t===300&&i===250?d(r,u,f):t===160&&i===600?g(r,u,f):t===125&&i===125&&nt(r),(t===728&&i===90||t===300&&i===250||t===160&&i===600)&&tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'><div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'>1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here<\/div><div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"&nbsp;"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'><\/a>";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'><div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/>2. Drag and Drop or paste the screenshot here<\/div><div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '> "+i+"<\/div><div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'><\/a>";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'><div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/><br/>2. Drag and Drop or paste the screenshot here<\/div><div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"<\/div><div style='font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'><\/a>";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="<div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'><span style='color:#999;'>Thank you for the report!<\/span><\/div>";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&&n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&&(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="<br/><br/>Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&&t.height===600?"<br/> Your screenshot has been received  thanks! <br/><br/> Next step: Whats wrong with the ad":t.width===300&&t.height===250?"<br/> Your screenshot has been received  thanks! <br/><br/> Next step: Whats wrong with the ad":t.width===728&&t.height===90?"Your screenshot has been received  thanks! Next step: Whats wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&&(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&&(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&&r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&&(u.style.display="none");f&&(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&&n.fileList.length>0&&(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&&(l=n.clipboardData||n.originalEvent.clipboardData,s=l&&l.items||[],t=[],s&&s.length>0))for(h=!0,c=0;c<s.length;c++)a=s[c],a.kind==="file"&&(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&&t.length>0?(v=i(f),v&&(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="<br/><br/> No files found on clipboard <br/>",u(f)):(n.currentTarget.innerHTML="<br/><br/> Paste not supported on your browser <br/>",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&&n.dataTransfer.files.length>0)for(t=0;t<n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&&n.dataTransfer.files[t].type.indexOf("image")>=0&&(r[r.length]=n.dataTransfer.files[t]);r.length>0?(f&&(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="<br/><br/>The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&&t.style.display!=="none"&&t.src&&(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&&(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},i=function(t){for(var i=0,r=n.length;i<r;i++)if(n[i]&&n[i].adContainer&&n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&&window.MutationObserver&&(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&&y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")>=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i>0&&(o=new Date,o.setTime(o.getTime()+i*864e5))&&(e+="; expires="+o.toGMTString());r&&(e+="; path="+r);u&&u.indexOf(".")!==-1&&(e+="; domain="+u);f&&(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index<t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&&JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&&r.Id&&r.Id===n.Id&&(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&&c(i)},c=function(t){for(n=t;i.length>0;){var r=i.pop();typeof r=="function"&&r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={PageQueryTerms:"",PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:"",PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:"loading",PIIViolatingUrls:["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t<r.length;t++)if(i=r[t],n.indexOf(i.d)>=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r<0||r+n.length>=t.length?"":(u=t.indexOf("&",r),u<0&&(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);if(t!==""&&(i=e(f(t,n))),i===""){if(n=document.referrer.toLocaleLowerCase(),!n)return"";t=u(n);t!==""&&(i=e(f(t,n)))}DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&&n();return}DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&&(i.SearchTerms&&(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&&(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&&i.aid.length&&i.aid.length>0&&DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&&n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)}},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t<i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r<n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&&(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&&i(n))},e=null;r&&(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&&(e&&clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&&clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&&clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&&window.top.postMessage&&setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},CreateAds:function(n){this.PageRandomNumber=DMAds.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==="weLoadedGPT"?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=e.height*-1);o=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;s=i>t.left&&t.right>=0;u=o&&s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n<DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&&l(n)&&u(n)&&e(n),t.rendered&&(i++,t.sticky&&!t.stickySettings&&(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&&clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n<DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&&(s=!1),!s&&u(n)&&e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o<DMAds.Ads.length&&!r;o++)if(r=!u(o),r)break;r&&(f=setInterval(t,100))};DMAds.GPTRenderingMode==="loading"?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange");n&&document.addEventListener&&document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&&(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&&n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&&(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i<DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&&n.adContainer&&(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,f=DMAds.Ads[n].theAdDiv,u,h,s;if(i&&i.isStickyRequired&&t.getBoundingClientRect&&document.getElementsByClassName){u=document.getElementsByClassName("sticky-stop")[0];u&&(h=r(u),s=u.getBoundingClientRect());var c=r(t),e=t.getBoundingClientRect(),o,l=c.y+e.height+Math.abs(e.top)>h.y;u&&l&&s.top<e.height?o=s.top-e.height+"px":window.pageYOffset+10>=i.absoluteTop&&(o="10px");o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",f.clientHeight===0&&(f.style.height=t.clientHeight+"px"),f.clientWidth===0&&(f.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition}},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&&t.style.position!=="fixed"&&t.offsetParent?i=!0:t&&t.style.position==="fixed"&&(r=window.getComputedStyle(t),i=r&&r.display!=="none"),i&&v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&&(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length>0&&(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))},ShowAd:function(n){var t=DMAds.Ads,i;if(n&&(DMAds.GPTRenderingMode!=="weLoadedGPT"||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==="weLoadedGPT"&&DMAds.PublisherPageViewGuid){while(t&&t.length>0)i=t.pop(),DMAds.RequestQueuedAd(i);n&&DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){if(googletag){var n=function(){if(googletag.pubadsReady)DMAds.GPTRenderingMode!=="weLoadedGPT"&&(DMAds.GPTRenderingMode="gptAlreadyLoaded");else{if(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),DMAds.Ads&&DMAds.Ads[0]&&typeof DMAds.Ads[0].cookieConsent!="undefined"){var n=DMAds.Ads[0].cookieConsent?1:0;googletag.pubads().setRequestNonPersonalizedAds(n?0:1)}googletag.pubads().enableAsyncRendering();googletag.enableServices();DMAds.GPTRenderingMode="weLoadedGPT";googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})}};googletag.apiReady?n():googletag.cmd.push(function(){n()})}},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length<2048&&(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f=n.cookieConsent!==undefined,e=n.cookieConsent?1:0,o="<div id='"+t+"'>     <script type='text/javascript'>         googletag.cmd.push(function() {             if ( "+f+" && typeof googletag.pubads == 'function') {               googletag.pubads().setRequestNonPersonalizedAds("+e+" ? 0 : 1);            }            googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     <\/script> <\/div>";return"<script type='text/javascript'> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); <\/script>"+o},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\<\>\[\]]/gi,"");for(var r=t.split(","),u=[];r.length>0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&&n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r>=0&&(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&&(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=DMAds.PIIViolatingUrls.length;n<r&&t;n++)t=!(i.indexOf(DMAds.PIIViolatingUrls[n])>=0)}catch(u){console.log("Error in IsPagePIICompliant: "+u)}return t},OnSlotRendered:function(n){if(window.location.href&&window.location.href.includes("show_creative_id=1")&&n&&n.creativeId&&console.log(n.creativeId),EnableMutableAds&&n&&!n.isEmpty&&(!n.lineItemId||n.lineItemId&&n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&&n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&&(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u<s;u++)h.test(f[u].getAttribute(n))&&(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r<o;r++)s.test(u[r].className)&&(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length<=0)&&(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t<n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var u,f,r,o=n.attributes,s=o.length,i={},e=0;e<s;e++)u=o.item(e),u.nodeName.indexOf("lqm_")===0&&(f=u.nodeName.slice(4),i[f]=u.value||u.nodeValue),u.nodeName.indexOf("data-")===0&&(f=u.nodeName.slice(5),i[f]=u.value||u.nodeValue);return r={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,cookieConsent:i.cookieconsent,theAdDiv:n},r.tags&&(r.tags=decodeURIComponent(r.tags)),DMAds.DetermineTagSize(r),r.publisher&&r.publisher===CodeProjectPublisherId&&(r.articleid=DMAds.GetArticleId(r.publisher)),r},SetupAds:function(){DMAds.IsPagePIICompliant()&&(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),DMAds.CreateAds())},Initialise:function(){if(DMAds.IsPagePIICompliant())if(window.googletag)DMAds.SetupAds();else{var t="https:"===document.location.protocol,n=document.createElement("script");n.async=!0;n.type="text/javascript";n.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";n.onload=this.SetupAds;document.body.appendChild(n)}}};window.DMAds=DMAds}if(DMAds.IsPagePIICompliant())if(window.addEventListener)window.addEventListener("load",function(){DMAds.Initialise()},!1);else try{window.attachEvent("onload",function(){DMAds.Initialise()})}catch(e){DMAds.Initialise()}</script><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div style="position: fixed; z-index: 9999; height: 289px;" id="credential_picker_container"><iframe src="COM%20in%20plain%20C%20-%20CodeProject_files/select.html" title="Sign in with Google Dialog" style="height: 289px; width: 391px; overflow: hidden;"></iframe></div></body></html>