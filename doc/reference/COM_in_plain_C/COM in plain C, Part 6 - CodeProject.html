<!DOCTYPE html>
<html lang="en" class=" rydvytyqb idc0_348"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

	

	
	<link rel="preconnect" href="https://apps.developermedia.com/">
	<link rel="preconnect" href="https://cdn1.developermedia.com/">
	<link rel="preconnect" href="https://cdn.ampproject.org/">
	<link rel="preconnect" href="https://fonts.googleapis.com/">
	<link rel="preconnect" href="https://ajax.googleapis.com/">
	<link rel="preconnect" href="https://adservice.google.com/">
	<link rel="preconnect" href="https://www.googletagservices.com/">
	<link rel="preconnect" href="https://www.googletagmanager.com/">
	<link rel="preconnect" href="https://www.google.com/">
	<link rel="preconnect" href="https://www.google-analytics.com/">
	<link rel="preconnect" href="https://pagead2.googlesyndication.com/">

	<link rel="preconnect" href="https://codeproject.freetls.fastly.net/">


	<link rel="preload" href="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/jquery-3.4.1.min.js" as="script" type="text/javascript">


	<title>COM in plain C, Part 6 - CodeProject</title> 
    
	<!-- inlined file /App_Themes/CodeProject/Css/article.critical.min.css. Minimized in Release. -->
<style type="text/css">
.blank-background{background-color:#fff}html,div,span,applet,object,iframe,a,abbr,acronym,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,fieldset,form,label,table,tbody,tfoot,thead,tr,th,td,li,ol,ul{margin:0;padding:0;border:0}html{font-size:16px;-webkit-font-smoothing:antialiased;font-smooth:always}body,p,h1,h2,h3,h4,h5,h6,li,tr,td,th,dd,dt{font-family:"Segoe UI",Arial,Sans-Serif;font-size:16px;line-height:1.4;color:#111}body{margin:0}h1,h3,h4,h5,th{font-weight:bold}h1{color:#333;padding:0;margin:0 0 7px;text-align:left}h2{margin:20px 0 11px;padding:0;padding-bottom:10px;color:#333}h1{font-size:38px;font-weight:400}h2{font-size:29px;font-weight:400}h4{font-size:17px}table{background-color:Transparent}img{-ms-interpolation-mode:bicubic}a{text-decoration:none;color:#005782}a:visited{color:#800080}a:hover{text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}input[type="text"],input[type="url"],input[type="search"],input[type="email"],input[type="number"],input[type="password"],select,textarea{border:1px solid #d7d7d7;font-size:16px;padding:5px}a.button,a.button-large,.button,.button-large{color:#fff;background-color:#e08900;border:1px solid #ccc;text-decoration:none;white-space:nowrap;font-size:100%;padding:4px;cursor:pointer;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}table.small-text td,ul.small-text li,ol.small-text li,.small-text{font-size:14px}.invisible{display:none}.subdue,.subdue li,tr.subdue td{color:#808080}.align-left{text-align:left}.align-right{text-align:right}.align-center{text-align:center}.float-right{float:right}.float-left{float:left}.sticky{position:sticky;top:0}.extended{width:100%;box-sizing:border-box}.padded-top{padding-top:20px}.tight{margin:0;padding:0}.nowrap{white-space:nowrap}.fixed-layout{table-layout:fixed}.clipped{overflow:hidden}.raised{background-color:#fff8df;border:1px solid #ccc;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}ol,ul{padding-left:40px;margin:10px 0}ol.compact li,ul.compact li,ol li.compact,ul li.compact{font-size:14px}.callout{margin:20px 0;background-color:#ffffe1;color:#333;border:1px solid #ccc;padding:15px;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}.trace{padding:20px;background-color:#eee;color:#333;border:1px solid #f00;font-size:13px}textarea,input[type="text"],input[type="button"],input[type="submit"]{-webkit-appearance:none;border-radius:0}.container-content{background-color:#fff;position:relative;zoom:1;padding:0 9px;cursor:default}.container-content-wrap{margin:auto;max-width:1270px}.flex-container{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.flex-extend{justify-content:space-between}.flex-wrap{flex-wrap:wrap}.flex-item{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.flex-item-tight{flex:0 1 auto}.hover-container{display:block;position:relative}.clearfix:after,.container:after{display:block;content:'.';visibility:hidden;height:0;clear:both}.clearfix,.container{display:inline-block;display:block}.access-link,.access-link img{position:absolute;top:0;left:0;width:1px;height:1px;z-index:101;border-style:none;margin-top:-1px;overflow:hidden}.site-top-menu{white-space:nowrap;position:absolute;z-index:101;width:100%}.site-top-menu .main-content{width:100%}.site-top-menu .main-content .memberbar{margin-left:90px;margin-right:10px}.site-top-menu.fixed .main-content{margin:auto;max-width:1270px}.site-header{background-image:url('/App_Themes/CodeProject/Img/logo135-bg.gif');white-space:nowrap;overflow:hidden}.site-header .main-content{position:relative;overflow:hidden;white-space:nowrap}.site-header .logo{display:inline-block}.site-header .promo{display:inline-block;position:absolute;top:33px;right:0}.site-header.fixed .main-content{margin:auto;max-width:1270px}.sub-headerbar{padding-right:9px;position:relative;margin:auto;max-width:1270px}.sub-headerbar-divider{margin-left:10px;height:1px;border-bottom:1px solid #ccc;position:absolute;bottom:2px;left:0;right:9px}.memberbar{height:25px;padding-top:10px;color:#999;font-size:14px}.memberbar a{color:#808080;font-size:14px}div.navbar{white-space:nowrap}.navmenu{background:#fff;color:#4d4d4d;padding:0;margin:0;list-style:none;height:25px}.navmenu ul,.navmenu li{margin:0;padding:0}.navmenu .has-submenu{position:absolute;right:5px;padding-left:10px}.navmenu>li:hover>a,.navmenu>li>a:active{border:1px solid #ccc}.navmenu ul,.navmenu>li.open:hover>a,.navmenu>li.open>a:active{border:1px solid #ccc;border-bottom-color:#fff}.navmenu>li{margin:0 11px 2px 2px}.navmenu>li:active,.navmenu>li:active>a,.navmenu>li:hover,.navmenu>li>a:active{background:#fff;color:#4d4d4d}.navmenu>li>a{padding:2px 7px 6px 7px;border:1px solid transparent;font-weight:bold}.navmenu a{display:block;float:left;color:#666;background:#fff;font-size:17px;padding:0 9px;text-decoration:none;white-space:nowrap}.navmenu a.fly{white-space:nowrap}.navmenu ul{background:#fff;position:absolute;left:-9999px;top:-9999px;list-style:none}.navmenu li{float:left;color:#4d4d4d}.navmenu li.last{height:9px}.navmenu li a:active,.navmenu li a:hover{color:#fff;background-color:#f90}.navmenu li>a:active,.navmenu li:hover,.navmenu li:hover>a,.navmenu li:hover.heading,.navmenu li a.selected{position:relative;color:#fff;background-color:#f90}.navmenu li.openable:hover ul{left:0;top:30px;z-index:500}.navmenu li.openable:hover>ul ul{position:absolute;left:-9999px;top:-9999px;width:auto}.navmenu li.open{position:relative}.navmenu li.open a{color:#fff;background-color:#f90}.navmenu li.open ul{left:0;top:30px;z-index:500}.navmenu li ul{border-bottom:5px solid #f90}.navmenu li li{float:none}.navmenu li li:active>a.fly,.navmenu li li:hover>a.fly{color:#fff;background-color:#f90}.navmenu li li a{float:none;font-size:16px;font-weight:normal}.navmenu li li a.fly{color:#4d4d4d;background-color:#fff;padding:2px 20px}.navmenu li li a.break{margin-bottom:15px}.navmenu li li a.highlight1,.navmenu li li a.highlight1:active,.navmenu li li a.highlight1:hover{background-color:#090}.navmenu li li a.highlight2,.navmenu li li a.highlight2:active,.navmenu li li a.highlight2:hover{background-color:#f90}.navmenu li li a.highlight3,.navmenu li li a.highlight3:active,.navmenu li li a.highlight3:hover{background-color:#000}.navmenu li li a.highlight1,.navmenu li li a.highlight2,.navmenu li li a.highlight3{color:#fff;font-size:16px;margin:5px 0;padding:9px 20px}.site-footer{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;padding-top:5px;width:100%;font-size:13px;color:#999}.site-footer .align-left,.site-footer .align-center,.site-footer .align-right{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.site-footer .align-left{flex:1 0 100px}.site-footer .align-center{flex:0 1 0%;white-space:nowrap}.site-footer .align-right{flex:1 0 100px}.site-footer .page-width .active{border-bottom:2px solid #f90}.searchbar{padding:0}.searchbar .search{margin-bottom:4px;padding:2px 5px 0;border:1px solid #ccc}.searchbar .search.subdue{color:#ccc}.searchbar input.search{width:190px;border:none;font-size:13px;padding:4px 2px}.searchbar .search-advanced{padding:8px;width:203px;z-index:1000;background-color:#fff;border:solid 1px #ccc;position:absolute;top:-4px;right:0}.searchbar .popup{display:none}.search td{background-color:#fff}.article-container-parts{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.article-container{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;background-color:#fff;color:#111;zoom:1;position:relative;max-width:100%;min-height:675px}.article-container .article{margin:0 20px 0 10px;line-height:143%}.article-container span.stats{margin-left:30px}.article-left-sidebar{width:120px;min-width:120px;min-height:400px;font-size:14px;border-right:1px solid #f2f2f2;padding:0}.article-left-sidebar .article-left-sidebar-inner{width:120px;min-width:120px}.article-left-sidebar .tabs>div{padding:5px 0 5px 10px}.article-left-sidebar .selected{font-weight:bold;background:transparent url("/images/right-selected.gif") no-repeat scroll right 9px}.article-left-sidebar .original{color:#808080;margin:-10px 0 0 15px}.article-left-sidebar h4{color:#f90;font-size:14px;font-weight:bold}.article-left-sidebar .stats div div div{padding:0 0 10px 10px;color:#666}.article-right-sidebar{width:300px;margin-left:10px;font-size:14px}.article-right-sidebar .gototop{text-align:center;padding:10px 0;opacity:0;-webkit-transition:opacity .3s linear 0ms;-moz-transition:opacity .3s linear 0ms;-o-transition:opacity .3s linear 0ms;transition:opacity .3s linear 0ms}.container-content .edit-links{margin:21px 0 0 10px}.article-summary{padding:0 10px 0 10px;overflow:hidden}.article h1{margin:0 0 15px 0}.article h2{color:#f90}.article .header .title{color:#808080}.article .header .author{font-weight:bold;min-width:100px}.article .header .author a{color:#808080}.article .header .avatar{max-width:48px;max-height:48px;overflow:unset}.article .header .avatar-wrap{width:48px;height:48px;margin-right:10px;text-align:center}.article .header .date{white-space:nowrap}.article .header .license{margin-left:15px}.article .header .stats{margin-left:30px}.article .summary{color:#808080;padding:40px 0 15px 0}.article .text{padding-top:10px}.article-nav{text-align:right;margin-top:21px;vertical-align:middle;line-height:15px}span.math{display:inline-block}.msg-728x90{width:728px;height:90px;overflow:hidden}.msg-300x250{width:300px;height:250px;overflow:hidden}.tags{line-height:190%}.tags .t{background:none repeat scroll 0 0 transparent;border:1px solid #fbedbb;border-radius:12px 0 0 12px;line-height:1.4;padding:0 2px 2px 3px;position:relative;text-decoration:none;margin:2px 5px 4px 0;white-space:nowrap}.tags .t a{color:#666;display:inline-block;margin-right:3px;padding-left:5px;text-overflow:ellipsis}.container-breadcrumb{font-size:14px;margin-top:7px;color:#808080;margin:12px 0 35px}.container-breadcrumb a{color:#808080}.speech-bubble-container-down,.speech-bubble-container-up,.speech-bubble-container-up-right,.speech-bubble-container-left,.speech-bubble-container-right{position:relative}.ie .speech-bubble-container-up,.firefox .speech-bubble-container-up,.chrome .speech-bubble-container-up,.ie .speech-bubble-container-up-right,.firefox .speech-bubble-container-up-right,.chrome .speech-bubble-container-up-right{margin-top:-4px}.tooltip{position:relative;text-decoration:none}.tooltip .speech-bubble-container-up,.tooltip .speech-bubble-container-down,.tooltip .speech-bubble-container-left,.tooltip .speech-bubble-container-right,.tooltip .speech-bubble-container-up-right,.tooltip .tooltip-flyout{display:none;opacity:0;-webkit-transition:opacity .5s linear 0ms;-moz-transition:opacity .5s linear 0ms;-o-transition:opacity .5s linear 0ms;transition:opacity .5s linear 0ms}.micromodal{display:none}.bottom-promo{height:90px;margin-top:10px;overflow:hidden}.bottom-promo .msg-728x90{width:728px;margin:0 auto}.msg-728x90{overflow:hidden;position:relative;height:90px;min-width:728px}body .msg-728x90{*float:right}body .bottom-promo .msg-728x90{*float:none}table.forum{table-layout:fixed;margin:0 0 20px 0;padding:0;width:100%}.forum table{border-collapse:separate}.forum .header1,.forum .header1 TD{color:#333;font-size:14px;vertical-align:middle}.forum .header2,.forum .header2 TD{color:#fff;background-color:#f90;font-size:14px;vertical-align:middle}.forum .header2 input,.forum .header2 TD input,.forum .header2 select,.forum .header2 TD select{padding:2px}.forum .button{border:1px solid #fc6;margin:1px}.forum .searchbar{border:1px solid #ccc;padding:4px 0 0 0;margin:3px 0}.forum .searchbar .search{width:200px}.forum .searchbar input[type=image]{vertical-align:middle}.forum .dropdown{background-color:#fffdfa;font-size:95%;margin-left:5px}.forum .footer,.forum .footer td,.forum .navbar,.forum .navbar td{font-size:14px;padding:8px 0;border:0;border-top:1px solid #808080}.author-wrapper{position:relative}.author-wrapper .profile-pic{border:1px solid #333;margin:0 13px 0 0;padding:10px;-moz-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);-webkit-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);max-height:100px}.author-wrapper .container-member .author{font-size:29px;color:#333;font-weight:600}.rating-container .rating-prompt{padding-right:5px;white-space:nowrap;line-height:25px;margin-right:2px;font-weight:bold;color:#808080}.rating-container .rating-votes{margin-left:5px}.rating-container.large-stars,.rating-container.medium-stars,.rating-container.small-stars{margin-left:7px}.rating-container.large-stars .rating-votes,.rating-container.large-stars .rating-prompt,.rating-container.large-stars .rating-poor,.rating-container.large-stars .rating-good{line-height:25px}@media(min-width:1024px){.desktop-lg-block-only{display:none}.desktop-only{display:inherit}.desktop-block-only{display:block}.tablet-only,.tablet-block-only{display:none}.mobile-only,.mobile-block-only{display:none}.desktop-only.tablet-only{display:inherit}.desktop-block-only.tablet-block-only{display:block}}@media(min-width:821px){.desktop-lg-block-only{display:none}.tablet-only,.mobile-only{display:none}.tablet-block-only,.mobile-block-only{display:none}.tablet-only.desktop-only{display:inherit}.tablet-block-only.desktop-block-only{display:block}}.rrssb-buttons,.rrssb-buttons li,.rrssb-buttons li a{-moz-box-sizing:border-box;box-sizing:border-box}.clearfix{*zoom:1}.clearfix:after{clear:both}.clearfix:before,.clearfix:after{content:" ";display:table}.rrssb-buttons{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;height:40px;margin:0;padding:0;width:100%}.rrssb-buttons li{float:left;height:100%;list-style:none;margin:0;padding:0 2.5px;line-height:13px}.rrssb-buttons li.email a{background-color:#0a88ff}.rrssb-buttons li.facebook a{background-color:#306199}.rrssb-buttons li.linkedin a{background-color:#007bb6}.rrssb-buttons li.twitter a{background-color:#26c4f1}.rrssb-buttons li.reddit a{background-color:#8bbbe3}.rrssb-buttons li.pinterest a{background-color:#b81621}.rrssb-buttons li.compact{padding:0 4.5px}.rrssb-buttons li.compact a{border-radius:50%;padding:0 7px 0 32px}.rrssb-buttons li.compact a .icon{left:7px;top:-3px;width:5%;transform:scale(.85)}.rrssb-buttons li.compact a .icon svg{height:auto;width:auto}.rrssb-buttons li a{background-color:#ccc;border-radius:3px;display:block;font-size:11px;font-weight:bold;height:100%;padding:11px 7px 12px 27px;position:relative;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:100%;-webkit-transition:background-color .2s ease-in-out;-moz-transition:background-color .2s ease-in-out;-o-transition:background-color .2s ease-in-out;transition:background-color .2s ease-in-out}.rrssb-buttons li a .icon{display:block;height:100%;left:10px;padding-top:9px;position:absolute;top:0;width:10%}.rrssb-buttons li a .icon svg{height:17px;width:17px}.rrssb-buttons li a .icon svg path,.rrssb-buttons li a .icon svg polygon{fill:#fff}
</style>
<link rel="stylesheet" type="text/css" href="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/Main.min.css" media="all" onload="if(media!='all')media='all'">
<noscript><link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8:2023-08-14:1"></noscript>


    <script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/jquery-3.4.1.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/article.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/client" defer="defer" async=""></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/MemberProfilePopup.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/a.min.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="How to write an ActiveX Script Host in C.">
<meta name="Keywords" content="C++, Windows, Visual-Studio, Dev, COM, Beginner">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/COM-in-plain-C-Part-6.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="7/23/2006 4:30:00 AM">
<meta property="article:modified_time" content="7/23/2006 4:30:00 AM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Jeff Glatt">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="25 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6">
<meta property="og:title" content="COM in plain C, Part 6">
<meta property="og:description" content="How to write an ActiveX Script Host in C.">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Python" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=34">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">

<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6"
   },
  "name": "COM in plain C, Part 6",
  "headline": "COM in plain C, Part 6",
  "url": "https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6",
  "discussionUrl": "https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "C++,Windows,Visual-Studio,Dev,COM,Beginner",
  "commentCount": "15",
  "editor" : {
    "@type" : "Person",
    "name" : "Smitha Nishant",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=28970"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "How to write an ActiveX Script Host in C.",
  "articleSection": "C++",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2006-07-23",
  "dateCreated": "2006-07-23",
  "dateModified": "2006-07-23"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.89,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Languages",
      "name" : "Programming Languages"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Cplusplus",
      "name" : "C++"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-YZNPNQ0F2S' , {'user_id': '9bd02f62-656b-43b1-a8e3-74fba4e7f215'});
    </script>

<style id="googleidentityservice_button_styles">.qJTHM{-moz-user-select:none;color:#202124;direction:ltr;font-family:"Roboto-Regular",arial,sans-serif;font-weight:400;margin:0;overflow:hidden}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-moz-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;transition:background-color .218s,border-color .218s;-moz-user-select:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;flex-direction:row;justify-content:space-between;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-moz-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><style type="text/css"></style><link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/style.css"><style></style><link href="data:text/css,%5Bid*%3D'google_ads_iframe'%5D%2C%5Bid*%3D'taboola-'%5D%2C.taboolaHeight%2C.taboola-placeholder%2C%23credential_picker_container%2C%23credentials-picker-container%2C%23credential_picker_iframe%2C%5Bid*%3D'google-one-tap-iframe'%5D%2C%23google-one-tap-popup-container%2C.google-one-tap-modal-div%2C%23amp_floatingAdDiv%2C%23ez-content-blocker-container%2C%23notify-adblock%7Bdisplay%3Anone!important%3Bmin-height%3A0!important%3Bheight%3A0!important%3B%7D" rel="stylesheet" type="text/css"></head>	

<body class="firefox firefox116"><div class="cc-revoke cc-bottom cc-animate cc-color-override--316233370" style="display: none;">Cookie Policy</div><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-banner cc-type-opt-in-out cc-theme-edgeless cc-bottom cc-color-override--316233370 " style=""><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href="https://www.codeproject.com/info/cookie.aspx">Cookie Policy</a>, <a href="https://www.codeproject.com/info/privacy.aspx">Privacy Policy</a>, and our <a href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Service</a>. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://www.codeproject.com/info/privacy.aspx" rel="noopener noreferrer nofollow" target="_blank">Learn more</a></span><div class="cc-compliance cc-highlight"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Ask me later</a><a aria-label="deny cookies" role="button" tabindex="0" class="cc-btn cc-deny">Decline</a><a aria-label="allow cookies" role="button" tabindex="0" class="cc-btn cc-allow">Allow cookies</a></div><!--googleon: all--></div>

	<div id="ctl00_OneTap_OneTap">
    <div id="g_id_onload" data-client_id="857795997829.apps.googleusercontent.com" data-login_uri="/script/Membership/OAuthLogOn.aspx?auth=Google">
    </div>
</div>



	<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">15,723,416 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin">
				<a data-micromodal-trigger="modal-1" href="javascript:;">Sign in</a>
				<!--<a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6">Sign in</a>-->

				<div class="micromodal" id="modal-1" aria-hidden="true">

					<div class="modal__overlay" tabindex="-1" data-micromodal-close="">
					  <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">

						<header class="modal_header">
							<h4 class="modal_title" id="modal-1-title">
								Sign in
							</h4>
							<button class="modal_close" aria-label="Close modal" data-micromodal-close=""></button>
						</header>

						<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" method="post" class="tight align-left">

							
							<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

							<div>Email</div>
							<div><input type="email" name="Email" id="Email" autocomplete="email" data-ddg-inputtype="credentials.username"></div>
							<div>Password</div>
							<div><input type="password" name="Password" id="Password" autocomplete="current-password" data-ddg-inputtype="credentials.password"></div>
							<div class="action">
								<input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
								<input type="hidden" name="fld_quicksign" value="true">
								<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
							</div>

							<div class="container">						
								<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6">Forgot your password?</a>
							</div>
						</form>

						<hr class="divider-dark">

						Sign in with &nbsp;<a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/octicons_github-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/facebook-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/google-plus-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/microsoft-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>



					  </div>
					</div>
				  </div>

            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesCplusplus" data-country="US" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesCplusplus&sz=728x90&c=884252"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesCplusplus&sz=728x90&c=884252"  width="728px" height="90px" target="_blank"/></a></noscript><iframe id="dm-gpt-iframe-1" width="728" height="90" marginwidth="0" marginheight="0" frameborder="0" scrolling="no"></iframe></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar flex-container flex-extend flex-wrap fixed">
		<div class="flex-item" style="min-width:20rem">
			

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Browse Topics<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=268" style="padding-left:30px">View Python questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=91" style="padding-left:30px">View Java questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_CodeProjectAI" class="fly" href="https://www.codeproject.com/Feature/CodeProjectAI-Discussions.aspx">CodeProject.AI Server</a></li>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1969389/Artificial-Intelligence">Artificial Intelligence</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1969388/Internet-of-Things">Internet of Things</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1988311/Python">Python</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/WPF">WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">features</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_SiteBlog" class="fly break" href="https://www.codeproject.com/Members/CodeProject#_comments">The CodeProject Blog</a></li>

		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
		</div>
		<div class="flex-item-tight align-right">
			

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q" data-ddg-inputtype="unknown"></td><td><input type="image" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
		</div>
		<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Languages">Programming Languages</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Cplusplus">C++</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner sticky">

                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=14905">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=14905">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=14905">Revisions</a></div>
<div><a href="#_comments">Comments (15)</a></div>
<div>Posted 22 Jul 2006</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>100.2K views</div><div>2.4K downloads</div><div>101 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="FvK/qlEmcwGHrUmbvr5FI/wcJ1MzIuWJ8xZH7RkAKpbimCErkH22mGSLcZqDqKUn078lxTSodOVg521YCNDdGzOhS9/thHic99kl6Yy0o88m1mDmOfiT+aqTKrNQ1FL6SAOeyeeeWGPBinwiusLDWfxkQnLBdIGoy4ISRVfeKLCBgGszWeNiE29H0t3Gb7gLPOzwRYqPyaNB08peoSDQ1sbLwaPHC3oRQaIsO3XgxwEZUa4ccUi1l46zH/z1aQ8tGAmZuJAYoQMiVFEpCsasU4k7hjtl+Mp/oqmrQ91heFFZSYSZEwS+M6jJ8bFodk42/ifwzq1Eal9Y7ETV6mCTTwH5MikIpz8ICJCLLfHBB107MG7uQkWspqC2sR9rWLPTdoCJBuNcIl6Abbnd0Z9GkMGtU/AVBF0AE4aDHPlO/FPRCkQi+JV9JEkmkoHphnaDsg7bUdjUfA5Pm0dn+AIrLKFKgA4IcV+N9GpagxTkozt2OfNoQEYUIPm99p4oNRURcv+Yn632c8VoC/7aP3aWu4SktnKAFfmsr4XIO6QHJ45Qmj2e5a+uu9CiT8OzHM7vn9rmkjwN8PvyvEu+2YxcxXv7KWA0i1pXyhfOddGjH4tiGZC7lqcchrvMliOWG0PCsa5Se9eeD/C5cqD9mHS+QmgUD6TJQZ+3hCwFXgLCuyMIn2LQU5yApReqTKsvc25AylQ5eOq4CEbYtYBHsQ+obSkRKZccongCMUOEv3CA8l3SkHLTrQTiWD5Xcw1ak5974iTnZluv/pxrBonqgroee2ge2+iaG0zK/VSLZrOFP5z8AziJ6nskhzyy38/2BNbGCsyfJ0r08RnDuXxPwPc0U8uEp0d9Rh7cb1MauUC4jBkwKUPORbR9xOpCjij/yMm5x+LW5Ma6rgVgNTVWkRKYBsp1KwV8z7bR0VmjE4NBN7yOdjcjDdlvN8FPteE1qQjJ/0T9CpCUrHoNvANNOrbeiANEXcjourorL7nlm/sWS3k+JNbo7KP3emn32T2yqEB5DyUP/jjAufmjB+m0LVrqNuZxkzIS+a1IhwVWieLWRRvd1QgNsbtn3K3hLlOH2OZs72YL2lSCQmkfZbgWZXctUSLAQrdIwVsDYlUKJ3x0tG4io344ISa3bczz0mD7JM/M6YH1QRdmE3nYtWzC4/g4BcgsPmXsn9OFR8+E6XNCZ416nK4ACVdnsr6l3G14zpfXtc9By9O6tUWytNOKC8MJg8k0gdbu51MqPMrWv1M60yZ8qAw6y5IMt2dDNVsO0l9vX0ZBB944p3Im58JGcZRXVwLEFpLMuw28iP0ktUYFbm3E2Y+L59C+s0yeg64BTccAcQrzyvtdoY6J/h7o8ZUhZ+CfrPccKyz/67AazNujGQuRg4YAaKeU3eCS6G4Ifci/FGtXY4Z4zehalKUG4zuYTZhh7g6VopYjDvqisJNoWGVwx1CFGU2sJTWSPy3aPezWiS+CMVihepx5JltCP8K4nkxNBW8npAMQlM2BV+nB9Iy7g5E6TPwhddl+FuBMeV/4FGKlyRtqNV8V1TbIVQLTTPiL/z1FByulICmH/30QmKNEq6o5w7Rn43mn7dwNdm/T113gSyl/73m29wfFxX5DG0LyRodajhnVfwrz+IkO9L6hxCl03FQdNXof2pi3fmg5Ac+lnJcQ3jRmHnViCAYNTr9O64ZTrbyFj7Cuu5uL5BipIYuTK3kZ0HKXJtGvRH2rOWLsfMMVUVm0lBwrNVb2Q+I2v6x1IOSbpK5+mmsoWt9khTyyI3g6b3xgNnDWag6mxnhVa541e0mq4c5RV8K+KlEf1DT10RQaOH0XlR5qxbX1xDPOIR/LFIH2c9Zd0gLjsPxSo2HM/eFa7McQy25deWPfAVooMUDOMgbKv3/1ov+u+YKK7z/QmISiR2w3pjw0ppwGzw==">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, Part 6</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_14905_1">

	<meta itemprop="upvoteCount" content="31">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:21px;" class="clipped"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:3px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.89/5  (32 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">22 Jul 2006</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">25 min read</span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">How to write an ActiveX Script Host in C.</div><span id="ctl00_ThumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c6/com_in_c6_src.zip">Download source files - 305 Kb</a> </li></ul>
<h2>Contents</h2>
<ul>
<li><a href="#INTRO">Introduction</a> 
</li><li><a href="#GUID">Choosing/opening an engine</a> 
</li><li><a href="#HOST">Our IActiveScriptSite object</a> 
</li><li><a href="#SCRIPT">An example VBScript</a> 
</li><li><a href="#INIT">Initializing the engine</a> 
</li><li><a href="#ADD">Adding a script to the engine</a> 
</li><li><a href="#RUN">Running scripts</a> 
</li><li><a href="#CLOSE">Closing an engine</a> 
</li><li><a href="#LOAD">Loading a script</a> 
</li><li><a href="#ENUM">Enumerating installed engines</a> 
</li><li><a href="#THREAD">Running a script in another thread</a> </li></ul>
<h2><a name="INTRO">Introduction</a></h2>
<p>When creating an application, it's desirable to provide the end user 
with a "macro language" he can use to write scripts (i.e., text files 
containing "instructions" or "commands") which control the operation of 
your application. For example, if you've created an email program, 
perhaps you'd like to let the end user write some script which can send 
an email to a particular address. To do that, perhaps your macro 
language will provide a <code>SendMail</code> function that the script 
calls, passing an email address, and text body, (each double-quoted), 
and the syntax would look like so:</p><div class="pre-lang" id="premain533997"><div></div><div class="pre-action-link"><span id="copycode533997" class="copy-code" data-index="533997" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre533997" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">SendMail(<span class="code-string">"</span><span class="code-string">somebody@somewhere.com"</span>, <span class="code-string">"</span><span class="code-string">hello"</span>)</pre>
<p>With a macro language, the end user can write a script to 
automatically perform repetitive operations (hence the term "automation"
 is used to describe a script controlling an application), or perhaps 
even add new functionality to your application (if your macro language 
is powerful/flexible enough).</p>
<p>Microsoft decided to add a macro language to many of its products 
such as Word, Excel, etc. In fact, MS decided to use a simplified 
variation of Visual Basic as the basis for the macro language. So, MS 
put that simplified version of the Visual Basic interpreter (without 
features such as being able to compile a script into an executable, and 
other advanced features) into a DLL. Then, MS put particular COM objects
 inside that DLL which Word or Excel could obtain/use to tell the 
interpreter to run a VB script, and interact with the application's own 
functions. For example, one of the special COM objects is an <code>IActiveScript</code> object. MS called their new, simplified VB-interpreter-in-a-DLL (with a COM interface) <b>VBScript</b>. And the DLL, with that specific set of COM objects, is referred to as an <b>ActiveX Script Engine</b>.</p>
<p>Then, MS got to thinking that it would be nice to give the end user 
his choice of macro language. For example, some end users may want to 
write their scripts using a Java-like language instead of VBScript. So, 
MS also created another DLL containing an interpreter that implemented a
 simplified variation of Java. This interpreter was called <b>JavaScript</b>.
 The JavaScript DLL contained the same set of COM objects as the 
VBScript DLL. MS devised these COM objects so that they were mostly 
"language neutral". In other words, Excel could give the JavaScript DLL a
 JavaScript file to run in the exact same way that Excel could give the 
VBScript DLL a VBScript file to run. So now, the end user had his choice
 of two ActiveX Script Engines to use. Later, other third parties 
packaged their interpreters into a DLL, with these same set of COM 
objects, and now you can find ActiveX Script Engines in a variety of 
other languages such as Python, Perl, etc. And any of them can be used 
with any application that supports any ActiveX Script Engine.</p>
<p>An application that utilizes an ActiveX Script Engine is referred to as an <b>ActiveX Script Host</b>.</p>
<p>In order for an application to interact with the engine, the 
application (EXE) has to have its own, special COM object inside of it 
known as an <code>IActiveScriptSite</code> object. The application calls one of the engine's COM object functions to give it a pointer to the application's <code>IActiveScriptSite</code>
 COM object. Then, the engine and application can communicate, and 
coordinate the running of a script via their COM objects' functions.</p>
<p>This article will detail how to write an ActiveX Script Host -- that 
is, how to write an application (EXE) that can load one of these ActiveX
 Script Engines (DLL), and call the engine's COM objects to run some 
script (text file) containing instructions in that engine's language. In
 our particular example, we'll use the VBScript engine, and so our 
example script file will contain VBScript instructions. But we could 
easily use any other engine, and write our script using that engine's 
language instead.</p>
<blockquote>
<p><b>In conclusion</b>, an ActiveX Script Engine is an interpreter that
 contains some standard COM objects defined by Microsoft. It can be used
 by any application (i.e., executable) that knows how to utilize those 
COM objects. Such an application is called an ActiveX Script Host. A 
properly written host should be able to use any engine interchangeably.</p></blockquote>
<h2><a name="GUID">Choosing/opening</a> an engine</h2>
<p>Every ActiveX script engine must have its own unique GUID. So, if you
 know what particular engine you wish to use, you can pass that engine's
 GUID to the function <code>CoCreateInstance</code> to open that script engine and get its <code>IActiveScript</code> object (just like in the very first chapter, we wrote an application that passed our <code>IExample</code> object's GUID to <code>CoCreateInstance</code> and got an <code>IExample</code> object). You should be able to find the engine's GUID in some include file shipped with the engine's "development kit".</p>
<p>An ActiveX engine can also associate itself with files whose names 
end in a particular extension, just like an application can set a file 
association. The engine's installer will have setup a registry key with 
the associated file extension. For example, the VBScript engine 
associates itself with files whose names end in <i>.vbs</i>. Your 
application can look up the file association in the registry, and get 
the engine's GUID that way. (Then, once you have the GUID, you can call <code>CoCreateInstance</code>).</p>
<p>Here is a function that is passed a file extension, for which you 
wish to get the associated engine's GUID, and a buffer big enough to 
retrieve that GUID. The function looks up the appropriate registry keys 
to find that engine's GUID, and copies it to the buffer:</p><div class="pre-lang" id="premain538929"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="538929" id="preShrink538929">Shrink ▲</span> &nbsp; <span id="copycode538929" class="copy-code" data-index="538929" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre538929" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">HRESULT getEngineGuid(LPCTSTR extension, GUID *guidBuffer)
{
   wchar_t   buffer[100];
   HKEY      hk;
   DWORD     size;
   HKEY      subKey;
   DWORD     type;

   <span class="code-comment">//</span><span class="code-comment"> See if this file extension is associated</span>
   <span class="code-comment">//</span><span class="code-comment"> with an ActiveX script engine</span>
   <span class="code-keyword">if</span> (!RegOpenKeyEx(HKEY_CLASSES_ROOT, extension, <span class="code-digit">0</span>, 
       KEY_QUERY_VALUE|KEY_READ, &amp;hk))
   {
      type = REG_SZ;
      size = <span class="code-keyword">sizeof</span>(buffer);
      size = RegQueryValueEx(hk, <span class="code-digit">0</span>, <span class="code-digit">0</span>, &amp;type, 
             (LPBYTE)&amp;buffer[0], &amp;size);
      RegCloseKey(hk);
      <span class="code-keyword">if</span> (!size)
      {
         <span class="code-comment">//</span><span class="code-comment"> The engine set an association.</span>
         <span class="code-comment">//</span><span class="code-comment"> We got the Language string in buffer[]. Now</span>
         <span class="code-comment">//</span><span class="code-comment"> we can use it to look up the engine's GUID</span>

         <span class="code-comment">//</span><span class="code-comment"> Open HKEY_CLASSES_ROOT\{LanguageName}</span>
again:   size = <span class="code-keyword">sizeof</span>(buffer);
         <span class="code-keyword">if</span> (!RegOpenKeyEx(HKEY_CLASSES_ROOT, (LPCTSTR)&amp;buffer[0], <span class="code-digit">0</span>, 
                           KEY_QUERY_VALUE|KEY_READ, &amp;hk))
         {
            <span class="code-comment">//</span><span class="code-comment"> Read the GUID (in string format)</span>
            <span class="code-comment">//</span><span class="code-comment"> into buffer[] by querying the value of CLSID</span>
            <span class="code-keyword">if</span> (!RegOpenKeyEx(hk, <span class="code-string">"</span><span class="code-string">CLSID"</span>, <span class="code-digit">0</span>, 
                KEY_QUERY_VALUE|KEY_READ, &amp;subKey))
            {
               size = RegQueryValueExW(subKey, <span class="code-digit">0</span>, <span class="code-digit">0</span>, &amp;type, 
                      (LPBYTE)&amp;buffer[0], &amp;size);
               RegCloseKey(subKey);
            }
            <span class="code-keyword">else</span> <span class="code-keyword">if</span> (extension)
            {
               <span class="code-comment">//</span><span class="code-comment"> If an error, see if we have a "ScriptEngine"</span>
               <span class="code-comment">//</span><span class="code-comment"> key under here that contains</span>
               <span class="code-comment">//</span><span class="code-comment"> the real language name</span>
               <span class="code-keyword">if</span> (!RegOpenKeyEx(hk, <span class="code-string">"</span><span class="code-string">ScriptEngine"</span>, <span class="code-digit">0</span>, 
                   KEY_QUERY_VALUE|KEY_READ, &amp;subKey))
               {
                  size = RegQueryValueEx(subKey, <span class="code-digit">0</span>, <span class="code-digit">0</span>, &amp;type, 
                        (LPBYTE)&amp;buffer[0], &amp;size);
                  RegCloseKey(subKey);
                  <span class="code-keyword">if</span> (!size)
                  {
                     RegCloseKey(hk);
                     extension = <span class="code-digit">0</span>;
                     <span class="code-keyword">goto</span> again;
                  }
               }
            }
         }

         RegCloseKey(hk);

         <span class="code-keyword">if</span> (!size)
         {
            <span class="code-comment">//</span><span class="code-comment"> Convert the GUID string to a GUID</span>
            <span class="code-comment">//</span><span class="code-comment"> and put it in caller's guidBuffer</span>
            <span class="code-keyword">if</span> ((size = CLSIDFromString(&amp;buffer[0], guidBuffer)))
               MessageBox(<span class="code-digit">0</span>, <span class="code-string">"</span><span class="code-string">Can't convert engine GUID"</span>, 
                          <span class="code-string">"</span><span class="code-string">Error"</span>, MB_OK|MB_ICONEXCLAMATION);
            <span class="code-keyword">return</span>(size);
         }
      }
   }

   MessageBox(<span class="code-digit">0</span>, <span class="code-string">"</span><span class="code-string">Can't get engine GUID from registry"</span>, 
              <span class="code-string">"</span><span class="code-string">Error"</span>, MB_OK|MB_ICONEXCLAMATION);
   <span class="code-keyword">return</span>(E_FAIL);
}</pre>
<p>So, to look up VBScript's GUID, we can call <code>getEngineGuid</code>, passing the associated file extension of ".vbs" as so:</p><div class="pre-lang" id="premain158330"><div></div><div class="pre-action-link"><span id="copycode158330" class="copy-code" data-index="158330" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre158330" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">GUID  guidBuffer;

<span class="code-comment">//</span><span class="code-comment"> Find the script engine to use for files that end with a .VBS extension.</span>
<span class="code-comment">//</span><span class="code-comment"> NOTE: Microsoft's VBscript engine sets up an association in the</span>
<span class="code-comment">//</span><span class="code-comment"> registry for this extension.</span>
getEngineGuid(<span class="code-string">"</span><span class="code-string">.vbs"</span>, &amp;guidBuffer);</pre>
<p>Now, to load/open the VBScript engine, and get its <code>IActiveScript</code> object (into our variable we'll name <code>activeScript</code>), we can call <code>CoCreateInstance</code>. Note that the <code>IActiveScript</code> object's GUID is defined by Microsoft, using the name <code>IID_IActiveScript</code>, in an include file called <i>activscp.h</i> which can be found in the Platform SDK.</p><div class="pre-lang" id="premain786360"><div></div><div class="pre-action-link"><span id="copycode786360" class="copy-code" data-index="786360" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre786360" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">#include &lt;window.h&gt;
#include &lt;objbase.h&gt;
#include &lt;activscp.h&gt;

IActiveScript  *activeScript;

CoCreateInstance(&amp;guidBuffer, <span class="code-digit">0</span>, CLSCTX_ALL, 
                 &amp;IID_IActiveScript, 
                 (<span class="code-keyword">void</span> **)&amp;activeScript);</pre>
<p>We will also need to get another of the engine's COM objects, called an <code>IActiveScriptParse</code> object. This is a sub-object of the <code>IActiveScript</code> object, so we can pass the <code>IActiveScriptParse</code>'s GUID to the <code>IActiveScript</code>'s <code>QueryInterface</code> function. Microsoft has defined <code>IActiveScriptPars</code>e's GUID with the name <code>IID_IActiveScriptParse</code>. Here, we get this object into our variable named <code>activeScriptParse</code>:</p><div class="pre-lang" id="premain40454"><div></div><div class="pre-action-link"><span id="copycode40454" class="copy-code" data-index="40454" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre40454" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">IActiveScriptParse  *activeScriptParse;

activeScript-&gt;lpVtbl-&gt;QueryInterface(activeScript, 
             &amp;IID_IActiveScriptParse, 
             (<span class="code-keyword">void</span> **)&amp;activeScriptParse);</pre>
<p>
</p><blockquote><b>In conclusion</b>, each ActiveX Script Engine has its own unique GUID. A host can open an engine (and get the engine's <code>IActiveScript</code> and <code>IActiveScriptParse</code> objects) in the same way that any other COM component is accessed -- by passing that unique GUID to <code>CoCreateInstance</code>.
 Furthermore, an engine may be associated with a particular file 
extension, so an engine's GUID can be "looked up" by querying the file 
extension's registry key.</blockquote>
<p></p>
<h2><a name="HOST">Our</a> IActiveScriptSite object</h2>
<p>We need to supply our own COM object called an <code>IActiveScriptSite</code> object. Microsoft has already defined its GUID and VTable (i.e., an <code>IActiveScriptSiteVtbl</code> struct) for us. All we need to do is write the functions for it. Of course, an <code>IActiveScriptSite</code> VTable starts with the <code>QueryInterface</code>, <code>AddRef</code>, and <code>Release</code> functions. It contains 8 more functions called <code>GetLCID</code>, <code>GetItemInfo</code>, <code>GetDocVersionString</code>, <code>OnScriptTerminate</code>, <code>OnStateChange</code>, <code>OnScriptError</code>, <code>OnEnterScript</code>, and <code>OnLeaveScript</code>. Most of these functions are called by the engine when it wants to notify us of something. For example, our <code>OnEnterScript</code> function is called whenever some function in the script is called. Our <code>OnScriptError</code>
 is called when/if there's an error in the script itself. Other 
functions are meant for us to provide information to the engine. For 
example, the engine calls our <code>GetLCID</code> to ask us what language LCID to use for any dialogs the engine may display.</p>
<p>For now, most of our <code>IActiveScriptSite</code> functions can be stub routines that do nothing except return <code>S_OK</code>.</p>
<p>We'll also provide another sub-object of our <code>IActiveScriptSite</code>. This sub-object is referred to as <code>IActiveScriptSiteWindow</code>.
 This sub-object is used by the engine to interact with any application 
windows we may have open. This is an optional object. We don't need to 
provide it, but if our application opens its own windows, then this is a
 useful object to provide.</p>
<p>Because we'll need an <code>IActiveScriptSiteWindow</code> sub-object, we'll define a <code>MyRealIActiveScriptSite</code> struct to wrap both our <code>IActiveScriptSite</code> and <code>IActiveScriptSiteWindow</code>, as so:</p><div class="pre-lang" id="premain147300"><div></div><div class="pre-action-link"><span id="copycode147300" class="copy-code" data-index="147300" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre147300" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   <span class="code-comment">//</span><span class="code-comment"> The IActiveScriptSite must be the base object.</span>
   IActiveScriptSite        site;
   IActiveScriptSiteWindow  siteWnd;
   <span class="code-comment">//</span><span class="code-comment"> Our IActiveScriptSiteWindow sub-object</span>
   <span class="code-comment">//</span><span class="code-comment"> for this IActiveScriptSite.</span>
} MyRealIActiveScriptSite;</pre>
<p>For our purposes, we're going to need only one <code>IActiveScriptSite</code> (and its <code>IActiveScriptSiteWindow</code>), so the easiest thing is to just declare it globally, and also declare the VTables globally:</p><div class="pre-lang" id="premain443686"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="443686" id="preShrink443686">Shrink ▲</span> &nbsp; <span id="copycode443686" class="copy-code" data-index="443686" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre443686" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> Our IActiveScriptSite VTable.</span>
IActiveScriptSiteVtbl SiteTable = {
 QueryInterface,
 AddRef,
 Release,
 GetLCID,
 GetItemInfo,
 GetDocVersionString,
 OnScriptTerminate,
 OnStateChange,
 OnScriptError,
 OnEnterScript,
 OnLeaveScript};

<span class="code-comment">//</span><span class="code-comment"> IActiveScriptSiteWindow VTable.</span>
IActiveScriptSiteWindowVtbl SiteWindowTable = {
 siteWnd_QueryInterface,
 siteWnd_AddRef,
 siteWnd_Release,
 GetSiteWindow,
 EnableModeless};

<span class="code-comment">//</span><span class="code-comment"> Here's our IActiveScript and its IActiveScriptSite sub-object, wrapped</span>
<span class="code-comment">//</span><span class="code-comment"> in our MyRealIActiveScriptSite struct.</span>
MyRealIActiveScriptSite  MyActiveScriptSite;</pre>
<p>And of course, we need to initialize its VTable pointers at the start of our program:</p><div class="pre-lang" id="premain482679"><div></div><div class="pre-action-link"><span id="copycode482679" class="copy-code" data-index="482679" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre482679" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> Initialize the lpVtbl members of our IActiveScriptSite and</span>
<span class="code-comment">//</span><span class="code-comment"> IActiveScriptSiteWindow sub-objects</span>
MyActiveScriptSite.site.lpVtbl = &amp;SiteTable;
MyActiveScriptSite.siteWnd.lpVtbl = &amp;SiteWindowTable;</pre>
<p>In the directory <i>ScriptHost</i>, is an example of a simple ActiveX Script Host. The source file, <i>IActiveScriptSite.c</i>, contains the VTables and functions for our <code>IActiveScriptSite</code> and <code>IActiveScriptSiteWindow</code> objects (which are wrapped up in our own <code>MyRealIActiveScriptSite</code>
 struct). As mentioned in this example, most of the functions are simply
 stub routines that do nothing. The only non-trivial function is <code>OnScriptError</code>. The engine calls our <code>OnScriptError</code>
 function if there is a syntax error in the script (i.e., the script 
itself is written/formatted incorrectly), or there's a runtime error in 
the script (for example, the engine runs out of memory while executing 
the script).</p>
<p>The engine passes one of its own COM objects called an <code>IActiveScriptError</code>.
 This object has functions we can call to get information about the 
error, such as the line number in the script where the error occurred, 
and a text message that describes the error. (Note: The line number is 
referenced from 0, so the first line in the script is line number 0.)</p>
<p>All we do is call some <code>IActiveScriptError</code> functions to get some information, reformat it, and display it to the user in a message box.</p><div class="pre-lang" id="premain649555"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="649555" id="preShrink649555">Shrink ▲</span> &nbsp; <span id="copycode649555" class="copy-code" data-index="649555" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre649555" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">STDMETHODIMP OnScriptError(MyRealIActiveScriptSite *this, 
             IActiveScriptError *scriptError)
{
   ULONG        lineNumber;
   BSTR         desc;
   EXCEPINFO    ei;
   OLECHAR      wszOutput[1024];

   <span class="code-comment">//</span><span class="code-comment"> Call GetSourcePosition() to retrieve the line # where</span>
   <span class="code-comment">//</span><span class="code-comment"> the error occurred in the script</span>
   scriptError-&gt;lpVtbl-&gt;GetSourcePosition(scriptError, <span class="code-digit">0</span>, &amp;lineNumber, <span class="code-digit">0</span>);

   <span class="code-comment">//</span><span class="code-comment"> Call GetSourceLineText() to retrieve the line in the script that</span>
   <span class="code-comment">//</span><span class="code-comment"> has an error.</span>
   desc = <span class="code-digit">0</span>;
   scriptError-&gt;lpVtbl-&gt;GetSourceLineText(scriptError, &amp;desc);

   <span class="code-comment">//</span><span class="code-comment"> Call GetExceptionInfo() to fill in our EXCEPINFO struct with more</span>
   <span class="code-comment">//</span><span class="code-comment"> information.</span>
   ZeroMemory(&amp;ei, <span class="code-keyword">sizeof</span>(EXCEPINFO));
   scriptError-&gt;lpVtbl-&gt;GetExceptionInfo(scriptError, &amp;ei);

   <span class="code-comment">//</span><span class="code-comment"> Format the message we'll display to the user</span>
   wsprintfW(&amp;wszOutput[0], L<span class="code-string">"</span><span class="code-string">%s\nLine %u: %s\n%s"</span>, ei.bstrSource,
      lineNumber + <span class="code-digit">1</span>, ei.bstrDescription, desc ? desc : <span class="code-string">"</span><span class="code-string">"</span>);

   <span class="code-comment">//</span><span class="code-comment"> Free what we got from the IActiveScriptError functions</span>
   SysFreeString(desc);
   SysFreeString(ei.bstrSource);
   SysFreeString(ei.bstrDescription);
   SysFreeString(ei.bstrHelpFile);

   <span class="code-comment">//</span><span class="code-comment"> Display the message</span>
   MessageBoxW(<span class="code-digit">0</span>, &amp;wszOutput[0], <span class="code-string">"</span><span class="code-string">Error"</span>, 
               MB_SETFOREGROUND|MB_OK|MB_ICONEXCLAMATION);
 
   <span class="code-keyword">return</span>(S_OK);
}</pre>
<p>Note that the <code>IActiveScriptError</code> object is good only for the lifetime of our <code>OnScriptError</code> function. In other words, when our <code>OnScriptError</code> returns, that particular <code>IActiveScriptError</code> object disappears (unless we explicitly <code>AddRef</code> it). Also note that the <code>IActiveScriptError</code>'s functions return copies of any information we request, so we have to eventually free any <code>BSTR</code>s it returns to us.</p>
<p>
</p><blockquote><b>In conclusion</b>, a Script Host must provide a standard COM object called an <code>IActiveScriptSite</code>. It may also optionally provide an <code>IActiveScriptSiteWindow</code>, which is a sub-object of the <code>IActiveScriptSite</code>. In a minimal implementation, the functions can simply be stub functions that do nothing. But, the <code>OnScriptError</code> function is typically used to inform the user of any error that occurs in the script.</blockquote>
<p></p>
<h2><a name="SCRIPT">An</a> example VBScript</h2>
<p>Let's run the following VBScript, which simply displays a message box with the text "Hello world":</p><div class="pre-lang" id="premain553148"><div>VBScript</div><div class="pre-action-link"><span id="copycode553148" class="copy-code" data-index="553148" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre553148" style="margin-top:0;" class="lang-vbscript notranslate" data-language="vbscript" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">MsgBox <span class="code-string">"</span><span class="code-string">Hello world"</span></pre>
<p>To make it easy, we'll simply embed this script as a string right inside of our executable, as global data declared like so:</p><div class="pre-lang" id="premain559906"><div></div><div class="pre-action-link"><span id="copycode559906" class="copy-code" data-index="559906" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre559906" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">wchar_t VBscript[] = L<span class="code-string">"</span><span class="code-string">MsgBox \"Hello world\""</span>;</pre>
<p>There is one important thing to note. I've declared this string a 
wide (UNICODE) data type, and initialized it as so (i.e., the datatype <code>wchar_t</code> indicates wide characters, and the <b>L</b>
 qualifier on the string also indicates as much). All script engine 
functions expect wide character strings. So, when we give the VBScript 
engine our script to run, it must be in UNICODE format, even if our 
executable itself isn't internally using UNICODE.</p>
<h2><a name="INIT">Initializing</a> the engine</h2>
<p>Before we can run our script, we first have to open the engine and get its <code>IActiveScript</code> object (via <code>CoCreateInstance</code>) and its <code>IActiveScriptParse</code> sub-object, as shown earlier.</p>
<p>When an engine is first open, it is in the <i>unitialized state</i>. 
Before we can give the engine any scripts to run, we must initialize the
 engine (once only). This merely involves a call to the engine <code>IActiveScriptParse</code>'s <code>Init</code> function.</p>
<p>Furthermore, we need to give the engine a pointer to our <code>IActiveScriptSite</code> object. Again, we need to do this once only. This merely involves a call to the engine <code>IActiveScript</code>'s <code>SetScriptSite</code> function, passing a pointer to our <code>IActiveScriptSite</code> (which is embedded at the start of our <code>MyRealIActiveScriptSite</code>, so a simple cast does the trick).</p>
<p>Here then, are the two calls we need to do once only after the engine is opened:</p><div class="pre-lang" id="premain717299"><div></div><div class="pre-action-link"><span id="copycode717299" class="copy-code" data-index="717299" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre717299" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> Let the engine do any initialization it needs to do.</span>
activeScriptParse-&gt;lpVtbl-&gt;InitNew(activeScriptParse);

<span class="code-comment">//</span><span class="code-comment"> Give the engine our IActiveScriptSite object.</span>
activeScript-&gt;lpVtbl-&gt;SetScriptSite(activeScript,
     (IActiveScriptSite *)&amp;MyActiveScriptSite);</pre>
<p>After the above two calls, the engine will automatically switch to the <i>initialized state</i>. It is now ready for us to add scripts to the engine.</p>
<p><b>Note:</b> The engine's <code>SetScriptSite</code> function may call our <code>IActiveScriptSite</code>'s <code>QueryInterface</code> to ask us to return several sub-objects. For example, perhaps, we'll be asked to return a pointer to our <code>IActiveScriptSiteWindow</code> sub-object. When we call <code>SetScriptSite</code>,
 we should be prepared to provide any requested sub-objects. If we need 
to do any pre-initialization of our own COM objects, we should do that <b>before</b> calling <code>SetScriptSite</code>.</p>
<p>
</p><blockquote><b>In conclusion</b>, before running any scripts, the host must call an engine's <code>Init</code> and <code>SetScriptSite</code> functions, to initialize the engine, and to give a pointer to the host's <code>IActiveScriptSite</code> object, respectively. This should be done once only, after the engine is opened.</blockquote>
<p></p>
<h2><a name="ADD">Adding</a> a script to the engine</h2>
<p>In order to run a script, we first need to give that script to the 
engine. We do this by passing a memory buffer, containing the script, to
 the engine <code>IActiveScriptParse</code>'s <code>ParseScriptText</code>
 function. Remember that the script must be in wide-character format. It
 must also be null-terminated. Since our VBScript is already in a memory
 buffer (i.e., it's a global variable inside of our executable, declared
 as <code>wchar_t</code> and null-terminated), all we need to do is pass the address of that global, as so:</p><div class="pre-lang" id="premain675211"><div></div><div class="pre-action-link"><span id="copycode675211" class="copy-code" data-index="675211" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre675211" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">activeScriptParse-&gt;lpVtbl-&gt;ParseScriptText(activeScriptParse, 
                   &amp;VBscript[0], <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);</pre>
<p><code>ParseScriptText</code> takes a lot of other arguments, but for our purposes here, we can leave them all set to 0.</p>
<p>So, what happens when we call <code>ParseScriptText</code>? First of 
all, the engine checks the syntax of the script to ensure that it is a 
correctly written script. Here, the VB engine makes sure that our script
 contains legal VB instructions. If there's a syntax error, the engine's
 <code>ParseScriptText</code> will call our <code>IActiveScriptSite</code>'s <code>OnHandleError</code>. The engine will not internally add the script, and (after our <code>OnHandleError</code> function returns) <code>ParseScriptText</code> will return an error (non-zero) value.</p>
<p>If the script is syntactically correct, then the engine makes its own
 copy of our script, perhaps reformatting it into some internal 
structures of its own choosing, in preparation of running the script. 
But the engine does not run the script at this point, because the engine
 is still in its initialized state. An engine will not run any script we
 add to the engine until we put the engine into either its <i>start</i> or <i>connected</i> states.</p>
<p>If all goes well, <code>ParseScriptText</code> returns 0 for success.
 The engine now has its own internally formatted version of our script, 
prepared for running. (At this point, if we had allocated the buffer 
containing the script, we could free it now if desired.)</p>
<p>
</p><blockquote><b>In conclusion</b>, in order for a script to be run, 
the host must first pass a memory buffer containing the script 
(formatted in wide characters, and null-terminated) to the engine's <code>ParseScriptText</code>
 function. This causes the engine to make its own copy of the script in 
preparation of running the script. But the script does not run while the
 engine is still in its initialized state.</blockquote>
<p></p>
<h2><a name="RUN">Running</a> scripts</h2>
<p>To run our VBScript, we simply need to switch the engine to either its <i>start</i> or <i>connected</i>
 state. We'll later discuss the differences between the two states, but 
for now, we'll simply switch to the connected state. We change the 
engine's state by calling its <code>IActiveScript</code>'s <code>SetScriptState</code>, passing the desired state, which here is the constant <code>SCRIPTSTATE_CONNECTED</code> (defined in MS' <i>activscp.h</i> include file).</p><div class="pre-lang" id="premain426212"><div></div><div class="pre-action-link"><span id="copycode426212" class="copy-code" data-index="426212" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre426212" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">activeScript-&gt;lpVtbl-&gt;SetScriptState(activeScript, SCRIPTSTATE_CONNECTED);</pre>
<p>As soon as we make this call, the engine starts executing any <i>immediate instructions</i>
 in the script. What is an immediate instruction? That depends upon the 
language. In VBScript, immediate instructions are any instructions at 
the start of the script which are not enclosed in some 
subroutine/function. Since our example script contains one instruction 
which happens to fit that description, that instruction is immediately 
executed. We should see a message box pop up with the string "Hello 
World".</p>
<p><code>SetScriptState</code> will not return until all of those 
immediate instructions are done. In this case, it won't return until we 
dismiss that message box. And since that's the last immediate 
instruction in our VBScript, <code>SetScriptState</code> returns. At this point, we don't have any further use for the script nor the engine, so we can close down the engine.</p>
<h2><a name="CLOSE">Closing</a> an engine</h2>
<p>To close an engine, we simply call its <code>IActiveScript</code>'s <code>Close</code> function, as so:</p><div class="pre-lang" id="premain456019"><div></div><div class="pre-action-link"><span id="copycode456019" class="copy-code" data-index="456019" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre456019" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">activeScript-&gt;lpVtbl-&gt;Close(activeScript);</pre>
<p>This should cause the engine to stop any running scripts, free any 
internal resources that are no longer needed, and switch to the <i>closed</i> state. It should call our <code>IActiveScriptSite</code>'s <code>Release</code> function, and free anything that it obtained from us (such as freeing the copy it made of our script).</p>
<p>After <code>Close</code> returns, we can then call the engine <code>IActiveScriptParse</code>'s and <code>IActiveScript</code>'s <code>Release</code> functions, like so:</p><div class="pre-lang" id="premain655196"><div></div><div class="pre-action-link"><span id="copycode655196" class="copy-code" data-index="655196" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre655196" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">activeScript-&gt;lpVtbl-&gt;Release(activeScript);
activeScript-&gt;lpVtbl-&gt;Release(activeScript);</pre>
<p>We're now done with the engine.</p>
<h2><a name="LOAD">Loading</a> a script</h2>
<p>Of course, our script language wouldn't be much use to an end user if
 he couldn't write his own scripts to run. So, instead of hard-coding a 
VBScript inside of our executable, let's present a file dialog to the 
end user so he can pick out a VBScript on disk. Then, we'll load the 
script into a memory buffer, making sure that the script is in wide 
character format and null-terminated, and pass that memory buffer to <code>ParseScriptText</code>.</p>
<p>I won't bother discussing how to present a file dialog to the end user to get his choice of filename.</p>
<p>After the user chooses the filename, we'll pass it to a function called <code>loadUnicodeScript</code>, which returns a memory buffer containing the script, formatted in wide characters and null-terminated.</p><div class="pre-lang" id="premain522641"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="522641" id="preShrink522641">Shrink ▲</span> &nbsp; <span id="copycode522641" class="copy-code" data-index="522641" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre522641" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">OLECHAR * loadUnicodeScript(LPCTSTR fn)
{
   OLECHAR  *script;
   HANDLE   hfile;

   <span class="code-comment">//</span><span class="code-comment"> Assume an error</span>
   script = <span class="code-digit">0</span>;

   <span class="code-comment">//</span><span class="code-comment"> Open the file</span>
   <span class="code-keyword">if</span> ((hfile = CreateFile(fn, GENERIC_READ, FILE_SHARE_READ, <span class="code-digit">0</span>, 
        OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, <span class="code-digit">0</span>)) != INVALID_HANDLE_VALUE)
   {
      DWORD  filesize;
      <span class="code-keyword">char</span>   *psz;

      <span class="code-comment">//</span><span class="code-comment"> Get a buffer to read in the file, with room to nul-terminate</span>
      filesize = GetFileSize(hfile, <span class="code-digit">0</span>);
      <span class="code-keyword">if</span> ((psz = (<span class="code-keyword">char</span> *)GlobalAlloc(GMEM_FIXED, filesize + <span class="code-digit">1</span>)))
      {
         DWORD  read;

         <span class="code-comment">//</span><span class="code-comment"> Read in the file</span>
         ReadFile(hfile, psz, filesize, &amp;read, <span class="code-digit">0</span>);

         <span class="code-comment">//</span><span class="code-comment"> Get a buffer to convert to UNICODE, plus an extra wchar_t</span>
         <span class="code-comment">//</span><span class="code-comment"> to nul-terminate it</span>
         <span class="code-keyword">if</span> ((script = (OLECHAR *)GlobalAlloc(GMEM_FIXED, (filesize + <span class="code-digit">1</span>)
             * <span class="code-keyword">sizeof</span>(OLECHAR))))
         {
            <span class="code-comment">//</span><span class="code-comment"> Convert to UNICODE and nul-terminate</span>
            MultiByteToWideChar(CP_ACP, <span class="code-digit">0</span>, psz, filesize, script, filesize + <span class="code-digit">1</span>);
            script[filesize] = <span class="code-digit">0</span>;
         }
         <span class="code-keyword">else</span>
            display_sys_error(<span class="code-digit">0</span>);

         GlobalFree(psz);
      }
      <span class="code-keyword">else</span>
          display_sys_error(<span class="code-digit">0</span>);

      CloseHandle(hfile);
   }
   <span class="code-keyword">else</span>
      display_sys_error(<span class="code-digit">0</span>);

   <span class="code-keyword">return</span>(script);
}

<span class="code-keyword">void</span> display_sys_error(DWORD err)
{
   TCHAR   buffer[160];

   <span class="code-keyword">if</span> (!err) err = GetLastError();
   buffer[0] = <span class="code-digit">0</span>;
   FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, <span class="code-digit">0</span>, err,
      MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), &amp;buffer[0], <span class="code-digit">160</span>, <span class="code-digit">0</span>);
   MessageBox(<span class="code-digit">0</span>, &amp;buffer[0], <span class="code-string">"</span><span class="code-string">Error"</span>, MB_OK);
}</pre>
<p><b>Note:</b> <code>loadUnicodeScript</code> assumes that the file on 
disk is not Unicode. If there's a chance that you may be loading a disk 
file that is already in Unicode format, then you shouldn't convert it 
again. In this case, <code>loadUnicodeScript</code> will need to be 
modified to check any "signature" in the file. Consult other 
documentation for more information about different text file encoding.</p>
<p>We can make minor changes to our code to run the script. We simply call <code>loadUnicodeScript</code> to load the disk script into a memory buffer, and pass this buffer to <code>ParseScriptText</code>. Afterwards, we can free the buffer, and change the engine's state to <i>connected</i>, to run the script:</p><div class="pre-lang" id="premain636065"><div></div><div class="pre-action-link"><span id="copycode636065" class="copy-code" data-index="636065" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre636065" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">LPOLESTR   str;

<span class="code-comment">//</span><span class="code-comment"> Load the script from disk.</span>
str = loadUnicodeScript(fn);

<span class="code-comment">//</span><span class="code-comment"> Have the script engine parse it and internally prepare it to be run.</span>
hr = activeScriptParse-&gt;lpVtbl-&gt;ParseScriptText(activeScriptParse, str,
    <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);

<span class="code-comment">//</span><span class="code-comment"> We no longer need the loaded script.</span>
GlobalFree(str);

<span class="code-comment">//</span><span class="code-comment"> Execute the script's immediate instructions.</span>
activeScript-&gt;lpVtbl-&gt;SetScriptState(activeScript, SCRIPTSTATE_CONNECTED);</pre>
<h2><a name="ENUM">Enumerating</a> installed engines</h2>
<p>When the user picks out a script to run, we don't want to assume that
 it will be a VBScript. Perhaps it will be a Jscript, or a script 
associated with a Python engine, etc.</p>
<p>What we'll do is take the filename he picked, isolate the file extension on the name, and pass that extension to <code>getEngineGuid</code>. That will give us the GUID for the appropriate engine we need to open.</p>
<p>But what happens if the filename has no extension, or it has an 
extension that isn't associated with any installed script engine? In 
this case, we'll need to present the end user with a list of installed 
ActiveX Script Engines, and let him manually choose the engine he wants.
 Then, we'll get the GUID of that chosen engine, and open it.</p>
<p>Microsoft's OLE functions provide COM objects we can obtain and use 
to get a list of installed engines and their GUIDs. The COM object we 
need to obtain is known as an <code>ICatInformation</code>, and in particular, we want the <code>ICatInformation</code> object that lists script engines. We can obtain one of these objects by calling <code>CoCreateInstance</code>. We can then call its <code>EnumClassesOfCategories</code> to get a sub-object whose <code>Next</code> function enumerates the script engine GUIDs. We further can call <code>ProgIDFromCLSID</code> to get each engine's name (as registered by the engine's installer).</p>
<p>In the directory <i>ScriptHost2</i> is an example of a windowed (GUI)
 C application that presents a window with a "Run script" menu item. 
When the user selects this menu item, a file dialog is presented to get 
the name of the script to run. After picking the script name, the 
application isolates the extension, and tries to lookup the engine GUID 
associated with this extension. If no such engine is found, then the 
application presents a dialog box listing the installed engines so the 
user can pick the desired engine to use.</p>
<p>The source file <i>ChooseEngine.c</i> contains the code for presenting the list of installed engines and getting the GUID of the chosen engine.</p>
<h2><a name="THREAD">Running</a> a script in another thread</h2>
<p>There is one problem with our GUI app. The script runs in the same 
thread as our user interface. The disadvantage of this is that, if the 
script were to do some never-ending loop, we'd be stuck in that call to <code>SetScriptState</code>
 forever, with no way for the user to abort the script. Indeed, the user
 interface is totally tied up while the script is running, so the user 
can't even move our application window.</p>
<p>For this reason, it is best to launch a separate thread to run a 
script. But there's one big caveat. Most of the engine's COM functions 
can be called only by the thread that calls <code>SetScriptSite</code>. 
So, we need to let our "script thread" do most of the 
setup/initialization and cleanup involved in running a script. Another 
caveat is that our <code>IActiveScriptSite</code> functions will be called within our script thread, so if we have any data that is accessed by both our <code>IActiveScriptSite</code>
 functions and UI thread functions, we'll need some sort of 
synchronization, such as a critical section around any access to that 
data.</p>
<p>In the directory <i>ScriptHost3</i> is a modified version of <b>ScriptHost2</b> which runs the script in a secondary thread. Essentially, what we've done is turn our function <code>runScript</code> into the entry point of a second thread. Not too much alteration is necessary because <code>runScript</code>
 already does all the initialization and cleanup that would need to be 
done by the script thread. Most of the alteration concerns thread 
initialization and cleanup. First of all, the Windows operating system 
specifies that a thread can be passed only a single parameter (of our 
own choosing). But our <code>runScript</code> takes two arguments -- a 
filename, and a GUID. We need to define a new, single struct that wraps 
both of these. We'll call it a <code>MYARGS</code> struct, and define it as so:</p><div class="pre-lang" id="premain571684"><div></div><div class="pre-action-link"><span id="copycode571684" class="copy-code" data-index="571684" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre571684" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">typedef <span class="code-keyword">struct</span> {
   IActiveScript  *EngineActiveScript;
   HANDLE         ThreadHandle;
   TCHAR          Filename[MAX_PATH];
   GUID           Guid;
} MYARGS;</pre>
<p>Then, we'll pass <code>runScript</code> a pointer to our <code>MYARGS</code>.</p>
<p><code>MYARGS</code> has two extra members. <code>ThreadHandle</code> stores a handle to the script thread. We'll also let the script thread store the engine's <code>IActiveScript</code> object pointer in our <code>MYARGS</code>. This is so that the main thread can also gain access to it later.</p>
<p>Since we're going to launch only one script at a time, we'll declare a global <code>MYARGS</code>:</p><div class="pre-lang" id="premain781519"><div></div><div class="pre-action-link"><span id="copycode781519" class="copy-code" data-index="781519" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre781519" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">MYARGS MyArgs;</pre>
<p>Our main thread initializes its <code>ThreadHandle</code> member to 0 at the start of our app. We use this member to determine whether the script thread is running. When <code>ThreadHandle</code> is 0, the script thread isn't running. When not 0, it is the handle to the running script thread.</p>
<p><code>runScript</code> needs to call <code>CoInitialize</code> once the thread starts. Each thread is responsible for initializing COM for itself. And of course, <code>runScript</code> must call <code>CoUninitialize</code> when done. Furthermore, we're going to change our main thread's call from <code>CoInitialize</code> to <code>CoInitializeEx</code> and pass the value <code>COINIT_MULTITHREADED</code>. This ensures that, if our main thread calls any <code>IActiveScript</code>
 function, then the engine won't block our main thread and force the 
function to be executed in our script thread. This is very important 
when we want our main thread to abort our script thread via <code>InterruptScriptThread</code>. We don't want to trust the script thread to abort itself, which it wouldn't be able to do if it was "hung".</p>
<p><b>Note:</b> In order for the compiler to recognize <code>CoInitializeEx</code>, you must <code>#define</code> the symbol <code>_WIN32_WINNT</code> to be 0x0400 (or greater), and this must be done before you <code>#include objbase.h</code>.</p>
<p>When our main (UI) thread handles the <code>IDM_FILE_RUNSCRIPT</code> message, it fills in <code>MYARG</code>'s
 filename and GUID fields with the name of the script to run and the 
GUID of the engine to use. Then, our main thread creates/launches the 
script thread with a call to <code>CreateThread</code>, passing our <code>MYARGS</code>, as so:</p><div class="pre-lang" id="premain494018"><div></div><div class="pre-action-link"><span id="copycode494018" class="copy-code" data-index="494018" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre494018" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">MyArgs.ThreadHandle = CreateThread(<span class="code-digit">0</span>, <span class="code-digit">0</span>, runScript, &amp;MyArgs, <span class="code-digit">0</span>, &amp;wParam);</pre>
<p><b>Note:</b> If your script thread, or your <code>IActiveScriptSite</code> functions, call any C language functions, then use <code>beginthread</code>
 instead. And check your C/C++ "Code Generation" settings to be sure you
 use a multi-threaded C library. In my example code, I do not call any C
 library functions that are sensitive to multi-threading, so I can use <code>CreateThread</code>.</p>
<p>Note that we save the handle of the thread in <code>MYARGS</code>'s <code>ThreadHandle</code>. If the script thread launched OK, this is now non-zero. When our script thread terminates, it will reset <code>ThreadHandle</code> to 0.</p>
<p>There are two more matters to discuss related to what to do if the 
script thread has a problem running the script, and also what to do if 
our main thread needs to abort the script thread.</p>
<p>To make it easier for our main thread to cleanly abort any script, our script thread (and our <code>IActiveScriptSite</code>
 functions) should avoid doing anything that would cause the thread to 
"pause" or "wait for something". One example would be calling <code>MessageBox</code>. <code>MessageBox</code> causes a thread to wait until the user dismisses the message box. Another potential problem could be calling <code>SendMessage</code>.
 This waits for a window procedure to fully process the message and 
return. And if the window procedure thread does something that causes it
 to pause or wait, then the thread calling <code>SendMessage</code> also is doomed to pause and wait too.</p>
<p>In <code>runScript</code>, we called our function <code>display_COM_error</code>, which in turn calls <code>MessageBox</code>.
 This is not good. What we'll do is simply pass off any error message to
 our UI thread, and let our main thread display any error message box. 
To do this, we'll use <code>PostMessage</code>. For the message number, we'll use <code>WM_APP</code> (i.e., our own custom message number). For the <code>WPARAM</code> argument, we'll pass the address of the error string. If we pass a 0 for the <code>WPARAM</code> argument, then this means the <code>LPARAM</code> argument is an error number that we should pass to <code>display_sys_error</code> to get an error message to display. For the <code>LPARAM</code> argument, we'll pass an <code>HRESULT</code> error number. If we pass a 0 for the <code>HRESULT</code>, this means that the error string is a wide character string that has been <code>GlobalAlloc()</code>'ed. Our main thread will need to use <code>MessageBoxW</code> to display it, and then must subsequently <code>GlobalFree</code> it.</p>
<p>So for example, in <code>runScript</code>, we change the following error handling from...</p><div class="pre-lang" id="premain247137"><div></div><div class="pre-action-link"><span id="copycode247137" class="copy-code" data-index="247137" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre247137" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">if</span> ((hr = activeScriptParse-&gt;lpVtbl-&gt;InitNew(activeScriptParse)))
   display_COM_error(<span class="code-string">"</span><span class="code-string">Can't initialize engine : %08X"</span>, hr);</pre>
<p>...to...</p><div class="pre-lang" id="premain876353"><div></div><div class="pre-action-link"><span id="copycode876353" class="copy-code" data-index="876353" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre876353" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">if</span> ((hr = activeScriptParse-&gt;lpVtbl-&gt;InitNew(activeScriptParse)))
   PostMessage(MainWindow, WM_APP, (WPARAM)<span class="code-string">"</span><span class="code-string">Can't initialize engine : %08X"</span>, hr);</pre>
<p>We need to modify <code>loadUnicodeScript</code> slightly so that it doesn't call <code>display_sys_error</code>, but instead calls <code>PostMessage</code> to pass off the error message display to the main thread.</p>
<p>There's one more place where our script thread could potentially call <code>MessageBox</code>, and that's in our <code>IActiveScriptSite</code>'s <code>OnScriptError</code>. Let's rewrite it so that it <code>GlobalAlloc()</code>s the error message and then <code>PostMessage()</code>s it to the main thread to display. You can peruse the updated code in <i>IActiveScriptSite.c</i>.</p>
<p>And we need to add code to our main window procedure to handle <code>WM_APP</code>, as so:</p><div class="pre-lang" id="premain742357"><div></div><div class="pre-action-link"><span id="copycode742357" class="copy-code" data-index="742357" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre742357" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">case</span> WM_APP:
{
   <span class="code-comment">//</span><span class="code-comment"> Our script thread posts a WM_APP if it needs</span>
   <span class="code-comment">//</span><span class="code-comment"> us to display an error message.</span>
   <span class="code-comment">//</span><span class="code-comment"> wParam = A pointer to the string</span>
   <span class="code-comment">//</span><span class="code-comment"> to display. If 0, then lParam is an error</span>
   <span class="code-comment">//</span><span class="code-comment"> number to be passed to display_sys_error().</span>
   <span class="code-comment">//</span><span class="code-comment"> lParam = The HRESULT. If 0, then wParam</span>
   <span class="code-comment">//</span><span class="code-comment">          is an allocated WCHAR string which we must</span>
   <span class="code-comment">//</span><span class="code-comment"> free with GlobalFree().</span>
   <span class="code-keyword">if</span> (!wParam)
      display_sys_error((DWORD)lParam);
   <span class="code-keyword">else</span> <span class="code-keyword">if</span> (!lParam)
   {
      MessageBoxW(hwnd, (<span class="code-keyword">const</span> WCHAR *)wParam, 
                  <span class="code-string">"</span><span class="code-string">Error"</span>, MB_OK|MB_ICONEXCLAMATION);
      GlobalFree((<span class="code-keyword">void</span> *)wParam);
   }
   <span class="code-keyword">else</span>
      display_COM_error((LPCTSTR)wParam, (HRESULT)lParam);
   <span class="code-keyword">return</span>(<span class="code-digit">0</span>);
}</pre>
<p><b>Note:</b> You may wish to use <code>RegisterWindowMessage</code> to get your own custom message number, rather than using <code>WM_APP</code>. But for our purposes, <code>WM_APP</code> suffices.</p>
<p>There's just one thing left -- how to abort the script from the main thread. Let's do this in our <code>WM_CLOSE</code> processing, so if the user tries to close our window while a script is running, we'll force the script to abort. The engine <code>IActiveScript</code>'s <code>InterruptScriptThread</code> function is one of the few functions that can be called by any thread. We pass the value <code>SCRIPTTHREADID_ALL</code>,
 which simply means to abort all running scripts we've given to the 
engine (i.e., if we had created numerous threads, each simultaneously 
running its own VBScript, this would cause the VB engine to abort all of
 those script threads). Alternately, if we wanted to abort only a 
particular script thread, we could pass that thread's ID.</p><div class="pre-lang" id="premain623215"><div></div><div class="pre-action-link"><span id="copycode623215" class="copy-code" data-index="623215" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre623215" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-keyword">case</span> WM_CLOSE:
{
   <span class="code-comment">//</span><span class="code-comment"> Is a script running?</span>
   <span class="code-keyword">if</span> (MyArgs.ThreadHandle)
   {
      <span class="code-comment">//</span><span class="code-comment"> Abort the script by calling InterruptScriptThread.</span>
      MyArgs.EngineActiveScript-&gt;lpVtbl-&gt;InterruptScriptThread(
          MyArgs.EngineActiveScript, SCRIPTTHREADID_ALL, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
   ...</pre>
<p>When <code>InterruptScriptThread</code> returns, that doesn't mean 
that the thread has terminated. It simply means that the engine has 
marked the running script for termination. We still have to "wait" for 
the thread to terminate. We'll do that by testing when <code>ThreadHandle</code>
 is 0. (Remember that the script thread zeroes it upon termination.) But
 there's one other problem. If the script thread is somehow "sleeping" 
or waiting for something itself, for example, in a call to <code>MessageBox</code>,
 then the engine will never get a chance to terminate it. We've been 
careful to avoid calling such functions ourselves, but note that 
VBScript has a <code>msgbox</code> function it too can call.</p>
<p>To get around this problem, we'll increment a count, and <code>Sleep()</code>
 in between increments. When the count "times out", we'll assume the 
script is locked up, and brute-force terminate it ourselves by calling <code>TerminateThread</code>.</p><div class="pre-lang" id="premain871949"><div></div><div class="pre-action-link"><span id="copycode871949" class="copy-code" data-index="871949" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre871949" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">wParam = <span class="code-digit">0</span>;
<span class="code-keyword">while</span> (MyArgs.ThreadHandle &amp;&amp; ++wParam &lt; <span class="code-digit">25</span>) Sleep(<span class="code-digit">100</span>);
<span class="code-keyword">if</span> (MyArgs.ThreadHandle) TerminateThread(MyArgs.ThreadHandle, <span class="code-digit">0</span>);</pre>
<p>
</p><blockquote><b>In conclusion</b>, a script should be run in a separate thread than the main UI. The script thread must <code>CoInitialize</code> itself. Most of the engine's COM functions can be called only from the script thread. Our <code>IActiveScriptSite</code>'s
 functions are also called within the script thread. The script thread 
should avoid doing anything that makes it "wait" or "pause". The UI 
thread may force the script to abort via <code>InterruptScriptThread</code>, but may also need to do a "time out" to brute-force terminate the script thread, if necessary.</blockquote>
<p></p>
<h2>Conclusion</h2>
<p>This chapter demonstrates how to use an ActiveX Script Engine to run a
 script. But while it's useful to be able to simply run a script, we 
haven't yet seen how that script can directly interact with the 
functions in our app, and exchange data. For this, we'll need to add 
another COM object to our app. This will be the focus of the next 
chapter.</p>


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

						
						<br>
						
						    

<div class="author-wrapper">

    <div class="desktop-only tablet-only" style="position:absolute; top:-30px;right:20px">
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div style="padding-right:100px">
        <div class="subdue" style="margin-bottom:7px">Written By</div>

        <div class="container-member">
             <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>
        </div>

        <div class="company text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	        <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
        </div>

        <div class="text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/US.gif" alt="United States" width="16" height="11">&nbsp;United States</span>
        </div>
    </div>

</div>

<div class="description" style="padding-top:1rem">
    This member has not yet provided a Biography. Assume it's 
interesting and varied, and probably something to do with programming.
</div>

<div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_SocialRow" class="follow flex-container flex-extend" style="margin-top:20px">
    <div class="flex-item">
        
    </div>
    <div class="flex-item-tight" style="margin-right:25px">
        
    </div>
</div>

<br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesCplusplus" data-country="US" data-loadonview="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesCplusplus&sz=728x90&c=884252"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesCplusplus&sz=728x90&c=884252"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2 class="padded-top">Comments and Discussions</h2>

                    
			        <div id="ctl00_SharePH" class="share-list float-right desktop-only tablet-only" style="margin-top:-3.5rem">
				        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20Part%206%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aHow%20to%20write%20an%20ActiveX%20Script%20Host%20in%20C.%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+Part+6+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;title=COM+in+plain+C%2c+Part+6+-+CodeProject&amp;summary=How+to+write+an+ActiveX+Script+Host+in+C.&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;title=COM+in+plain+C%2c+Part+6+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f14905%2fCOM-in-plain-C-Part-6&amp;description=COM+in+plain+C%2c+Part+6+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



			        </div><a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6%3ffid%3d325716%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="325716"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="q" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="325716"><input type="hidden" name="currentQS" value="fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f14905%2fCOM-in-plain-C-Part-6"><input type="hidden" name="floc" value="/Articles/14905/COM-in-plain-C-Part-6">Spacing<select size="1" class="dropdown" name="spc" data-ddg-inputtype="unknown">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view" data-ddg-inputtype="unknown">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp" data-ddg-inputtype="unknown">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background msg-list">
<tbody><tr id="F4304180_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4304180xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="4304180" parent="0" thread="4304180" href="https://www.codeproject.com/Messages/4304180/Using-same-concept-with-VBScript">Using same concept with VBScript</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Techiz</span><span class="date">9-Jul-12  3:41</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=7460616">Techiz</a></span></td><td class="date"><span>9-Jul-12  3:41&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4304180_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Jeff, It is a great artical and I have learned a lot reading this.<br>
I have a question, I want to add a script in the VBScript.dll sites. now the that will return me a IDispatch.<br>
<br>
I want to know that if it is possible to load different scripts in the 
different sites and then cross refer them from the objects that 
implement IActiveScript interface.<br>
<br>
So what my idea basically is that to load different scripts using different objects and then use them globally.<br>
<br>
Then problem with this is that the COM object that sets the scripts can only read them.<br>
<br>
Kindly help me. and guide me. Thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4304180" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4304180" name="react-item_4304180" id="MRF4304180" class="reaction-result"></span><span data-objectref="3_4304180" data-votingtype="GoodOrBad" name="RateItem_4304180" id="MVF4304180" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4304180" href="https://www.codeproject.com/Messages/4304180/Using-same-concept-with-VBScript" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3604516_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx3604516xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="3604516" parent="0" thread="3604516" href="https://www.codeproject.com/Messages/3604516/About-registering-with-regsvr32">About registering with regsvr32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">choidebu</span><span class="date">20-Sep-10  14:18</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3826185">choidebu</a></span></td><td class="date"><span>20-Sep-10  14:18&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3604516_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">First of all thanks to Jeff for your great article. I've seen COM and dlls in a new light now.<br>
I tried compiling your examples against Windows SDK 7.1, Visual C++ 2008
 Compiler but not from the IDE, I use mingw32-make cause that is what i 
understand the most.<br>
<br>
It builds successfully but the dll can't be registered with regsvr32, it
 always says DllRegisterServer entry point not found. Does this means to
 build a COM dll register-able by regsvr32, I have to implement this 
method? If that's the case, can you please point me on how to do this?<br>
<br>
Once again, thank you.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3604516" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_3604516" name="react-item_3604516" id="MRF3604516" class="reaction-result"></span><span data-objectref="3_3604516" data-votingtype="GoodOrBad" name="RateItem_3604516" id="MVF3604516" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="3604516" href="https://www.codeproject.com/Messages/3604516/About-registering-with-regsvr32" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3612455_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx3612455xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="3612455" parent="3604516" thread="3604516" href="https://www.codeproject.com/Messages/3612455/Re-About-registering-with-regsvr32">Re: About registering with regsvr32</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">choidebu</span><span class="date">27-Sep-10  21:40</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3826185">choidebu</a></span></td><td class="date"><span>27-Sep-10  21:40&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3612455_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3604516);" href="https://www.codeproject.com/Messages/3604516/About-registering-with-regsvr32"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's ok, I implement the method and now it register/unregister itself smoothly.<br>
But if you ever going to update these articles, may I suggest addressing asynchronous COM call,<br>
 interface marshalling with different threads, etc..<br>
<br>
Regards<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3604516" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_3612455" name="react-item_3612455" id="MRF3612455" class="reaction-result"></span><span data-objectref="3_3612455" data-votingtype="GoodOrBad" name="RateItem_3612455" id="MVF3612455" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="3612455" href="https://www.codeproject.com/Messages/3612455/Re-About-registering-with-regsvr32" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2471187_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx2471187xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="2471187" parent="0" thread="2471187" href="https://www.codeproject.com/Messages/2471187/IActiveScriptDebug">IActiveScriptDebug</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Sergey Alexander Gynech</span><span class="date">18-Mar-08  2:26</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=61556">Sergey Alexander Gynech</a></span></td><td class="date"><span>18-Mar-08  2:26&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2471187_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Do you know how to implement a smart host with debugging
 feature also? breakpoint, step-by-step execution and variable 
inspection?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2471187" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2471187" name="react-item_2471187" id="MRF2471187" class="reaction-result"></span><span data-objectref="3_2471187" data-votingtype="GoodOrBad" name="RateItem_2471187" id="MVF2471187" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2471187" href="https://www.codeproject.com/Messages/2471187/IActiveScriptDebug" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2667638_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx2667638xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="2667638" parent="2471187" thread="2471187" href="https://www.codeproject.com/Messages/2667638/Re-IActiveScriptDebug">Re: IActiveScriptDebug</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">6-Aug-08  17:58</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>6-Aug-08  17:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2667638_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2471187);" href="https://www.codeproject.com/Messages/2471187/IActiveScriptDebug"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's
 in another article in this series. Go to the top of the page, and click
 on my name (under this article's title). That will take you to a page 
listing all of my other articles.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2471187" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2667638" name="react-item_2667638" id="MRF2667638" class="reaction-result"></span><span data-objectref="3_2667638" data-votingtype="GoodOrBad" name="RateItem_2667638" id="MVF2667638" class="rating-result"><span>1.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2667638" href="https://www.codeproject.com/Messages/2667638/Re-IActiveScriptDebug" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5084382_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx5084382xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="5084382" parent="2667638" thread="2471187" href="https://www.codeproject.com/Messages/5084382/Re-IActiveScriptDebug">Re: IActiveScriptDebug</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">EduardoFF</span><span class="date">30-Jun-15  10:13</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=10603764">EduardoFF</a></span></td><td class="date"><span>30-Jun-15  10:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F5084382_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2667638);" href="https://www.codeproject.com/Messages/2667638/Re-IActiveScriptDebug"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Is this article still available? I did not find it in your articles list. Please do you have a link to it? Thanks!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2471187" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_5084382" name="react-item_5084382" id="MRF5084382" class="reaction-result"></span><span data-objectref="3_5084382" data-votingtype="GoodOrBad" name="RateItem_5084382" id="MVF5084382" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="5084382" href="https://www.codeproject.com/Messages/5084382/Re-IActiveScriptDebug" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2412674_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx2412674xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="2412674" parent="0" thread="2412674" href="https://www.codeproject.com/Messages/2412674/Jeff-Glatt-and-his-article-COM-in-PlainC">Jeff Glatt and his article COM in PlainC</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">pogod</span><span class="date">1-Feb-08  20:59</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2593107">pogod</a></span></td><td class="date"><span>1-Feb-08  20:59&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2412674_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I am very grateful to Jeff Glatt for his aricle since it
 helped me to understand the essence of COM-technology and interaction 
between a server and a client and that<br>
a client can be at the same time a server.I am now trying to use his methods on programming IPROPERTY interface.<br>
I am from Russia so excuse me for my English.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2412674" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2412674" name="react-item_2412674" id="MRF2412674" class="reaction-result"></span><span data-objectref="3_2412674" data-votingtype="GoodOrBad" name="RateItem_2412674" id="MVF2412674" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2412674" href="https://www.codeproject.com/Messages/2412674/Jeff-Glatt-and-his-article-COM-in-PlainC" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2351078_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx2351078xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="2351078" parent="0" thread="2351078" href="https://www.codeproject.com/Messages/2351078/Compiling-problem">Compiling problem</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">biggun</span><span class="date">8-Dec-07  10:39</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203593">biggun</a></span></td><td class="date"><span>8-Dec-07  10:39&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2351078_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi, <br>
<br>
  When i try to compile the code, i got the following errors :<br>
Linking...<br>
Main.obj : error LNK2005: _IID_IActiveScriptStats already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IBindEventHandler already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptError already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptSiteInterruptPoll already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptSiteWindow already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptSite already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptParseProcedure already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptParseProcedureOld already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScriptParse already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _IID_IActiveScript already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _CATID_ActiveScriptParse already defined in ChooseEngine.obj<br>
Main.obj : error LNK2005: _CATID_ActiveScript already defined in ChooseEngine.obj<br>
Debug/ScriptHost.exe : fatal error LNK1169: one or more multiply defined symbols found<br>
Error executing link.exe.<br>
<br>
What can i do ?<br>
<br>
I use VC++ 6.0 for compiling.<br>
<br>
Stephan<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2351078" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2351078" name="react-item_2351078" id="MRF2351078" class="reaction-result"></span><span data-objectref="3_2351078" data-votingtype="GoodOrBad" name="RateItem_2351078" id="MVF2351078" class="rating-result"><span>2.20/5 (4 votes)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2351078" href="https://www.codeproject.com/Messages/2351078/Compiling-problem" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135770_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4135770xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4135770" parent="2351078" thread="2351078" href="https://www.codeproject.com/Messages/4135770/Re-Compiling-problem">Re: Compiling problem</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">22-Jan-12  21:04</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>22-Jan-12  21:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4135770_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2351078);" href="https://www.codeproject.com/Messages/2351078/Compiling-problem"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>I
 think this error maybe due to the include files of older versions of VC
 not drawing in initguid.h for C programs where first needed. Try adding
 the line to main.c, right after including windows.h ...<br>
<br>
<div class="pre-lang" id="premain448138"><div>XML</div><div class="pre-action-link"><span class="code-collapse" data-index="448138" id="preShrink448138">Shrink ▲</span> &nbsp; <span id="copycode448138" class="copy-code" data-index="448138" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre448138" style="margin-top:0;" class="lang-xml notranslate" data-language="xml" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">#include <span class="code-keyword">&lt;</span><span class="code-leadattribute">initguid.h</span><span class="code-keyword">&gt;</span></pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2351078" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4135770" name="react-item_4135770" id="MRF4135770" class="reaction-result"></span><span data-objectref="3_4135770" data-votingtype="GoodOrBad" name="RateItem_4135770" id="MVF4135770" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4135770" href="https://www.codeproject.com/Messages/4135770/Re-Compiling-problem" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1888928_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx1888928xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="1888928" parent="0" thread="1888928" href="https://www.codeproject.com/Messages/1888928/script-output-to-console">script output to console</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">XBLite</span><span class="date">11-Feb-07  12:28</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1156718">XBLite</a></span></td><td class="date"><span>11-Feb-07  12:28&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1888928_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi, I enjoyed your articles on script hosting<br>
engines. Ok, for vbscript, there is a cscript <br>
command line host to run scripts. This allows <br>
you to use WScript.Echo command to display text<br>
to the command line window.<br>
<br>
How does one display text output (besides in a<br>
message box window) from a script in your C <br>
script hosting program?  Thanks, D.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1888928" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1888928" name="react-item_1888928" id="MRF1888928" class="reaction-result"></span><span data-objectref="3_1888928" data-votingtype="GoodOrBad" name="RateItem_1888928" id="MVF1888928" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1888928" href="https://www.codeproject.com/Messages/1888928/script-output-to-console" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889084_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx1889084xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="1889084" parent="1888928" thread="1888928" href="https://www.codeproject.com/Messages/1889084/Re-script-output-to-console-modified">Re: script output to console [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">11-Feb-07  15:51</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>11-Feb-07  15:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889084_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1888928);" href="https://www.codeproject.com/Messages/1888928/script-output-to-console"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Read
 the next tutorial in this series. It discusses how you can add your own
 "Objects" to VBScript. When VBscript calls a function in one of your 
own objects, the VB engine calls your IActiveScriptSite's GetItemInfo. 
It passes the name of your object that it wants. You return a pointer to
 one of those objects.<br>
<br>
So, what you need to do is make your own version of an object that is 
called "WScript" (as far as the VB engine is concerned), and contains an
 "Echo" function. In your Echo function, you can append the string to 
the end of some multi-line edit control in your own window.<br>
<br>
NOTE: Change the GUID's in all of the examples below to a unique GUID you create with GUIDGEN.EXE!<br>
<br>
You'll have a IWScript.h file that defines your phony WScript object. It
 needs to be based on an IDispatch in order for VBscript to use it. So 
notice the first 7 functions for an IDispatch. Then we add the Echo 
function. It is passed one string (from the VBScript).<br>
<br>
#undef  INTERFACE<br>
#define INTERFACE IWScript<br>
DECLARE_INTERFACE_ (INTERFACE, IDispatch)<br>
{<br>
 STDMETHOD  (QueryInterface)(THIS_ REFIID, void **) PURE;<br>
 STDMETHOD_ (ULONG, AddRef)(THIS) PURE;<br>
 STDMETHOD_ (ULONG, Release)(THIS) PURE;<br>
 STDMETHOD (GetTypeInfoCount)(THIS_ UINT *) PURE;<br>
 STDMETHOD (GetTypeInfo)(THIS_ UINT, LCID, ITypeInfo **) PURE;<br>
 STDMETHOD (GetIDsOfNames)(THIS_ REFIID, LPOLESTR *, UINT, LCID, DISPID *) PURE;<br>
 STDMETHOD (Invoke)(THIS_ DISPID, REFIID, LCID, WORD, DISPPARAMS *, VARIANT *, EXCEPINFO *, UINT *) PURE;<br>
 STDMETHOD  (Echo)(THIS_ BSTR) PURE;<br>
};<br>
<br>
#define TEXTLIMIT 10000<br>
<br>
extern IUnknown *getWScriptObject(void);<br>
extern void freeWScriptObject(void);<br>
<br>
<br>
<br>
<br>
In your IDL, you need to declare your phony WScript object's vtable:<br>
<br>
[uuid(CD19DEC1-3B5A-11d0-B39A-0080C7BC7884), dual]<br>
interface IWScriptVTable : IDispatch<br>
{<br>
  [id(1)] HRESULT Echo([in] BSTR line);<br>
}<br>
<br>
<br>
<br>
And in your IWSCRIPT.C source for your phony WScript object:<br>
<br>
#define INITGUID<br>
#include &lt;windows.h&gt;<br>
#include &lt;stddef.h&gt;<br>
#include &lt;tchar.h&gt;<br>
#include &lt;objbase.h&gt;<br>
#include &lt;activscp.h&gt;<br>
#include &lt;olectl.h&gt;<br>
#include &lt;cguid.h&gt;<br>
#include "IActiveScriptSite.h"<br>
#include "IWScript.h"<br>
#include "Extern.h" <br>
#include "Resource.h" <br>
<br>
const IID IID_IWScript = {0xCD19DEC1,0x3B5A,0x11d0,{0xB3,0x9A,0x00,0x80,0xC7,0xBC,0x78,0x84}};<br>
<br>
// Our IWScript VTable<br>
static STDMETHODIMP QueryInterface(IWScript *, REFIID, void **);<br>
static STDMETHODIMP_(ULONG) AddRef(IWScript *);<br>
static STDMETHODIMP_(ULONG) Release(IWScript *);<br>
static STDMETHODIMP GetTypeInfoCount(IWScript *, UINT *);<br>
static STDMETHODIMP GetTypeInfo(IWScript *, UINT , LCID , ITypeInfo **);<br>
static STDMETHODIMP GetIDsOfNames(IWScript *, REFIID, OLECHAR **, UINT, LCID, DISPID *);<br>
static STDMETHODIMP Invoke(IWScript *, DISPID, REFIID, LCID, WORD, DISPPARAMS *, VARIANT *, EXCEPINFO *, UINT *);<br>
static STDMETHODIMP Echo(IWScript *, BSTR);<br>
<br>
static const IWScriptVtbl VTable = {<br>
 QueryInterface,<br>
 AddRef,<br>
 Release,<br>
 GetTypeInfoCount,<br>
 GetTypeInfo,<br>
 GetIDsOfNames,<br>
 Invoke,<br>
 Echo};<br>
<br>
// It doesn't make sense to have more than 1 IWScript object,<br>
// so just declare it as a global.<br>
static IWScript WScriptObject = {(IWScriptVtbl *)&amp;VTable};<br>
<br>
static WScriptTypeInfo = 0;<br>
static DWORD Chars = 0;<br>
<br>
IUnknown * getWScriptObject(void)<br>
{<br>
   return((IUnknown *)&amp;WScriptObject);<br>
}<br>
<br>
void freeWScriptObject(void)<br>
{<br>
  if (WScriptTypeInfo) WScriptTypeInfo-&gt;lpVtbl-&gt;Release(WScriptTypeInfo);<br>
}<br>
<br>
static STDMETHODIMP QueryInterface(IWScript *this, REFIID vTableGuid, void **ppv) <br>
{<br>
  if (IsEqualIID(vTableGuid, &amp;IID_IUnknown) || IsEqualIID(vTableGuid, &amp;IID_IDispatch))<br>
    *ppv = this;<br>
  else<br>
  {<br>
    *ppv = 0;<br>
    return(E_NOINTERFACE);<br>
  }<br>
<br>
  return(S_OK);<br>
}<br>
<br>
static STDMETHODIMP_(ULONG) AddRef(IWScript *this)<br>
{<br>
  return(1);<br>
}<br>
 <br>
static STDMETHODIMP_(ULONG) Release(IWScript *this)<br>
{<br>
  return(1);<br>
}<br>
<br>
static STDMETHODIMP GetTypeInfoCount(IWScript *this, UINT *pctinfo)<br>
{<br>
  *pctinfo = 1;<br>
  return(S_OK);<br>
}<br>
 <br>
static STDMETHODIMP GetTypeInfo(IWScript *this, UINT ctinfo, LCID lcid, ITypeInfo **typeInfo)<br>
{<br>
  register HRESULT hr;<br>
<br>
  if (!WScriptTypeInfo &amp;&amp;<br>
    (hr = getITypeInfoFromExe(&amp;IID_IWScript, &amp;WScriptTypeInfo))) return(hr);<br>
<br>
  *typeInfo = WScriptTypeInfo;<br>
<br>
  WScriptTypeInfo-&gt;lpVtbl-&gt;AddRef(WScriptTypeInfo);<br>
<br>
  return(S_OK);<br>
}<br>
<br>
static STDMETHODIMP GetIDsOfNames(IWScript *this, REFIID riid, OLECHAR **rgszNames,<br>
  UINT cNames, LCID lcid, DISPID *rgdispid)<br>
{<br>
  register HRESULT hr;<br>
<br>
  if (!WScriptTypeInfo &amp;&amp;<br>
   (hr = getITypeInfoFromExe(&amp;IID_IWScript, &amp;WScriptTypeInfo))) return(hr);<br>
  return(WScriptTypeInfo-&gt;lpVtbl-&gt;GetIDsOfNames(WScriptTypeInfo, rgszNames, cNames, rgdispid));<br>
}<br>
 <br>
static STDMETHODIMP Invoke(IWScript *this, DISPID id, REFIID riid, LCID lcid,<br>
  WORD flag, DISPPARAMS *params, VARIANT *ret, EXCEPINFO *pei, UINT *pu)<br>
{<br>
  register HRESULT hr;<br>
<br>
  if (!WScriptTypeInfo &amp;&amp;<br>
    (hr = getITypeInfoFromExe(&amp;IID_IWScript, &amp;WScriptTypeInfo))) return(hr);<br>
<br>
  return(WScriptTypeInfo-&gt;lpVtbl-&gt;Invoke(WScriptTypeInfo, this, id, flag, params, ret, pei, pu));<br>
}<br>
<br>
static STDMETHODIMP Echo(IWScript *this, BSTR str)<br>
{<br>
  register HWND child;<br>
<br>
  // Note: If the script is being run in a different thread<br>
  // than the user interface thread, this assumes that both<br>
  // threads will not output to the same edit control<br>
<br>
  // Get the edit control where I display text<br>
  child = GetDlgItem(MainWindow, ICD_MYEDIT);<br>
<br>
  Chars += lstrlenW(str);<br>
  if (Chars &gt;= TEXTLIMIT);<br>
  {<br>
    SendMessage(child, EM_SETSEL, 0, -1);<br>
    Chars = lstrlenW(str);<br>
  }<br>
  else<br>
    SendMessage(child, EM_SETSEL, (WPARAM)-1, -1);<br>
<br>
  // NOTE: Unicode SendMessage<br>
  SendMessageW(child, EM_REPLACESEL, 0, (LPARAM)str);<br>
<br>
  SendMessage(child, EM_SETSEL, (WPARAM)-1, -1);<br>
  SendMessage(child, EM_REPLACESEL, 0, (LPARAM)"\r\n");<br>
  <br>
  return(S_OK);<br>
}<br>
<br>
<br>
<br>
<br>
And of course, your IActiveScriptSite's GetItemInfo:<br>
<br>
#include "IWScript.h"<br>
<br>
static STDMETHODIMP GetItemInfo(MyRealIActiveScriptSite *this, LPCOLESTR objectName,<br>
  DWORD dwReturnMask, IUnknown **objPtr, ITypeInfo **typeInfo)<br>
{<br>
  register HRESULT hr;<br>
<br>
  // Assume failure<br>
  hr = E_FAIL;<br>
  if (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN) *objPtr = 0;<br>
  if (dwReturnMask &amp; SCRIPTINFO_ITYPEINFO) *typeInfo = 0;<br>
<br>
  // Does the engine want our IWScript object (has the string name "WScript")?<br>
  if (!lstrcmpiW(objectName, L"WScript"))<br>
  {<br>
    // Does the engine want a pointer to our IWScript object returned?<br>
    if (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN)<br>
       *objPtr = getWScriptObject();<br>
<br>
    hr = S_OK;<br>
  }<br>
bad:<br>
  return(hr);<br>
}<br>
<br>
<br>
<br>
When you run the script, add your phony WScript object to the VB engine:<br>
<br>
EngineActiveScript-&gt;lpVtbl-&gt;AddNamedItem(EngineActiveScript, L"WScript", SCRIPTITEM_ISVISIBLE|SCRIPTITEM_NOCODE);<br>
<br>
<br>
<br>
<br>
One more thing: Right before your program terminates, make sure you call freeWScriptObject().<br>
<br>
<br>
 -- modified at 21:56 Sunday 11th February, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1888928" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1889084" name="react-item_1889084" id="MRF1889084" class="reaction-result"></span><span data-objectref="3_1889084" data-votingtype="GoodOrBad" name="RateItem_1889084" id="MVF1889084" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1889084" href="https://www.codeproject.com/Messages/1889084/Re-script-output-to-console-modified" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889956_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx1889956xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1889956" parent="1889084" thread="1888928" href="https://www.codeproject.com/Messages/1889956/Re-script-output-to-console">Re: script output to console</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">XBLite</span><span class="date">12-Feb-07  2:53</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1156718">XBLite</a></span></td><td class="date"><span>12-Feb-07  2:53&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889956_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1889084);" href="https://www.codeproject.com/Messages/1889084/Re-script-output-to-console-modified"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks Jeff, I'll give it a try. Your detailed<br>
response was really appreciated.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1888928" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1889956" name="react-item_1889956" id="MRF1889956" class="reaction-result"></span><span data-objectref="3_1889956" data-votingtype="GoodOrBad" name="RateItem_1889956" id="MVF1889956" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1889956" href="https://www.codeproject.com/Messages/1889956/Re-script-output-to-console" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831146_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx1831146xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1831146" parent="0" thread="1831146" href="https://www.codeproject.com/Messages/1831146/Part-7-modified">Part 7 ? [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Garth J Lancaster</span><span class="date">5-Jan-07  15:11</span>
</div></td><td class="icon"><img border="0" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-pro-16.png" title="Professional" alt="professional" height="16px" width="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12169">Garth J Lancaster</a></span></td><td class="date"><span>5-Jan-07  15:11&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831146_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Jeff - love your work so far - some of this stuff to 
do with ActiveX Hosts just didnt gell until I read this - so many thanks
 to you. <strike>Is Part 7 coming anytime soon - where you'll show how to exchange variables etc ?</strike><br>
<br>
Modified : Sorry - just did another check on CP - didnt see 'Part 7' the first time round - 'goody goody', its there <br>
<br>
cheers, keep up the good work<br>
Garth<br>
<br>
<br>
 -- modified at 21:20 Friday 5th January, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1831146" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1831146" name="react-item_1831146" id="MRF1831146" class="reaction-result"></span><span data-objectref="3_1831146" data-votingtype="GoodOrBad" name="RateItem_1831146" id="MVF1831146" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1831146" href="https://www.codeproject.com/Messages/1831146/Part-7-modified" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831390_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx1831390xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1831390" parent="1831146" thread="1831146" href="https://www.codeproject.com/Messages/1831390/Re-Part-7">Re: Part 7 ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">5-Jan-07  21:51</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>5-Jan-07  21:51&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831390_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1831146);" href="https://www.codeproject.com/Messages/1831146/Part-7-modified"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Actually, Part 7 details how to have a script call your own C functions.<br>
<br>
Part 8, which has just been posted, shows how to set/query variables in a script (as well as a few other miscellaneous details).<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1831146" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1831390" name="react-item_1831390" id="MRF1831390" class="reaction-result"></span><span data-objectref="3_1831390" data-votingtype="GoodOrBad" name="RateItem_1831390" id="MVF1831390" class="rating-result"><span>1.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1831390" href="https://www.codeproject.com/Messages/1831390/Re-Part-7" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831409_h0" class="header hover-row">
<td class="subject-line normal vote-hi" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx1831409xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1831409" parent="1831390" thread="1831146" href="https://www.codeproject.com/Messages/1831409/Re-Part-7">Re: Part 7 ?</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Garth J Lancaster</span><span class="date">5-Jan-07  22:06</span>
</div></td><td class="icon"><img border="0" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/icn-pro-16.png" title="Professional" alt="professional" height="16px" width="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=12169">Garth J Lancaster</a></span></td><td class="date"><span>5-Jan-07  22:06&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1831409_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1831390);" href="https://www.codeproject.com/Messages/1831390/Re-Part-7"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Many Thanks<br>
<br>
Hope you're well &amp; happy<br>
<br>
cheers, Garth<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/14905/COM-in-plain-C-Part-6" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1831146" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1831409" name="react-item_1831409" id="MRF1831409" class="reaction-result"></span><span data-objectref="3_1831409" data-votingtype="GoodOrBad" name="RateItem_1831409" id="MVF1831409" class="rating-result"><span>5.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1831409" href="https://www.codeproject.com/Messages/1831409/Re-Part-7" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 27-Aug-23  0:42</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/14905/COM-in-plain-C-Part-6?fid=325716&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=16"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				
				

				

                <div id="ctl00_RHSticky" class="container-article-info-sticky sticky">

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="senseai" data-country="US" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&sz=300x250&c=884252"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&sz=300x250&c=884252"  width="300px" height="250px" target="_blank"/></a></noscript></div>
					</div>

        		    

<div class="article-summary">

    
    

</div>

				    

                    

				    

				    

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesCplusplus" data-country="US" data-loadonview="true" data-tags="C++, Windows, Visual-Studio, Dev, COM, Beginner,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesCplusplus&sz=300x250&c=884252"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesCplusplus&sz=300x250&c=884252"  width="300px" height="250px" target="_blank"/></a></noscript></div>
					</div>

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/14905/COM-in-plain-C-Part-6?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2006 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2023 <br>
                <br>
				Web03 
				2.8:2023-08-14:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/DFPAudiencePixel" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

function Join() {
    document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
    return false;
}

var fnhejxjzpu = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new fnhejxjzpu).init()}catch(i){(new fnhejxjzpu).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new fnhejxjzpu).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('<div class="small-text muted hidden">Advertisement</div>');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() > 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;
var forumCtrl_ctl00_MessageBoard_reaction;
var forumCtrl_ctl00_MessageBoard__reactionConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 325716,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	MicroModal.init();
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_14905_1',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            88625,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    allowReactions      : false,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    reactionControl     : null,
	    codeblockProcessor  : new CodeBlocks(),
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in-out',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href=\'/info/cookie.aspx\'>Cookie Policy</a>, <a href=\'/info/privacy.aspx\'>Privacy Policy</a>, and our <a href=\'/info/TermsOfUse.aspx\'>Terms of Service</a>.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><script async="" type="text/javascript" src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/gpt.js"></script><script type="text/javascript">if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",CloseAdImageUrl="https://cdn1.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://cdn1.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png";String.prototype.includes||(String.prototype.includes=function(n,t){"use strict";return(typeof t!="number"&&(t=0),t+n.length>this.length)?!1:this.indexOf(n,t)!==-1});var DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&&n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="<select class='reportReason' style='max-width:150px !important; padding: 0px !important'><option>Offensive<\/option><option>Abusive<\/option><option>Off topic<\/option><option>Don't like the Ad<\/option > <option>Wrong language<\/option><\/select > ",f="<input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'><\/input>";return t===728&&i===90?k(r,u,f):t===300&&i===250?d(r,u,f):t===160&&i===600?g(r,u,f):t===125&&i===125&&nt(r),(t===728&&i===90||t===300&&i===250||t===160&&i===600)&&tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'><div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'>1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here<\/div><div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"&nbsp;"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'><\/a>";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'><div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/>2. Drag and Drop or paste the screenshot here<\/div><div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '> "+i+"<\/div><div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'><\/a>";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'><div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/><br/>2. Drag and Drop or paste the screenshot here<\/div><div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"<\/div><div style='font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'><\/a>";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="<div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'><span style='color:#999;'>Thank you for the report!<\/span><\/div>";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&&n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&&(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="<br/><br/>Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&&t.height===600?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===300&&t.height===250?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===728&&t.height===90?"Your screenshot has been received – thanks! Next step: What’s wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&&(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&&(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&&r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&&(u.style.display="none");f&&(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&&n.fileList.length>0&&(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&&(l=n.clipboardData||n.originalEvent.clipboardData,s=l&&l.items||[],t=[],s&&s.length>0))for(h=!0,c=0;c<s.length;c++)a=s[c],a.kind==="file"&&(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&&t.length>0?(v=i(f),v&&(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="<br/><br/> No files found on clipboard <br/>",u(f)):(n.currentTarget.innerHTML="<br/><br/> Paste not supported on your browser <br/>",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&&n.dataTransfer.files.length>0)for(t=0;t<n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&&n.dataTransfer.files[t].type.indexOf("image")>=0&&(r[r.length]=n.dataTransfer.files[t]);r.length>0?(f&&(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="<br/><br/>The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&&t.style.display!=="none"&&t.src&&(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&&(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},i=function(t){for(var i=0,r=n.length;i<r;i++)if(n[i]&&n[i].adContainer&&n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&&window.MutationObserver&&(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&&y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")>=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i>0&&(o=new Date,o.setTime(o.getTime()+i*864e5))&&(e+="; expires="+o.toGMTString());r&&(e+="; path="+r);u&&u.indexOf(".")!==-1&&(e+="; domain="+u);f&&(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index<t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&&JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&&r.Id&&r.Id===n.Id&&(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&&c(i)},c=function(t){for(n=t;i.length>0;){var r=i.pop();typeof r=="function"&&r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={PageQueryTerms:"",PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:"",PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:"loading",PIIViolatingUrls:["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t<r.length;t++)if(i=r[t],n.indexOf(i.d)>=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r<0||r+n.length>=t.length?"":(u=t.indexOf("&",r),u<0&&(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);if(t!==""&&(i=e(f(t,n))),i===""){if(n=document.referrer.toLocaleLowerCase(),!n)return"";t=u(n);t!==""&&(i=e(f(t,n)))}DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&&n();return}DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&&(i.SearchTerms&&(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&&(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&&i.aid.length&&i.aid.length>0&&DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&&n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)}},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t<i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r<n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&&(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&&i(n))},e=null;r&&(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&&(e&&clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&&clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&&clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&&window.top.postMessage&&setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},CreateAds:function(n){this.PageRandomNumber=DMAds.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==="weLoadedGPT"?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=e.height*-1);o=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;s=i>t.left&&t.right>=0;u=o&&s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n<DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&&l(n)&&u(n)&&e(n),t.rendered&&(i++,t.sticky&&!t.stickySettings&&(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&&clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n<DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&&(s=!1),!s&&u(n)&&e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o<DMAds.Ads.length&&!r;o++)if(r=!u(o),r)break;r&&(f=setInterval(t,100))};DMAds.GPTRenderingMode==="loading"?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange");n&&document.addEventListener&&document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&&(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&&n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&&(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i<DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&&n.adContainer&&(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,f=DMAds.Ads[n].theAdDiv,u,h,s;if(i&&i.isStickyRequired&&t.getBoundingClientRect&&document.getElementsByClassName){u=document.getElementsByClassName("sticky-stop")[0];u&&(h=r(u),s=u.getBoundingClientRect());var c=r(t),e=t.getBoundingClientRect(),o,l=c.y+e.height+Math.abs(e.top)>h.y;u&&l&&s.top<e.height?o=s.top-e.height+"px":window.pageYOffset+10>=i.absoluteTop&&(o="10px");o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",f.clientHeight===0&&(f.style.height=t.clientHeight+"px"),f.clientWidth===0&&(f.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition}},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&&t.style.position!=="fixed"&&t.offsetParent?i=!0:t&&t.style.position==="fixed"&&(r=window.getComputedStyle(t),i=r&&r.display!=="none"),i&&v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&&(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length>0&&(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))},ShowAd:function(n){var t=DMAds.Ads,i;if(n&&(DMAds.GPTRenderingMode!=="weLoadedGPT"||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==="weLoadedGPT"&&DMAds.PublisherPageViewGuid){while(t&&t.length>0)i=t.pop(),DMAds.RequestQueuedAd(i);n&&DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){if(googletag){var n=function(){if(googletag.pubadsReady)DMAds.GPTRenderingMode!=="weLoadedGPT"&&(DMAds.GPTRenderingMode="gptAlreadyLoaded");else{if(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),DMAds.Ads&&DMAds.Ads[0]&&typeof DMAds.Ads[0].cookieConsent!="undefined"){var n=DMAds.Ads[0].cookieConsent?1:0;googletag.pubads().setRequestNonPersonalizedAds(n?0:1)}googletag.pubads().enableAsyncRendering();googletag.enableServices();DMAds.GPTRenderingMode="weLoadedGPT";googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})}};googletag.apiReady?n():googletag.cmd.push(function(){n()})}},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length<2048&&(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f=n.cookieConsent!==undefined,e=n.cookieConsent?1:0,o="<div id='"+t+"'>     <script type='text/javascript'>         googletag.cmd.push(function() {             if ( "+f+" && typeof googletag.pubads == 'function') {               googletag.pubads().setRequestNonPersonalizedAds("+e+" ? 0 : 1);            }            googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     <\/script> <\/div>";return"<script type='text/javascript'> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); <\/script>"+o},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\<\>\[\]]/gi,"");for(var r=t.split(","),u=[];r.length>0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&&n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r>=0&&(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&&(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=DMAds.PIIViolatingUrls.length;n<r&&t;n++)t=!(i.indexOf(DMAds.PIIViolatingUrls[n])>=0)}catch(u){console.log("Error in IsPagePIICompliant: "+u)}return t},OnSlotRendered:function(n){if(window.location.href&&window.location.href.includes("show_creative_id=1")&&n&&n.creativeId&&console.log(n.creativeId),EnableMutableAds&&n&&!n.isEmpty&&(!n.lineItemId||n.lineItemId&&n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&&n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&&(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u<s;u++)h.test(f[u].getAttribute(n))&&(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r<o;r++)s.test(u[r].className)&&(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length<=0)&&(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t<n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var u,f,r,o=n.attributes,s=o.length,i={},e=0;e<s;e++)u=o.item(e),u.nodeName.indexOf("lqm_")===0&&(f=u.nodeName.slice(4),i[f]=u.value||u.nodeValue),u.nodeName.indexOf("data-")===0&&(f=u.nodeName.slice(5),i[f]=u.value||u.nodeValue);return r={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,cookieConsent:i.cookieconsent,theAdDiv:n},r.tags&&(r.tags=decodeURIComponent(r.tags)),DMAds.DetermineTagSize(r),r.publisher&&r.publisher===CodeProjectPublisherId&&(r.articleid=DMAds.GetArticleId(r.publisher)),r},SetupAds:function(){DMAds.IsPagePIICompliant()&&(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),DMAds.CreateAds())},Initialise:function(){if(DMAds.IsPagePIICompliant())if(window.googletag)DMAds.SetupAds();else{var t="https:"===document.location.protocol,n=document.createElement("script");n.async=!0;n.type="text/javascript";n.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";n.onload=this.SetupAds;document.body.appendChild(n)}}};window.DMAds=DMAds}if(DMAds.IsPagePIICompliant())if(window.addEventListener)window.addEventListener("load",function(){DMAds.Initialise()},!1);else try{window.attachEvent("onload",function(){DMAds.Initialise()})}catch(e){DMAds.Initialise()}</script><div style="position: fixed; z-index: 9999; height: 289px;" id="credential_picker_container"><iframe src="COM%20in%20plain%20C,%20Part%206%20-%20CodeProject_files/select.html" title="Sign in with Google Dialog" style="height: 289px; width: 391px; overflow: hidden;"></iframe></div><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>