<!DOCTYPE html>
<html lang="en" class=" lnrbnhc idc0_348"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

	

	
	<link rel="preconnect" href="https://apps.developermedia.com/">
	<link rel="preconnect" href="https://cdn1.developermedia.com/">
	<link rel="preconnect" href="https://cdn.ampproject.org/">
	<link rel="preconnect" href="https://fonts.googleapis.com/">
	<link rel="preconnect" href="https://ajax.googleapis.com/">
	<link rel="preconnect" href="https://adservice.google.com/">
	<link rel="preconnect" href="https://www.googletagservices.com/">
	<link rel="preconnect" href="https://www.googletagmanager.com/">
	<link rel="preconnect" href="https://www.google.com/">
	<link rel="preconnect" href="https://www.google-analytics.com/">
	<link rel="preconnect" href="https://pagead2.googlesyndication.com/">

	<link rel="preconnect" href="https://codeproject.freetls.fastly.net/">


	<link rel="preload" href="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/jquery-3.4.1.min.js" as="script" type="text/javascript">


	<title>COM in plain C, part 8 - CodeProject</title> 
    
	<!-- inlined file /App_Themes/CodeProject/Css/article.critical.min.css. Minimized in Release. -->
<style type="text/css">
.blank-background{background-color:#fff}html,div,span,applet,object,iframe,a,abbr,acronym,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,fieldset,form,label,table,tbody,tfoot,thead,tr,th,td,li,ol,ul{margin:0;padding:0;border:0}html{font-size:16px;-webkit-font-smoothing:antialiased;font-smooth:always}body,p,h1,h2,h3,h4,h5,h6,li,tr,td,th,dd,dt{font-family:"Segoe UI",Arial,Sans-Serif;font-size:16px;line-height:1.4;color:#111}body{margin:0}h1,h3,h4,h5,th{font-weight:bold}h1{color:#333;padding:0;margin:0 0 7px;text-align:left}h2{margin:20px 0 11px;padding:0;padding-bottom:10px;color:#333}h1{font-size:38px;font-weight:400}h2{font-size:29px;font-weight:400}h4{font-size:17px}table{background-color:Transparent}img{-ms-interpolation-mode:bicubic}a{text-decoration:none;color:#005782}a:visited{color:#800080}a:hover{text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}input[type="text"],input[type="url"],input[type="search"],input[type="email"],input[type="number"],input[type="password"],select,textarea{border:1px solid #d7d7d7;font-size:16px;padding:5px}a.button,a.button-large,.button,.button-large{color:#fff;background-color:#e08900;border:1px solid #ccc;text-decoration:none;white-space:nowrap;font-size:100%;padding:4px;cursor:pointer;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}table.small-text td,ul.small-text li,ol.small-text li,.small-text{font-size:14px}.invisible{display:none}.subdue,.subdue li,tr.subdue td{color:#808080}.align-left{text-align:left}.align-right{text-align:right}.align-center{text-align:center}.float-right{float:right}.float-left{float:left}.sticky{position:sticky;top:0}.extended{width:100%;box-sizing:border-box}.padded-top{padding-top:20px}.tight{margin:0;padding:0}.nowrap{white-space:nowrap}.fixed-layout{table-layout:fixed}.clipped{overflow:hidden}.raised{background-color:#fff8df;border:1px solid #ccc;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}ol,ul{padding-left:40px;margin:10px 0}ol.compact li,ul.compact li,ol li.compact,ul li.compact{font-size:14px}.callout{margin:20px 0;background-color:#ffffe1;color:#333;border:1px solid #ccc;padding:15px;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}.trace{padding:20px;background-color:#eee;color:#333;border:1px solid #f00;font-size:13px}textarea,input[type="text"],input[type="button"],input[type="submit"]{-webkit-appearance:none;border-radius:0}.container-content{background-color:#fff;position:relative;zoom:1;padding:0 9px;cursor:default}.container-content-wrap{margin:auto;max-width:1270px}.flex-container{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.flex-extend{justify-content:space-between}.flex-wrap{flex-wrap:wrap}.flex-item{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.flex-item-tight{flex:0 1 auto}.hover-container{display:block;position:relative}.clearfix:after,.container:after{display:block;content:'.';visibility:hidden;height:0;clear:both}.clearfix,.container{display:inline-block;display:block}.access-link,.access-link img{position:absolute;top:0;left:0;width:1px;height:1px;z-index:101;border-style:none;margin-top:-1px;overflow:hidden}.site-top-menu{white-space:nowrap;position:absolute;z-index:101;width:100%}.site-top-menu .main-content{width:100%}.site-top-menu .main-content .memberbar{margin-left:90px;margin-right:10px}.site-top-menu.fixed .main-content{margin:auto;max-width:1270px}.site-header{background-image:url('/App_Themes/CodeProject/Img/logo135-bg.gif');white-space:nowrap;overflow:hidden}.site-header .main-content{position:relative;overflow:hidden;white-space:nowrap}.site-header .logo{display:inline-block}.site-header .promo{display:inline-block;position:absolute;top:33px;right:0}.site-header.fixed .main-content{margin:auto;max-width:1270px}.sub-headerbar{padding-right:9px;position:relative;margin:auto;max-width:1270px}.sub-headerbar-divider{margin-left:10px;height:1px;border-bottom:1px solid #ccc;position:absolute;bottom:2px;left:0;right:9px}.memberbar{height:25px;padding-top:10px;color:#999;font-size:14px}.memberbar a{color:#808080;font-size:14px}div.navbar{white-space:nowrap}.navmenu{background:#fff;color:#4d4d4d;padding:0;margin:0;list-style:none;height:25px}.navmenu ul,.navmenu li{margin:0;padding:0}.navmenu .has-submenu{position:absolute;right:5px;padding-left:10px}.navmenu>li:hover>a,.navmenu>li>a:active{border:1px solid #ccc}.navmenu ul,.navmenu>li.open:hover>a,.navmenu>li.open>a:active{border:1px solid #ccc;border-bottom-color:#fff}.navmenu>li{margin:0 11px 2px 2px}.navmenu>li:active,.navmenu>li:active>a,.navmenu>li:hover,.navmenu>li>a:active{background:#fff;color:#4d4d4d}.navmenu>li>a{padding:2px 7px 6px 7px;border:1px solid transparent;font-weight:bold}.navmenu a{display:block;float:left;color:#666;background:#fff;font-size:17px;padding:0 9px;text-decoration:none;white-space:nowrap}.navmenu a.fly{white-space:nowrap}.navmenu ul{background:#fff;position:absolute;left:-9999px;top:-9999px;list-style:none}.navmenu li{float:left;color:#4d4d4d}.navmenu li.last{height:9px}.navmenu li a:active,.navmenu li a:hover{color:#fff;background-color:#f90}.navmenu li>a:active,.navmenu li:hover,.navmenu li:hover>a,.navmenu li:hover.heading,.navmenu li a.selected{position:relative;color:#fff;background-color:#f90}.navmenu li.openable:hover ul{left:0;top:30px;z-index:500}.navmenu li.openable:hover>ul ul{position:absolute;left:-9999px;top:-9999px;width:auto}.navmenu li.open{position:relative}.navmenu li.open a{color:#fff;background-color:#f90}.navmenu li.open ul{left:0;top:30px;z-index:500}.navmenu li ul{border-bottom:5px solid #f90}.navmenu li li{float:none}.navmenu li li:active>a.fly,.navmenu li li:hover>a.fly{color:#fff;background-color:#f90}.navmenu li li a{float:none;font-size:16px;font-weight:normal}.navmenu li li a.fly{color:#4d4d4d;background-color:#fff;padding:2px 20px}.navmenu li li a.break{margin-bottom:15px}.navmenu li li a.highlight1,.navmenu li li a.highlight1:active,.navmenu li li a.highlight1:hover{background-color:#090}.navmenu li li a.highlight2,.navmenu li li a.highlight2:active,.navmenu li li a.highlight2:hover{background-color:#f90}.navmenu li li a.highlight3,.navmenu li li a.highlight3:active,.navmenu li li a.highlight3:hover{background-color:#000}.navmenu li li a.highlight1,.navmenu li li a.highlight2,.navmenu li li a.highlight3{color:#fff;font-size:16px;margin:5px 0;padding:9px 20px}.site-footer{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;padding-top:5px;width:100%;font-size:13px;color:#999}.site-footer .align-left,.site-footer .align-center,.site-footer .align-right{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.site-footer .align-left{flex:1 0 100px}.site-footer .align-center{flex:0 1 0%;white-space:nowrap}.site-footer .align-right{flex:1 0 100px}.site-footer .page-width .active{border-bottom:2px solid #f90}.searchbar{padding:0}.searchbar .search{margin-bottom:4px;padding:2px 5px 0;border:1px solid #ccc}.searchbar .search.subdue{color:#ccc}.searchbar input.search{width:190px;border:none;font-size:13px;padding:4px 2px}.searchbar .search-advanced{padding:8px;width:203px;z-index:1000;background-color:#fff;border:solid 1px #ccc;position:absolute;top:-4px;right:0}.searchbar .popup{display:none}.search td{background-color:#fff}.article-container-parts{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.article-container{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;background-color:#fff;color:#111;zoom:1;position:relative;max-width:100%;min-height:675px}.article-container .article{margin:0 20px 0 10px;line-height:143%}.article-container span.stats{margin-left:30px}.article-left-sidebar{width:120px;min-width:120px;min-height:400px;font-size:14px;border-right:1px solid #f2f2f2;padding:0}.article-left-sidebar .article-left-sidebar-inner{width:120px;min-width:120px}.article-left-sidebar .tabs>div{padding:5px 0 5px 10px}.article-left-sidebar .selected{font-weight:bold;background:transparent url("/images/right-selected.gif") no-repeat scroll right 9px}.article-left-sidebar .original{color:#808080;margin:-10px 0 0 15px}.article-left-sidebar h4{color:#f90;font-size:14px;font-weight:bold}.article-left-sidebar .stats div div div{padding:0 0 10px 10px;color:#666}.article-right-sidebar{width:300px;margin-left:10px;font-size:14px}.article-right-sidebar .gototop{text-align:center;padding:10px 0;opacity:0;-webkit-transition:opacity .3s linear 0ms;-moz-transition:opacity .3s linear 0ms;-o-transition:opacity .3s linear 0ms;transition:opacity .3s linear 0ms}.container-content .edit-links{margin:21px 0 0 10px}.article-summary{padding:0 10px 0 10px;overflow:hidden}.article h1{margin:0 0 15px 0}.article h2{color:#f90}.article .header .title{color:#808080}.article .header .author{font-weight:bold;min-width:100px}.article .header .author a{color:#808080}.article .header .avatar{max-width:48px;max-height:48px;overflow:unset}.article .header .avatar-wrap{width:48px;height:48px;margin-right:10px;text-align:center}.article .header .date{white-space:nowrap}.article .header .license{margin-left:15px}.article .header .stats{margin-left:30px}.article .summary{color:#808080;padding:40px 0 15px 0}.article .text{padding-top:10px}.article-nav{text-align:right;margin-top:21px;vertical-align:middle;line-height:15px}span.math{display:inline-block}.msg-728x90{width:728px;height:90px;overflow:hidden}.msg-300x250{width:300px;height:250px;overflow:hidden}.tags{line-height:190%}.tags .t{background:none repeat scroll 0 0 transparent;border:1px solid #fbedbb;border-radius:12px 0 0 12px;line-height:1.4;padding:0 2px 2px 3px;position:relative;text-decoration:none;margin:2px 5px 4px 0;white-space:nowrap}.tags .t a{color:#666;display:inline-block;margin-right:3px;padding-left:5px;text-overflow:ellipsis}.container-breadcrumb{font-size:14px;margin-top:7px;color:#808080;margin:12px 0 35px}.container-breadcrumb a{color:#808080}.speech-bubble-container-down,.speech-bubble-container-up,.speech-bubble-container-up-right,.speech-bubble-container-left,.speech-bubble-container-right{position:relative}.ie .speech-bubble-container-up,.firefox .speech-bubble-container-up,.chrome .speech-bubble-container-up,.ie .speech-bubble-container-up-right,.firefox .speech-bubble-container-up-right,.chrome .speech-bubble-container-up-right{margin-top:-4px}.tooltip{position:relative;text-decoration:none}.tooltip .speech-bubble-container-up,.tooltip .speech-bubble-container-down,.tooltip .speech-bubble-container-left,.tooltip .speech-bubble-container-right,.tooltip .speech-bubble-container-up-right,.tooltip .tooltip-flyout{display:none;opacity:0;-webkit-transition:opacity .5s linear 0ms;-moz-transition:opacity .5s linear 0ms;-o-transition:opacity .5s linear 0ms;transition:opacity .5s linear 0ms}.micromodal{display:none}.bottom-promo{height:90px;margin-top:10px;overflow:hidden}.bottom-promo .msg-728x90{width:728px;margin:0 auto}.msg-728x90{overflow:hidden;position:relative;height:90px;min-width:728px}body .msg-728x90{*float:right}body .bottom-promo .msg-728x90{*float:none}table.forum{table-layout:fixed;margin:0 0 20px 0;padding:0;width:100%}.forum table{border-collapse:separate}.forum .header1,.forum .header1 TD{color:#333;font-size:14px;vertical-align:middle}.forum .header2,.forum .header2 TD{color:#fff;background-color:#f90;font-size:14px;vertical-align:middle}.forum .header2 input,.forum .header2 TD input,.forum .header2 select,.forum .header2 TD select{padding:2px}.forum .button{border:1px solid #fc6;margin:1px}.forum .searchbar{border:1px solid #ccc;padding:4px 0 0 0;margin:3px 0}.forum .searchbar .search{width:200px}.forum .searchbar input[type=image]{vertical-align:middle}.forum .dropdown{background-color:#fffdfa;font-size:95%;margin-left:5px}.forum .footer,.forum .footer td,.forum .navbar,.forum .navbar td{font-size:14px;padding:8px 0;border:0;border-top:1px solid #808080}.author-wrapper{position:relative}.author-wrapper .profile-pic{border:1px solid #333;margin:0 13px 0 0;padding:10px;-moz-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);-webkit-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);max-height:100px}.author-wrapper .container-member .author{font-size:29px;color:#333;font-weight:600}.rating-container .rating-prompt{padding-right:5px;white-space:nowrap;line-height:25px;margin-right:2px;font-weight:bold;color:#808080}.rating-container .rating-votes{margin-left:5px}.rating-container.large-stars,.rating-container.medium-stars,.rating-container.small-stars{margin-left:7px}.rating-container.large-stars .rating-votes,.rating-container.large-stars .rating-prompt,.rating-container.large-stars .rating-poor,.rating-container.large-stars .rating-good{line-height:25px}@media(min-width:1024px){.desktop-lg-block-only{display:none}.desktop-only{display:inherit}.desktop-block-only{display:block}.tablet-only,.tablet-block-only{display:none}.mobile-only,.mobile-block-only{display:none}.desktop-only.tablet-only{display:inherit}.desktop-block-only.tablet-block-only{display:block}}@media(min-width:821px){.desktop-lg-block-only{display:none}.tablet-only,.mobile-only{display:none}.tablet-block-only,.mobile-block-only{display:none}.tablet-only.desktop-only{display:inherit}.tablet-block-only.desktop-block-only{display:block}}.rrssb-buttons,.rrssb-buttons li,.rrssb-buttons li a{-moz-box-sizing:border-box;box-sizing:border-box}.clearfix{*zoom:1}.clearfix:after{clear:both}.clearfix:before,.clearfix:after{content:" ";display:table}.rrssb-buttons{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;height:40px;margin:0;padding:0;width:100%}.rrssb-buttons li{float:left;height:100%;list-style:none;margin:0;padding:0 2.5px;line-height:13px}.rrssb-buttons li.email a{background-color:#0a88ff}.rrssb-buttons li.facebook a{background-color:#306199}.rrssb-buttons li.linkedin a{background-color:#007bb6}.rrssb-buttons li.twitter a{background-color:#26c4f1}.rrssb-buttons li.reddit a{background-color:#8bbbe3}.rrssb-buttons li.pinterest a{background-color:#b81621}.rrssb-buttons li.compact{padding:0 4.5px}.rrssb-buttons li.compact a{border-radius:50%;padding:0 7px 0 32px}.rrssb-buttons li.compact a .icon{left:7px;top:-3px;width:5%;transform:scale(.85)}.rrssb-buttons li.compact a .icon svg{height:auto;width:auto}.rrssb-buttons li a{background-color:#ccc;border-radius:3px;display:block;font-size:11px;font-weight:bold;height:100%;padding:11px 7px 12px 27px;position:relative;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:100%;-webkit-transition:background-color .2s ease-in-out;-moz-transition:background-color .2s ease-in-out;-o-transition:background-color .2s ease-in-out;transition:background-color .2s ease-in-out}.rrssb-buttons li a .icon{display:block;height:100%;left:10px;padding-top:9px;position:absolute;top:0;width:10%}.rrssb-buttons li a .icon svg{height:17px;width:17px}.rrssb-buttons li a .icon svg path,.rrssb-buttons li a .icon svg polygon{fill:#fff}
</style>
<link rel="stylesheet" type="text/css" href="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/Main.min.css" media="all" onload="if(media!='all')media='all'">
<noscript><link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8:2023-08-14:1"></noscript>


    <script type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/jquery-3.4.1.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/article.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/client" defer="defer" async=""></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/MemberProfilePopup.min.js" defer="defer"></script>
<script type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/a.min.js" defer="defer"></script>

	
<meta http-equiv="content-language" content="en-US">
<meta charset="UTF-8">
<meta name="Description" content="Miscellaneous Script Host details">
<meta name="Keywords" content="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate">
<meta name="Author" content="Jeff Glatt">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/COM-in-plain-C-part-8.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="1/6/2007 3:44:00 AM">
<meta property="article:modified_time" content="3/29/2007 4:49:00 PM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Jeff Glatt">
<meta name="twitter:label2" content="Reading time">
<meta name="twitter:data2" content="13 min read">
<meta property="og:url" content="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8">
<meta property="og:title" content="COM in plain C, part 8">
<meta property="og:description" content="Miscellaneous Script Host details">

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Python" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=34">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">

<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8"
   },
  "name": "COM in plain C, part 8",
  "headline": "COM in plain C, part 8",
  "url": "https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8",
  "discussionUrl": "https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VC6,C++,C,Windows,Visual-Studio,Dev,COM,Intermediate",
  "commentCount": "15",
  "editor" : {
    "@type" : "Person",
    "name" : "Sean Ewington",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3873871"
  },
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Miscellaneous Script Host details",
  "articleSection": "C",
  "author" : [{
      "@type" : "Person",
      "name" : "Jeff Glatt",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=88625"
    }],
  "datePublished": "2007-01-06",
  "dateCreated": "2007-01-06",
  "dateModified": "2007-03-29"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.85,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=Languages",
      "name" : "Programming Languages"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=C",
      "name" : "C"
    }
  }]
}</script>


	<!-- base href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8" -->
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/js"></script>
    <style id="googleidentityservice_button_styles">.qJTHM{-moz-user-select:none;color:#202124;direction:ltr;font-family:"Roboto-Regular",arial,sans-serif;font-weight:400;margin:0;overflow:hidden}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-moz-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{border-radius:4px;box-sizing:border-box;transition:background-color .218s,border-color .218s;-moz-user-select:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;justify-content:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;flex-direction:row;justify-content:space-between;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{border-radius:50%;display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-moz-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-YZNPNQ0F2S' , {'user_id': '9bd02f62-656b-43b1-a8e3-74fba4e7f215'});
    </script>

<style type="text/css"></style><link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/style.css"><style></style><link href="data:text/css,%5Bid*%3D'google_ads_iframe'%5D%2C%5Bid*%3D'taboola-'%5D%2C.taboolaHeight%2C.taboola-placeholder%2C%23credential_picker_container%2C%23credentials-picker-container%2C%23credential_picker_iframe%2C%5Bid*%3D'google-one-tap-iframe'%5D%2C%23google-one-tap-popup-container%2C.google-one-tap-modal-div%2C%23amp_floatingAdDiv%2C%23ez-content-blocker-container%2C%23notify-adblock%7Bdisplay%3Anone!important%3Bmin-height%3A0!important%3Bheight%3A0!important%3B%7D" rel="stylesheet" type="text/css"></head>	

<body class="firefox firefox116"><div class="cc-revoke cc-bottom cc-animate cc-color-override--316233370" style="display: none;">Cookie Policy</div><div role="dialog" aria-live="polite" aria-label="cookieconsent" aria-describedby="cookieconsent:desc" class="cc-window cc-banner cc-type-opt-in-out cc-theme-edgeless cc-bottom cc-color-override--316233370 " style=""><!--googleoff: all--><span id="cookieconsent:desc" class="cc-message">Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href="https://www.codeproject.com/info/cookie.aspx">Cookie Policy</a>, <a href="https://www.codeproject.com/info/privacy.aspx">Privacy Policy</a>, and our <a href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Service</a>. <a aria-label="learn more about cookies" role="button" tabindex="0" class="cc-link" href="https://www.codeproject.com/info/privacy.aspx" rel="noopener noreferrer nofollow" target="_blank">Learn more</a></span><div class="cc-compliance cc-highlight"><a aria-label="dismiss cookie message" role="button" tabindex="0" class="cc-btn cc-dismiss">Ask me later</a><a aria-label="deny cookies" role="button" tabindex="0" class="cc-btn cc-deny">Decline</a><a aria-label="allow cookies" role="button" tabindex="0" class="cc-btn cc-allow">Allow cookies</a></div><!--googleon: all--></div>

	<div id="ctl00_OneTap_OneTap">
    <div id="g_id_onload" data-client_id="857795997829.apps.googleusercontent.com" data-login_uri="/script/Membership/OAuthLogOn.aspx?auth=Google">
    </div>
</div>



	<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">15,723,417 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17038%2fCOM-in-plain-C-part-8"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17038%2fCOM-in-plain-C-part-8"
				document.signinForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin">
				<a data-micromodal-trigger="modal-1" href="javascript:;">Sign in</a>
				<!--<a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17038%2fCOM-in-plain-C-part-8">Sign in</a>-->

				<div class="micromodal" id="modal-1" aria-hidden="true">

					<div class="modal__overlay" tabindex="-1" data-micromodal-close="">
					  <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">

						<header class="modal_header">
							<h4 class="modal_title" id="modal-1-title">
								Sign in
							</h4>
							<button class="modal_close" aria-label="Close modal" data-micromodal-close=""></button>
						</header>

						<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17038%2fCOM-in-plain-C-part-8" method="post" class="tight align-left">

							
							<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

							<div>Email</div>
							<div><input type="email" name="Email" id="Email" autocomplete="email" data-ddg-inputtype="credentials.username"></div>
							<div>Password</div>
							<div><input type="password" name="Password" id="Password" autocomplete="current-password" data-ddg-inputtype="credentials.password"></div>
							<div class="action">
								<input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
								<input type="hidden" name="fld_quicksign" value="true">
								<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
							</div>

							<div class="container">						
								<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Articles/17038/COM-in-plain-C-part-8">Forgot your password?</a>
							</div>
						</form>

						<hr class="divider-dark">

						Sign in with &nbsp;<a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/octicons_github-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/facebook-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/google-plus-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/microsoft-lg.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>



					  </div>
					</div>
				  </div>

            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesC" data-country="US" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=822724"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=822724"  width="728px" height="90px" target="_blank"/></a></noscript><iframe id="dm-gpt-iframe-1" width="728" height="90" marginwidth="0" marginheight="0" frameborder="0" scrolling="no"></iframe></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar flex-container flex-extend flex-wrap fixed">
		<div class="flex-item" style="min-width:20rem">
			

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Browse Topics<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/write13.png" width="13" height="13"> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="https://www.codeproject.com/script/Articles/ImportArticle.aspx">
			<img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/write13.png" width="13" height="13"> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/write13.png" width="13" height="13"> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/write13.png" width="13" height="13"> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=268" style="padding-left:30px">View Python questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=91" style="padding-left:30px">View Java questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_CodeProjectAI" class="fly" href="https://www.codeproject.com/Feature/CodeProjectAI-Discussions.aspx">CodeProject.AI Server</a></li>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1969389/Artificial-Intelligence">Artificial Intelligence</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1969388/Internet-of-Things">Internet of Things</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1988311/Python">Python</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/WPF">WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">features</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_SiteBlog" class="fly break" href="https://www.codeproject.com/Members/CodeProject#_comments">The CodeProject Blog</a></li>

		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="https://www.codeproject.com/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
		</div>
		<div class="flex-item-tight align-right">
			

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search subdue" id="sb_tb" autocomplete="off" value="Search for articles, questions, tips" name="q" data-ddg-inputtype="unknown"></td><td><input type="image" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
		</div>
		<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=Languages">Programming Languages</a> / <a rel="nofollow" href="https://www.codeproject.com/script/Content/Tag.aspx?tags=C">C</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?display=Print" class="tooltip" title="">
   <img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner sticky">

                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=17038">Browse Code</a></div>
<div><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=17038">View Stats</a></div>
<div><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=17038">Revisions</a></div>
<div><a href="#_comments">Comments (15)</a></div>
<div>Posted 5 Jan 2007</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/VC6" data-id="4">VC6</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C" data-id="80">C</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Visual-Studio" data-id="103">Visual-Studio</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/COM" data-id="130">COM</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>111.6K views</div><div>2.4K downloads</div><div>109 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="mAvnLmIm0CXreWDKPPi9Ktu7MLwWSJUWt/yPOyRWeNxU9vw54JDaQR0TvDMPRzWkyo5cOHqk3Ign1zui/lh/5zeo1xlCd22kCpMsj7JjOyFcuoD1yRVCqf8EdLiZBraMrO1r9fmgJ7itaKQAMon/JKqp+ra51SHhZbmKkXPuKfk4FLcziVFSAovU9pdBx66dPrTzTvgm5G+DSDxauAGDGWZBQiuTF/gyI2O/foHDvtmG6Y+U5AAx2liDsKFzw6gN2HqyDp6849Jd3vUjcCTJeeLAmXbu2KWDjIrN87J795n+IcznHf9zgv5cmx2pTVv7EGHN7BIu/uNNdKOV6qfP10bV2iaqGFlMa45wQHKJd2ov186QL1zr3rDzYlge13oXR3ZKxTC9ZY0JS/xy016RlF/Id92VtJNXYKOP8fp2fgEt36vGiqwGHeyJ0jcAiSec5jLg73K9VjV78L657IM639TYce1N/MKoc8BRkQINo4mleZGSnOQs66eQSmJy1LWREejpDWNY4Iun7XvkDeZYTOn6p1n0Xn0ohc6KV+/yznAytGr+sE5A03P8DrRrt+NqBjm8KV+C7EWbjQKrzdPLp3V6Q4nKeW2qqzAZT/5DB0EX8ldBqmRSwfbxkPPoqRr8FUeu0ZGLG3qQjcEBMxKgx4uiQP9Hq3lnilQjCMxjui1y7oXjPA+6hjKLtbOEfpYhhUWHT4JiCKTINc+9VmHxxileoKj30DIwO/7TABuXNG75o3Sd2xTthTusDMvo3aIepaO/BOlg2aFwpa+0CpniRSpx25pPbgiki3wAZzaSi/kYyMdQBkBCHAsVMIXY9+CxuU6oRG2Mc471V5D4na1dqgmWrGWpD5iPhU4z09US1W7A3ixosIpSwKRbIxic8uBVDqcbD6jM89xDU5QF0HTlz62KcqA9ivgW7YSS9hmHSPdD/rJODtL52OaXQ7EEytKwsU/0TmQdJKCnz08b2UNDQRWNY6Za8orJX8IZ8NkWdhJZYoIIH52Z0TZ5O03nIcAf5u++3YXTyoujA6mp9Xtuyr4jeXeTguuBf8WLcQu+JhODkrJCnOXp/gJFI1Htq7wiFPhAUMyA/2jmK2Jmt4kC8kLjofGjQDUS65C8UL4AZRIBgSWaeuEl//iweHx9NRYIYuDwOtgk0y+2GzbCVunYq0U5ivmxC2+2maLKw7i+cB6YsaRM05OyI4wEgAl7WumatQT1Xftch3IQFIU/1dh2g4/4R5R6Ng8rCt50BUenrZWfdeyolY/+40EIpqEPgzLDc2byL39acltEddGu6fR6EmEJ/6S7GX1LEauCzU+2ejtTr9o5Cm2m79GquShyoARSQSZwaVXIT9rvPn0FP43T6o2IdTSxssw/Pw4Iwn6SiU1BwaHARb4Ax0T2ZHqWgR/njHGQx7Ei5e+thK59a2+Tm5kdHyHI8Zxu8eaTSqHg5JMz29yEhMEMnVcqcJwKgvDQPA2oSOG3nourJKNTA0zdDuwu81ZFTKQTR1fOWFU5qwi1ATf9AAIxLatWxfo2vCZgjnPiV5dlT4HKWLZXQAYWSR5ghTNti6Um7KbVPsC9kKYpo8qTA4H5JxKjOWxl+R5kvymxcF/mNoWxfVWZANgsp55/SpQCPiPlCjm8PAGZGbSQ70AfTfgQEfYOGke8OSbN741S9Uh0Gh98QqCBA7Ws2FXFw/t2WNvha5rqSCFNOZ7P40GZo7s4q5lOFAmQIM4QH0Y9Zj5Lzf71A5pDMRDXKDSU/EY=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">COM in plain C, part 8</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625" rel="author">Jeff Glatt</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_17038_1">

	<meta itemprop="upvoteCount" content="22">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:20px;" class="clipped"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/star-fill-lg.png" style="width:24px;height:24px"></div><div style="width:4px;position:relative" class="clipped"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17038%2fCOM-in-plain-C-part-8">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.85/5  (22 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">29 Mar 2007</span><span id="ctl00_ReadingTime" class="stats flex-item-tight">13 min read</span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Miscellaneous Script Host details</div><span id="ctl00_ThumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/COM/com_in_c8/com_in_c8_src.zip">Download source files - 419 Kb</a> </li></ul>

<h2>Contents</h2>
<ul>
<li><a href="#INTRO">Persistent script code</a>
</li><li><a href="#ITEM">Script code and "Named Items"</a>
</li><li><a href="#CALL">Call a particular function in a script</a> 
</li><li><a href="#VAR">Query/set a variable in a script</a> 
</li><li><a href="#MULTI">Interfacing different languages</a>
</li></ul>

<h2><a name="INTRO">Introduction</a></h2>

<p>In the preceding chapters, we learned how to create an ActiveX Script
 Host. Although those chapters covered the most important aspects of 
writing a script host, there are some additional, more esoteric features
 that your script host may want to utilize. This chapter will detail 
some of those more esoteric features.</p>

<h2><a name="MACRO">Persistent script code</a></h2>

<p>In our previous Script Host examples, we had a <code>runScript</code>
 function that opened the script engine, ran a script, and then closed 
down the engine. With this approach, the script got loaded/parsed, run, 
and then unloaded (after it was done running). 
</p>
<p>But there may be times when you'd like to add some scripts to the 
engine, and then leave them added to the engine even when those scripts 
are not running. Perhaps you'd like these scripts to be callable by any 
other script you run with that same engine's IActiveScript. In essence, 
maybe you'd like to treat these scripts like a collection of "ram-based 
macros". ActiveX Script Engines make this possible. But we have to alter
 our approach in two ways: 
</p><ol>
<li>When we add a script as a "macro", we need to specify the SCRIPTTEXT_ISPERSISTENT flag to <code>ParseScriptText</code>.
 This tells the engine that the script is to remain internally 
parsed/loaded inside of the script engine, even after ParseScriptText 
returns. 

</li><li>We can't Release the engine's IActiveScript object until we're 
all done using our macros. At this point, those macros are finally 
unloaded. </li></ol>

<p>The best approach to take is to add these macros while the engine is 
in its INITIALIZED state, but before set into its STARTED or CONNECTED 
states. <code>ParseScriptText</code> will not attempt to run the 
scripts. Instead, the scripts will be parsed for proper syntax, 
internally added to the script's engine, and remain there as <code>ParseScriptText</code>
 returns immediately. The scripts will remain in the engine even after 
called by another script, or run via any other mechanism, until such 
time as we finally release the engine's <code>IActiveScript</code> object. 
</p><p>In the directory <strong>ScriptHost7</strong>, you'll find an example to illustrate this point. We'll be adding a VB script to the engine, and specifying the <code>SCRIPTTEXT_ISPERSISTENT</code> flag. To keep things simple, this VB script will be embedded as global data in our EXE as so: 
</p>

<div class="pre-lang" id="premain549788"><div>C++</div><div class="pre-action-link"><span id="copycode549788" class="copy-code" data-index="549788" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre549788" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">wchar_t</span> VBmacro[] = L<span class="code-string">"</span><span class="code-string">Sub HelloWorld\r\nMsgBox \"Hello world\"\r\nEnd Sub"</span>;</pre>

<p>All we have above is a VB subroutine named HelloWorld. It simply displays a message box. 
</p><p>Next, we'll embed a second VB script. This VB script will simply call the first script's HelloWorld subroutine: 
</p><div class="pre-lang" id="premain461008"><div>C++</div><div class="pre-action-link"><span id="copycode461008" class="copy-code" data-index="461008" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre461008" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">wchar_t</span> VBscript[] = L<span class="code-string">"</span><span class="code-string">HelloWorld"</span>;</pre>
<p>When we add this second script to the engine, we won't specify the SCRIPTTEXT_ISPERSISTENT flag. 
</p><p>To make persistent scripts work, we need our <code>runScript</code>
 thread to keep the VB engine's IActiveScript around until our program 
terminates. To achieve this, we'll start this thread at the beginning of
 our program (instead of starting the thread only when it's time to run a
 script). This thread will remain alive until our program ends. 
Initially, the thread will call <code>CoCreateInstance</code> to get the VB engine's IActiveScript, then call its QueryInterface to get the engine's IActiveScriptParse, then call <code>InitNew</code> to initialize the engine, and finally call <code>SetScriptSite</code> to give the engine our IActiveScriptSite. This initialization is the same as our preceding host examples. 
</p><p>Then runScript will call <code>ParseScriptText</code> to add our "VB macro" to the engine. This is almost exactly like preceding example, except we specify SCRIPTTEXT_ISPERSISTENT: 
</p><div class="pre-lang" id="premain12156"><div>C++</div><div class="pre-action-link"><span id="copycode12156" class="copy-code" data-index="12156" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre12156" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">activeScriptParse-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>ParseScriptText(activeScriptParse, &amp;VBmacro[<span class="code-digit">0</span>],
    <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, SCRIPTTEXT_ISPERSISTENT, <span class="code-digit">0</span>, <span class="code-digit">0</span>);</pre>
<p>After adding this script, the runScript thread now waits for the main
 thread to tell it to go ahead and run the second script (which will 
call this script we just loaded). The thread waits on an event signal 
we've created. 
</p><p>The main window has a "Run Script" button. When the user clicks upon this, the main thread sets this event signal: 
</p><div class="pre-lang" id="premain924100"><div>C++</div><div class="pre-action-link"><span id="copycode924100" class="copy-code" data-index="924100" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre924100" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// Let the script thread know that we want it to run a script
</span>SetEvent(NotifySignal[<span class="code-digit">0</span>]);</pre>
<p>runThread wakes up and calls <code>ParseScriptText</code> to add the second script, and then sets the VB engine state to SCRIPTSTATE_CONNECTED via a call to <code>SetScriptState</code>.
 This will run the second script, which will call the HelloWorld sub in 
the macro script to pop up a message box. After the user dismisses this 
box, then the first script ends and <code>SetScriptState</code> returns. 
</p><p>At this point, we do not Release the IActiveScriptParse and IActiveScript, and close the engine. Instead, we simply call <code>SetScriptState</code>
 again to set the VB engine's state to SCRIPTSTATE_INITIALIZED. This 
causes the second script to be unloaded. But the macro script is not 
unloaded, because it is persistent. 
</p><p>runThread goes back to sleep, waiting for the user to click the 
"Run Script" button again. In this event, runThread repeats the process 
of adding/running the second script. But note that there is no need to 
re-add the macro script. It is still loaded in the engine. 
</p><p>Here's the "script loop" in runThread: 
</p><div class="pre-lang" id="premain17663"><div>C++</div><div class="pre-action-link"><span id="copycode17663" class="copy-code" data-index="17663" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre17663" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">for</span> (;;)
{
   <span class="code-comment">// Wait for main thread to signal us to run a script.
</span>   WaitForSingleObject(NotifySignal, INFINITE);

   <span class="code-comment">// Have the script engine parse our second script and add it to
</span>   <span class="code-comment">// the internal list of scripts to run. NOTE: We do NOT specify
</span>   <span class="code-comment">// SCRIPTTEXT_ISPERSISTENT so this script will be unloaded
</span>   <span class="code-comment">// when the engine goes back to INITIALIZED state.
</span>   activeScriptParse-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>ParseScriptText(activeScriptParse,
      &amp;VBscript[<span class="code-digit">0</span>], <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);

   <span class="code-comment">// Run all of the scripts that we added to the engine.
</span>   EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>SetScriptState(EngineActiveScript,
      SCRIPTSTATE_CONNECTED);

   <span class="code-comment">// The above script has ended after SetScriptState returns. Now
</span>   <span class="code-comment">// let's set the engine state back to initialized to unload this
</span>   <span class="code-comment">// script. VBmacro[] remains still loaded.
</span>   EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>SetScriptState(EngineActiveScript,
      SCRIPTSTATE_INITIALIZED);
}</pre>

<h2><a name="ITEM">Script code and "Named Items"</a></h2>

<p>In the above example, we added the macro script to the same "named 
item" as the second script. (Note: We didn't specify any particular 
named item, so the engine used its default "global item"). But it's 
possible to load scripts under different "named items". 
</p><p>In the preceding chapter, you'll recall that we made it possible 
for a script to call our own C functions by creating a named item (via 
the engine IActiveScript's <code>AddNamedItem</code>). The script used this item's name to call our C functions. 
</p><p>But that's not the only use of a named item. We can also group 
scripts under named items we create, and that's what we'll examine now. 
</p><p>Consider that we have two C source files named <em>File1.c</em> and <em>File2.c</em>. Here is the contents of <em>File1.c</em>: 
</p><div class="pre-lang" id="premain230493"><div>C++</div><div class="pre-action-link"><span id="copycode230493" class="copy-code" data-index="230493" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre230493" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// File1.c
</span><span class="code-keyword">static</span> <span class="code-keyword">void</span> MyFunction(<span class="code-keyword">void</span>)
{
   printf(<span class="code-string">"</span><span class="code-string">File1.c"</span>);
}

<span class="code-keyword">static</span> <span class="code-keyword">void</span> File1(<span class="code-keyword">void</span>)
{
   MyFunction();
}</pre>Here is the contents of <em>File2.c</em>: <div class="pre-lang" id="premain457636"><div></div><div class="pre-action-link"><span id="copycode457636" class="copy-code" data-index="457636" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre457636" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> File2.c</span>
<span class="code-keyword">static</span> <span class="code-keyword">void</span> MyFunction(<span class="code-keyword">const</span> <span class="code-keyword">char</span> *ptr)
{
   printf(ptr);
}

<span class="code-keyword">static</span> <span class="code-keyword">void</span> File2(<span class="code-keyword">void</span>)
{
   MyFunction(<span class="code-string">"</span><span class="code-string">File1.c"</span>);
}</pre>
<p>There are a few things to note above. 
</p><ol>
<li>Due to the static keywords, <code>MyFunction</code> in <em>File1.c</em> is not the same as <code>MyFunction</code> in <em>File2.c</em>. We can compile and link these two source files together and not have any problem (ie, there is no name conflict). 

</li><li>Due to the static keywords, the functions in <em>File1.c</em> cannot call the functions in <em>File2.c</em>, and vice versa.</li></ol>
<p>When we create a named item (into which we'll load script code), 
think of it as creating a C source file. To create a named item, we call
 the engine IActiveScipt's <code>AddNamedItem</code>. Let's assume we 
have a script engine that implements the C language. First of all, we 
need to call AddNamedItem twice. The first time, we create a named item 
with the name <em>File1.c</em>. The second time we'll create a named item with the name <em>File2.c</em>. This creates the two "source files" in the engine. Then we'll call <code>ParseScriptText</code> to add the contents of <em>File1.c</em> to the <em>File1.c</em> named item. To do this, we must pass the name of the item as the third arg to ParseScriptText. Then, we'll add the contents of <em>File2.c</em> to the <em>File2.c</em> named item. Here is how we do this: 
</p><div class="pre-lang" id="premain305237"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="305237" id="preShrink305237">Shrink ▲</span> &nbsp; <span id="copycode305237" class="copy-code" data-index="305237" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre305237" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// Here's the contents of File1.c
</span><span class="code-keyword">wchar_t</span> File1[] = L<span class="code-string">"</span><span class="code-string">static void MyFunction(void)\r\n\
{\r\n\
   printf(\"File1.c\");\r\n\
}\r\n\r\n\
static void File1(void)\r\n\
{\r\n\
   MyFunction();\r\n\
}"</span>;

<span class="code-comment">// Here's the contents of File2.c
</span><span class="code-keyword">wchar_t</span> File1[] = L<span class="code-string">"</span><span class="code-string">static void MyFunction(const char *ptr)\r\n\
{\r\n\
   printf(ptr);\r\n\
}\r\n\r\n\
static void File2(void)\r\n\
{\r\n\
   MyFunction(\"File1.c\");\r\n\
}"</span>;

<span class="code-comment">// Create the File1.c named item. Error-checking omitted!
</span>EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>AddNamedItem(EngineActiveScript, <span class="code-string">"</span><span class="code-string">File1.c"</span>, <span class="code-digit">0</span>);

<span class="code-comment">// Create the File2.c named item.
</span>EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>AddNamedItem(EngineActiveScript, <span class="code-string">"</span><span class="code-string">File2.c"</span>, <span class="code-digit">0</span>);

<span class="code-comment">// Add the File1.c contents to the File1.c named object
</span>activeScriptParse-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>ParseScriptText(activeScriptParse, &amp;File1[<span class="code-digit">0</span>],
    <span class="code-string">"</span><span class="code-string">File1.c"</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);

<span class="code-comment">// Add the File2.c contents to the File2.c named object
</span>activeScriptParse-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>ParseScriptText(activeScriptParse, &amp;File2[<span class="code-digit">0</span>],
    <span class="code-string">"</span><span class="code-string">File2.c"</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);</pre>
<p>Now let's take our VB "macro script" and put it in a named item we'll
 create. We'll arbitrarily give this item a name of MyMacro. Here's what
 we do in runScript: 
</p><div class="pre-lang" id="premain763053"><div></div><div class="pre-action-link"><span id="copycode763053" class="copy-code" data-index="763053" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre763053" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate"><span class="code-comment">//</span><span class="code-comment"> The name of the named item</span>
wchar_t MyMacroObjectName[] = L<span class="code-string">"</span><span class="code-string">MyMacro"</span>;

<span class="code-comment">//</span><span class="code-comment"> Create the MyMacro named item</span>
EngineActiveScript-&gt;lpVtbl-&gt;AddNamedItem(EngineActiveScript, 
    &amp;MyMacroObjectName[0],    

SCRIPTITEM_ISVISIBLE|SCRIPTITEM_ISPERSISTENT);

<span class="code-comment">//</span><span class="code-comment"> Add the contents of VBmacro to the MyMacro named item</span>
activeScriptParse-&gt;lpVtbl-&gt;ParseScriptText(activeScriptParse, &amp;VBmacro[0],
   &amp;MyMacroObjectName[0], <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>, 
    SCRIPTITEM_ISVISIBLE|SCRIPTTEXT_ISPERSISTENT, <span class="code-digit">0</span>, <span class="code-digit">0</span>);</pre>

<p>You'll notice that we pass a few flags to AddNamedItem. We specify <code>SCRIPTITEM_ISPERSISTENT</code>
 because we don't want the engine to delete this named item (and its 
contents) when we reset the engine state to INITIALIZED. We also specify
 <code>SCRIPTITEM_ISVISIBLE</code> because we want this named item to be
 accessible from the default global item (which is where the second 
script gets added). Specifying <code>SCRIPTITEM_ISVISIBLE</code> is 
tantamount to removing the static keyword on our functions in that C 
language engine example. It allows a named item's functions to be 
callable by another named item's functions. Without <code>SCRIPTITEM_ISVISIBLE</code>, a named item's functions may call themselves, but not be called by any other named item's functions. 
</p><p>We have to modify the second VB script. Now it needs to reference
 the named item when it calls the HelloWorld subroutine. In VBscript, 
this is accomplished by using the name as if it's an object: 
</p><div class="pre-lang" id="premain570389"><div>C++</div><div class="pre-action-link"><span id="copycode570389" class="copy-code" data-index="570389" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre570389" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">wchar_t</span> VBscript[] = L<span class="code-string">"</span><span class="code-string">MyMacro.HelloWorld"</span>;</pre>

<p>There is one more thing to do. When we call AddNamedItem to create 
"MyMacro", the engine is going to call our IActiveScriptSite's <code>GetItemInfo</code>,
 passing the name "MyMacro". We need to obtain and return an IDispatch 
pointer for this named item. Where do we get that? We get it by calling 
the engine IActiveScript's <code>GetScriptDispatch</code>, passing the item name. Here then is our IActiveScriptSite's <code>GetItemInfo</code>: 
</p><div class="pre-lang" id="premain897543"><div>C++</div><div class="pre-action-link"><span id="copycode897543" class="copy-code" data-index="897543" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre897543" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">STDMETHODIMP GetItemInfo(MyRealIActiveScriptSite *<span class="code-keyword">this</span>, LPCOLESTR
   objectName, DWORD dwReturnMask, IUnknown **objPtr, ITypeInfo **typeInfo)
{
   <span class="code-keyword">if</span> (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN) *objPtr = <span class="code-digit">0</span>;
   <span class="code-keyword">if</span> (dwReturnMask &amp; SCRIPTINFO_ITYPEINFO) *typeInfo = <span class="code-digit">0</span>;

   <span class="code-comment">// We assume that the named item the engine is asking for is our
</span>   <span class="code-comment">// "MyMacro" named item we created. We need to return the
</span>   <span class="code-comment">// IDispatch for this named item. Where do we get it? From the engine.
</span>   <span class="code-comment">// Specifically, we call the engine IActiveScript's GetScriptDispatch(),
</span>   <span class="code-comment">// passing objectName (which should be "MyMacro").
</span>   <span class="code-keyword">if</span> (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN)
      <span class="code-keyword">return</span>(EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>GetScriptDispatch(
          EngineActiveScript, objectName, objPtr));
   <span class="code-keyword">return</span>(E_FAIL);
}</pre>

<p>With the above minor modifications, we have now used a named item for
 our macro script. What is the benefit of this? First of all, our second
 script can now have a HelloWorld subroutine inside it, and this will 
not conflict with MyMacro's HelloWorld. So, we've now eliminated the 
possibility of any sub/function name conflicts between our macro script 
and the second script. Furthermore, if we had more macro scripts, we 
could put each one in its own named item. In this way, each macro script
 can have similarly named subs/functions, and again there is no conflict
 between any of the macro scripts. The VB engine knows which 
sub/function is being called because the object name used in the call 
indicates which named item holds the sub/function. 
</p><p>In conclusion, using named items is a way to prevent possible 
sub/function name conflicts in script code you add to a particular 
engine. 
</p>
<h2><a name="CALL">Call</a> a particular function in a script</h2>

<p>In the above example, we called the engine's <code>GetScriptDispatch</code> to retrieve an IDispatch to a particular named item. We simply returned this to the engine. 
</p><p>But we could also use that IDispatch ourselves to directly call a
 particular VB sub/function (in a particular named item). To call the 
sub/function, we call that IDispatch's <code>GetIDsOfNames</code> and <code>Invoke</code> functions. This will be much like what we did in <strong>IExampleApp3</strong>
 when we used an IDispatch's Invoke to call some function in a COM 
object. You may wish to peruse that example again to refresh your 
memory. Let's say that we wish to directly call the HelloWorld sub in 
the MyMacros named object. First we need to get the IDispatch for that 
named object, which we do by calling the engine IActiveScript's <code>GetScriptDispatch</code>. Then we call that IDispatch's <code>GetIDsOfNames</code> to get the <code>DISPID</code>
 (ie, unique number) that the engine has assigned to the function we 
want to call. Finally, we use this DISPID with the IDispatch's <code>Invoke</code> to directly call the function.
</p><div class="pre-lang" id="premain732007"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="732007" id="preShrink732007">Shrink ▲</span> &nbsp; <span id="copycode732007" class="copy-code" data-index="732007" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre732007" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// NOTE: Error-checking omitted!
</span>IDispatch  
*objPtr;
DISPID     dispid;
OLECHAR    
*funcName;
DISPPARAMS dspp;
VARIANT    ret;

<span class="code-comment">// Get the IDispatch for "MyMacro" named item
</span>EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>GetScriptDispatch(EngineActiveScript,
   
<span class="code-string">"</span><span class="code-string">MyMacro"</span>, &amp;objPtr);

<span class="code-comment">// Now get the DISPID for the "HelloWorld" sub
</span>funcName = (OLECHAR 
*)L<span class="code-string">"</span><span class="code-string">HelloWorld"</span>;
objPtr-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>GetIDsOfNames(objPtr, &amp;IID_NULL, 
&amp;funcName, <span class="code-digit">1</span>,
   LOCALE_USER_DEFAULT, &amp;dispid);

<span class="code-comment">// Call HelloWorld.
</span><span class="code-comment">// Since HelloWorld has no args passed to it, we don't have to do
</span><span class="code-comment">// any grotesque initialization of DISPPARAMS.
</span>ZeroMemory(&amp;dspp, 
<span class="code-keyword">sizeof</span>(DISPPARAMS));
VariantInit(&amp;ret);
objPtr-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>Invoke(objPtr, 
dispid, &amp;IID_NULL, LOCALE_USER_DEFAULT,
  DISPATCH_METHOD, 
&amp;dspp, &amp;ret, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
VariantClear(&amp;ret);

<span class="code-comment">// Release the IDispatch now that we made the call
</span>objPtr-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>Release(objPtr);</pre>

<p>In the directory <strong>ScriptHost8</strong> is an example that adds the following VB script (containing a main subroutine) to the VB engine: </p>

<div class="pre-lang" id="premain541760"><div>C++</div><div class="pre-action-link"><span id="copycode541760" class="copy-code" data-index="541760" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre541760" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-keyword">wchar_t</span> VBscript[] = L<span class="code-string">"</span><span class="code-string">Sub main\r\nMsgBox \"Hello world\"\r\nEnd Sub"</span>;</pre>

<p>Then we directly call this main routine. One thing you'll notice is 
that we don't create/specify any particular named item when we call <code>ParseScriptText</code>.
 This causes the script code to be added to the default "global named 
item". And so we need to fetch the IDispatch for this global named item.
 How do we do that? We pass a 0 to GetScriptDispatch for the name. This 
is a special value that tells GetScriptDispatch to return the global 
named item's IDispatch.</p>
 
<h2><a name="VAR">Query/Set</a> a variable in a script</h2>

<p>To query or set the value of a particular variable (in a particular 
named item), we do almost exactly the same as above. The only difference
 is that, in the call to Invoke, we specify the <code>DISPATCH_PROPERTYGET</code> flag if querying the value, or the <code>DISPATCH_PROPERTYPUT</code> if setting the value. Here then is an example of setting a variable named "MyVariable" within the "MyMacro" named item: </p>

<div class="pre-lang" id="premain929994"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="929994" id="preShrink929994">Shrink ▲</span> &nbsp; <span id="copycode929994" class="copy-code" data-index="929994" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre929994" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true"><span class="code-comment">// NOTE: Error-checking omitted!
</span>IDispatch  *objPtr;
DISPID     dispid, dispPropPut;
OLECHAR    *varName;
DISPPARAMS dspp;
VARIANT    arg;

<span class="code-comment">// Get the IDispatch for "MyMacro" named item
</span>EngineActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>GetScriptDispatch(EngineActiveScript,
   <span class="code-string">"</span><span class="code-string">MyMacro"</span>, &amp;objPtr);

<span class="code-comment">// Now get the DISPID for the "MyVariable" variable (ie, property)
</span>varName = (OLECHAR *)L<span class="code-string">"</span><span class="code-string">MyVariable"</span>;
objPtr-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>GetIDsOfNames(objPtr, &amp;IID_NULL, &amp;varName, <span class="code-digit">1</span>,
   LOCALE_USER_DEFAULT, &amp;dispid);

<span class="code-comment">// Set the value to 10.
</span>VariantInit(&amp;arg);
ZeroMemory(&amp;dspp, <span class="code-keyword">sizeof</span>(DISPPARAMS));
dspp.cArgs = dspp.cNamedArgs = <span class="code-digit">1</span>;
dispPropPut = DISPID_PROPERTYPUT;
dspp.rgdispidNamedArgs = &amp;dispPropPut;
dspp.rgvarg = &amp;arg;
arg.vt = VT_I4;
arg.lVal = <span class="code-digit">10</span>;
objPtr-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>Invoke(objPtr, dispid, &amp;IID_NULL, LOCALE_USER_DEFAULT,
  DISPATCH_PROPERTYPUT, &amp;dspp, <span class="code-digit">0</span>, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
VariantClear(&amp;arg);

<span class="code-comment">// Release the IDispatch now that we made the call
</span>objPtr-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>Release(objPtr);</pre>
<p>In the directory <strong>ScriptHost9</strong> is an example where we set the value of MyVariable and then call the main sub which displays this variable. </p>
<h2><a name="MULTI">Interfacing different languages</a></h2>
<p>It's possible to have a script written in one language call a script 
written in another language. For example, let's assume we have the 
following VBScript function that displays a message box: </p><div class="pre-lang" id="premain173299"><div></div><div class="pre-action-link"><span id="copycode173299" class="copy-code" data-index="173299" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre173299" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">Sub SayHello
   MsgBox <span class="code-string">"</span><span class="code-string">Hello World"</span>
End Sub</pre>
<p>And let's assume we have the following JScript function that calls the above VBScript function: </p><div class="pre-lang" id="premain717369"><div></div><div class="pre-action-link"><span id="copycode717369" class="copy-code" data-index="717369" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre717369" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">function main()
{
   SayHello();
}</pre>

<p>First of all, because we're going to be using scripts in two different languages, JScript and VBScript, then we need to call <code>CoCreateInstance</code>
 twice; once to get the JScript engine's IActiveScript, and once to get 
the VBScript engine's IActiveScript. Of course, we'll store those two 
pointers in two separate variables (<code>JActiveScript</code> and <code>VBActiveScript</code> respectively). 
</p><p>We also need to get the IActiveScriptParse for each engine. And we need to call each engine's <code>SetScriptSite</code>
 to give it our IActivesScriptSite. (We could use a separate 
IActivesScriptSite for each engine, but our purposes, we'll use the same
 one for both engines since we won't be simultaneously running scripts 
in both languages. Rather, the VB engine is going to be running a script
 only when the JScript engine calls into that VBScript function). 
</p>

<p>In other words, <code>runScript</code> has to do all of the initialization that we must do to use a script engine, but do it once for each engine. 
</p><p>Then, we have to call the JScript engine's <code>ParseScriptText</code> to add the above JScript code to the JScript engine, and call the VBScript engine's <code>ParseScriptText</code> to add the above VBScript code to the VBScript engine. We'll add the code to the respective engine's global named item. 
</p>

<p>To facilitate the JScript calling a VBScript, we need to create a 
named object in the JScript engine that we'll associate with the 
VBScript engine. We do this before we add the scripts to their engines. 
Let's arbitrarily give this item a name of "VB". </p>

<div class="pre-lang" id="premain621096"><div>C++</div><div class="pre-action-link"><span id="copycode621096" class="copy-code" data-index="621096" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre621096" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">JActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>AddNamedItem(JActiveScript, L<span class="code-string">"</span><span class="code-string">VB"</span>,
   SCRIPTITEM_GLOBALMEMBERS|SCRIPTITEM_ISVISIBLE);</pre>

<p>Let's examine what happens when the JScript engine runs our JScript 
code above. The engine looks through all its JScript functions that 
we've loaded into the JScript engine. It sees that there is no JScript 
function named "SayHello". Since we've added some named item to the 
JScript engine (with the <code>ISVISIBLE</code> flag), the engine says 
to itself, "Hmmm. Maybe this SayHello function is inside of this named 
item. I need to get an IDispatch for this named item so I can call its 
GetIDsOfNames function, asking for a SayHello <code>DISPID</code>. If that IDispatch successfully gives me that DISPID, then I can call that IDispatch's Invoke to call that SayHello function." 
</p>

<p>And how does an engine get an IDispatch for a named item? By now, you should know that it calls our IActiveScriptSite's <code>GetItemInfo</code>.
 In this case, the JScript engine is going to pass an item name of "VB".
 Here's where it may seem a little confusing. When our GetItemInfo 
detects that it is being asked for that particular item, we're going to 
call the VBScript engine's <code>GetScriptDispatch</code> to get the VBscript engine's global named item. And that's what we're going to return to the JScript engine. 
</p><p>Yes, you read that correctly. When the JScript engine asks for 
the "VB" named item's IDispatch, we're actually going to return the 
VBScript engine's global named item IDispatch. Why? Because our VBScript
 SayHello function was added to the global named item, not some item 
named "VB". In other words, we're using the "VB" item as a "placeholder"
 in the JScript engine. The JScript engine doesn't need to know that 
it's "VB" item is essentially going to be the VBScript engine's global 
named item. 
</p>

<p>So, the JScript engine will call <code>GetIDsOfNames</code> of the VB engine's global named item IDispatch. And sure enough, the VB engine will return the <code>DISPID</code>
 for its SayHello function. When JScript calls that IDispatch's Invoke, 
it ends up calling into the VB engine to have the VB engine run the VB 
SayHello function. 
</p><p>Here then is our IActiveScriptSite's <code>GetItemInfo</code>: </p>

<div class="pre-lang" id="premain690168"><div>C++</div><div class="pre-action-link"><span class="code-collapse" data-index="690168" id="preShrink690168">Shrink ▲</span> &nbsp; <span id="copycode690168" class="copy-code" data-index="690168" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre690168" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">STDMETHODIMP GetItemInfo(MyRealIActiveScriptSite *<span class="code-keyword">this</span>, LPCOLESTR
   objectName, DWORD dwReturnMask, IUnknown **objPtr, ITypeInfo **typeInfo)
{
   HRESULT    hr;

   hr = E_FAIL;

   <span class="code-keyword">if</span> (dwReturnMask &amp; SCRIPTINFO_ITYPEINFO) *typeInfo = <span class="code-digit">0</span>;

   <span class="code-keyword">if</span> (dwReturnMask &amp; SCRIPTINFO_IUNKNOWN)
   {
      *objPtr = <span class="code-digit">0</span>;

      <span class="code-comment">// If the engine is asking for our "VB" named item we created,
</span>      <span class="code-comment">// then we know this is the JScript engine calling. We need to
</span>      <span class="code-comment">// return the IDispatch for VBScript's "global named item".
</span>      <span class="code-keyword">if</span> (!lstrcmpW(objectName, L<span class="code-string">"</span><span class="code-string">VB"</span>))
      {
         hr = VBActiveScript-<span class="code-keyword">&gt;</span>lpVtbl-<span class="code-keyword">&gt;</span>GetScriptDispatch(VBActiveScript,
            <span class="code-digit">0</span>, objPtr);
      }
   }

   <span class="code-keyword">return</span>(hr);
}</pre>

<p>In the directory <strong>ScriptHost10</strong> is an example of JScript calling VBScript. 
</p><p>Incidentally, you may be wondering about the <code>SCRIPTITEM_GLOBALMEMBERS</code>
 flag. You may recall when we previously dealt with a named item, the 
script had to reference that item's name as if it was an object name, 
for example: </p><div class="pre-lang" id="premain348432"><div>C++</div><div class="pre-action-link"><span id="copycode348432" class="copy-code" data-index="348432" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre348432" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">VB.SayHello()</pre>
<p>When you create an item with the <code>SCRIPTITEM_GLOBALMEMBERS</code> flag, then specifying the object name is optional. For example, either the above call works, or this also works: </p><div class="pre-lang" id="premain974214"><div>C++</div><div class="pre-action-link"><span id="copycode974214" class="copy-code" data-index="974214" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve"><g><path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272     c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729 c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path><path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272 c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001 C291.206,428.715,289.92,430,288.341,430z"></path></g></svg></span></div></div>
<pre id="pre974214" style="margin-top:0;" class="lang-cplusplus notranslate" data-language="c++" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true">SayHello()</pre>
<p>So what we're doing here is making it possible for JScript to call 
SayHello as if it were just another "local" JScript function. In other 
words, it's more or less a notional shortcut that hides the messy 
details of named items. 
</p><p>But there is a price to be paid for this convenience. There may now be name conflicts between any items with <code>SCRIPTITEM_GLOBALMEMBERS</code> flag, as well as the global named item.</p>


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article has no explicit license 
attached to it but may contain usage terms in the article text or the 
download files themselves. If in doubt please contact the author via the
 discussion board below.</p><p>A list of licenses authors might use can be found <a href="https://www.codeproject.com/info/Licenses.aspx">here</a></p></div>
						

						
						<br>
						
						    

<div class="author-wrapper">

    <div class="desktop-only tablet-only" style="position:absolute; top:-30px;right:20px">
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(1deg);">
    </div>

    <div style="padding-right:100px">
        <div class="subdue" style="margin-bottom:7px">Written By</div>

        <div class="container-member">
             <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/Jeff-Glatt">Jeff Glatt</a></b>
        </div>

        <div class="company text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	        <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
        </div>

        <div class="text-nowrap">
            <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/US.gif" alt="United States" width="16" height="11">&nbsp;United States</span>
        </div>
    </div>

</div>

<div class="description" style="padding-top:1rem">
    This member has not yet provided a Biography. Assume it's 
interesting and varied, and probably something to do with programming.
</div>

<div id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_SocialRow" class="follow flex-container flex-extend" style="margin-top:20px">
    <div class="flex-item">
        
    </div>
    <div class="flex-item-tight" style="margin-right:25px">
        
    </div>
</div>

<br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesC" data-country="US" data-loadonview="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5,pos_bottom"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=822724"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=728x90&c=822724"  width="728px" height="90px" target="_blank"/></a></noscript></div>
				</div>
				
                
                

				
				

					<h2 class="padded-top">Comments and Discussions</h2>

                    
			        <div id="ctl00_SharePH" class="share-list float-right desktop-only tablet-only" style="margin-top:-3.5rem">
				        

    <ul class="rrssb-buttons clearfix rrssb-1">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=COM%20in%20plain%20C%2c%20part%208%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aMiscellaneous%20Script%20Host%20details%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f17038%2fCOM-in-plain-C-part-8%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=COM+in+plain+C%2c+part+8+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f17038%2fCOM-in-plain-C-part-8" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                        C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17038%2fCOM-in-plain-C-part-8" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17038%2fCOM-in-plain-C-part-8&amp;title=COM+in+plain+C%2c+part+8+-+CodeProject&amp;summary=Miscellaneous+Script+Host+details&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17038%2fCOM-in-plain-C-part-8&amp;title=COM+in+plain+C%2c+part+8+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                    19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                    C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f17038%2fCOM-in-plain-C-part-8&amp;description=COM+in+plain+C%2c+part+8+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785
                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458
                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557
                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168
                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239
                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"></path>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



			        </div><a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f17038%2fCOM-in-plain-C-part-8%3ffid%3d373296%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="373296"><input type="hidden" name="sbo" value="fm"><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search subdue" autocomplete="off" name="q" value="Search Comments"><input type="image" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/search.gif">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f17038%2fCOM-in-plain-C-part-8" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="373296"><input type="hidden" name="currentQS" value="fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f17038%2fCOM-in-plain-C-part-8"><input type="hidden" name="floc" value="/Articles/17038/COM-in-plain-C-part-8">Spacing<select size="1" class="dropdown" name="spc" data-ddg-inputtype="unknown">
<option selected="selected" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view" data-ddg-inputtype="unknown">
<option selected="selected" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp" data-ddg-inputtype="unknown">
<option value="10">10</option><option selected="selected" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background msg-list">
<tbody><tr id="F3002176_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx3002176xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="3002176" parent="0" thread="3002176" href="https://www.codeproject.com/Messages/3002176/Hey-you-series-of-tutorials-cleared-up-a-lot-of-do">Hey you series of tutorials cleared up a lot of doubts i had, can you write about ActiveX components too</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">samarjit01</span><span class="date">13-Apr-09  5:32</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3213480">samarjit01</a></span></td><td class="date"><span>13-Apr-09  5:32&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3002176_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I have seen the previous chapters, it cleared up many 
doubts i had about COM. Its true that i couldnt understand everything as
 I didn't find enough time to read some of the articles you have 
written. But i am really eager to learn how COM can be extended into 
full fledged ActiveX component.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3002176" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_3002176" name="react-item_3002176" id="MRF3002176" class="reaction-result"></span><span data-objectref="3_3002176" data-votingtype="GoodOrBad" name="RateItem_3002176" id="MVF3002176" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="3002176" href="https://www.codeproject.com/Messages/3002176/Hey-you-series-of-tutorials-cleared-up-a-lot-of-do" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2673902_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx2673902xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="2673902" parent="0" thread="2673902" href="https://www.codeproject.com/Messages/2673902/Activex-for-Web">Activex for Web</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">xfinger</span><span class="date">11-Aug-08  12:09</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203993">xfinger</a></span></td><td class="date"><span>11-Aug-08  12:09&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2673902_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Jeff,<br>
<br>
Any chance you would write/release information on how to <b>draw</b> on a surface in a <b>complete activex for IE</b> in C?<br>
<br>
regards,<br>
xfinger<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2673902" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2673902" name="react-item_2673902" id="MRF2673902" class="reaction-result"></span><span data-objectref="3_2673902" data-votingtype="GoodOrBad" name="RateItem_2673902" id="MVF2673902" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2673902" href="https://www.codeproject.com/Messages/2673902/Activex-for-Web" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2128572_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx2128572xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container"><a class="message-link" name="2128572" parent="0" thread="2128572" href="https://www.codeproject.com/Messages/2128572/Missed-some-chapter">Missed some chapter</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jahanshahi</span><span class="date">13-Jul-07  0:53</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2896030">Jahanshahi</a></span></td><td class="date"><span>13-Jul-07  0:53&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2128572_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I've been following your articles closely up to part 5. 
It seems that I lost some essential parts, namely 6 and 7. How can I get
 them? <br>
<br>
<div class="ForumSig">Mohsen Jahanshahi</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2128572" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2128572" name="react-item_2128572" id="MRF2128572" class="reaction-result"></span><span data-objectref="3_2128572" data-votingtype="GoodOrBad" name="RateItem_2128572" id="MVF2128572" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2128572" href="https://www.codeproject.com/Messages/2128572/Missed-some-chapter" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F2196740_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx2196740xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="2196740" parent="2128572" thread="2128572" href="https://www.codeproject.com/Messages/2196740/Re-Missed-some-chapter">Re: Missed some chapter</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">23-Aug-07  11:01</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>23-Aug-07  11:01&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F2196740_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,2128572);" href="https://www.codeproject.com/Messages/2128572/Missed-some-chapter"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>To view all of my CodeProject articles, go to the top of this page and click on the author's (ie, my) name.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=2128572" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_2196740" name="react-item_2196740" id="MRF2196740" class="reaction-result"></span><span data-objectref="3_2196740" data-votingtype="GoodOrBad" name="RateItem_2196740" id="MVF2196740" class="rating-result"><span>2.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="2196740" href="https://www.codeproject.com/Messages/2196740/Re-Missed-some-chapter" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1966405_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx1966405xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1966405" parent="0" thread="1966405" href="https://www.codeproject.com/Messages/1966405/The-chinese-version">The chinese version</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Black.Stone</span><span class="date">29-Mar-07  15:44</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=55612">Black.Stone</a></span></td><td class="date"><span>29-Mar-07  15:44&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1966405_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I had translated it into chinese.<br>
<br>
Here is the URL:<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!280.entry" rel="nofollow noopener">http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!280.entry</a>[<a href="http://blackstoneex.spaces.live.com/blog/cns!CF847CFBE3E3C6D7!280.entry" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br>
<br>
I had your license at <a href="http://www.codeproject.com/com/com_in_c7.asp?df=100&amp;forumid=329935&amp;select=1617623#xx1617623xx" rel="nofollow noopener">http://www.codeproject.com/com/com_in_c7.asp?df=100&amp;forumid=329935&amp;select=1617623#xx1617623xx</a>[<a href="http://www.codeproject.com/com/com_in_c7.asp?df=100&amp;forumid=329935&amp;select=1617623#xx1617623xx" target="_blank" title="New Window" rel="nofollow noopener">^</a>]<br>
<br>
Thanks again. <br>
<br>
 <br>
<br>
<div class="ForumSig">I'm sorry for my poor english!</div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1966405" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1966405" name="react-item_1966405" id="MRF1966405" class="reaction-result"></span><span data-objectref="3_1966405" data-votingtype="GoodOrBad" name="RateItem_1966405" id="MVF1966405" class="rating-result"><span>2.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1966405" href="https://www.codeproject.com/Messages/1966405/The-chinese-version" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1851880_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx1851880xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1851880" parent="0" thread="1851880" href="https://www.codeproject.com/Messages/1851880/named-items-and-jScript-stack-overflow">named items and jScript - stack overflow !</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">petermaenator</span><span class="date">19-Jan-07  0:07</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2701277">petermaenator</a></span></td><td class="date"><span>19-Jan-07  0:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1851880_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi Jeff - thanks for sharing the knowledge !<br>
<br>
I'm working on project where we use Active scripting from C++ COM.<br>
Your article inspired me to improve the way how we parse and invoke scripts. <br>
I'm trying to put and execute script methods not in global namespace, but in named items - using the mechanism you described in <br>
Script code and "Named Items" section. This way i can encapsulate blocks of script methods so they do not interfere. <br>
<br>
So I <br>
- add new named item to the engine<br>
- in GetItemInfo return engine's dispatch interface for the named item<br>
- parse script into named item<br>
- get named item dispatch and invoke my script<br>
<br>
This works ok for VBScript - but for jScript I'm always get Stack 
overflow when I invoke my script method ! I don't know if this is 
limitation of jScript, or I forgot to set some magic flags somewhere, or
 what ...<br>
  <br>
I'd like to ask if you have any idea what could help here.<br>
<br>
thanks <br>
Peter<br>
<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1851880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1851880" name="react-item_1851880" id="MRF1851880" class="reaction-result"></span><span data-objectref="3_1851880" data-votingtype="GoodOrBad" name="RateItem_1851880" id="MVF1851880" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1851880" href="https://www.codeproject.com/Messages/1851880/named-items-and-jScript-stack-overflow" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1852226_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx1852226xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1852226" parent="1851880" thread="1851880" href="https://www.codeproject.com/Messages/1852226/Re-named-items-and-jScript-stack-overflow">Re: named items and jScript - stack overflow !</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">petermaenator</span><span class="date">19-Jan-07  3:58</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2701277">petermaenator</a></span></td><td class="date"><span>19-Jan-07  3:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1852226_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1851880);" href="https://www.codeproject.com/Messages/1851880/named-items-and-jScript-stack-overflow"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Seems i found the reason of stack overflow issue:<br>
<br>
In GetItemInfo method, when system asks for newly added named item 
dispatch, it is better to return root dispatch of the engine, instead of
 named item's dispatch <br>
<br>
in other words:<br>
<br>
			m_spScript-&gt;GetScriptDispatch( NULL, &amp;spScriptDisp)<br>
<br>
instead of:<br>
<br>
			m_spScript-&gt;GetScriptDispatch( pstrName, &amp;spScriptDisp)<br>
<br>
Perhaps you can update the code snippet in the "Script code and Named Items section".<br>
<br>
Again, thanks for the inspirative article ! <br>
<br><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1851880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1852226" name="react-item_1852226" id="MRF1852226" class="reaction-result"></span><span data-objectref="3_1852226" data-votingtype="GoodOrBad" name="RateItem_1852226" id="MVF1852226" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1852226" href="https://www.codeproject.com/Messages/1852226/Re-named-items-and-jScript-stack-overflow" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889106_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx1889106xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1889106" parent="1852226" thread="1851880" href="https://www.codeproject.com/Messages/1889106/Re-named-items-and-jScript-stack-overflow">Re: named items and jScript - stack overflow !</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">11-Feb-07  16:39</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>11-Feb-07  16:39&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1889106_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1852226);" href="https://www.codeproject.com/Messages/1852226/Re-named-items-and-jScript-stack-overflow"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>How bizarre.<br>
<br>
Personally, I think that JScript is really broken and buggy (even moreso
 than VBScript). I try to stay away from JScript for this reason. I 
consider it an un-finished product.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1851880" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1889106" name="react-item_1889106" id="MRF1889106" class="reaction-result"></span><span data-objectref="3_1889106" data-votingtype="GoodOrBad" name="RateItem_1889106" id="MVF1889106" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1889106" href="https://www.codeproject.com/Messages/1889106/Re-named-items-and-jScript-stack-overflow" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834103_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx1834103xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1834103" parent="0" thread="1834103" href="https://www.codeproject.com/Messages/1834103/Embed-ActiveX-in-HTML">Embed ActiveX in HTML</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">xfinger</span><span class="date">8-Jan-07  9:45</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203993">xfinger</a></span></td><td class="date"><span>8-Jan-07  9:45&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834103_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I was wondering if your next article could be ActiveX in plain C, part 9......<br>
<br>
Great article<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1834103" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1834103" name="react-item_1834103" id="MRF1834103" class="reaction-result"></span><span data-objectref="3_1834103" data-votingtype="GoodOrBad" name="RateItem_1834103" id="MVF1834103" class="rating-result"><span>2.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1834103" href="https://www.codeproject.com/Messages/1834103/Embed-ActiveX-in-HTML" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834134_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx1834134xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1834134" parent="1834103" thread="1834103" href="https://www.codeproject.com/Messages/1834134/Re-Embed-ActiveX-in-HTML">Re: Embed ActiveX in HTML</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">xfinger</span><span class="date">8-Jan-07  10:08</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203993">xfinger</a></span></td><td class="date"><span>8-Jan-07  10:08&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834134_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1834103);" href="https://www.codeproject.com/Messages/1834103/Embed-ActiveX-in-HTML"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Sorry,<br>
<br>
I mean ActiveX plugin in HTML..<img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/smiley_redface.gif" align="top" alt="Blush | :O"><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1834103" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1834134" name="react-item_1834134" id="MRF1834134" class="reaction-result"></span><span data-objectref="3_1834134" data-votingtype="GoodOrBad" name="RateItem_1834134" id="MVF1834134" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1834134" href="https://www.codeproject.com/Messages/1834134/Re-Embed-ActiveX-in-HTML" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834282_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx1834282xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1834282" parent="1834134" thread="1834103" href="https://www.codeproject.com/Messages/1834282/Re-Embed-ActiveX-in-HTML">Re: Embed ActiveX in HTML</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">8-Jan-07  11:50</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>8-Jan-07  11:50&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834282_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1834134);" href="https://www.codeproject.com/Messages/1834134/Re-Embed-ActiveX-in-HTML"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Not
 sure what you mean by "HTML plugin". You can use any COM component that
 supports a script language (ie, Article 2 of this series) in any script
 code in an HTML SCRIPT tag.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1834103" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1834282" name="react-item_1834282" id="MRF1834282" class="reaction-result"></span><span data-objectref="3_1834282" data-votingtype="GoodOrBad" name="RateItem_1834282" id="MVF1834282" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1834282" href="https://www.codeproject.com/Messages/1834282/Re-Embed-ActiveX-in-HTML" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834419_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx1834419xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="1834419" parent="1834282" thread="1834103" href="https://www.codeproject.com/Messages/1834419/Re-Embed-ActiveX-in-HTML">Re: Embed ActiveX in HTML</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">xfinger</span><span class="date">8-Jan-07  14:57</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=203993">xfinger</a></span></td><td class="date"><span>8-Jan-07  14:57&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1834419_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1834282);" href="https://www.codeproject.com/Messages/1834282/Re-Embed-ActiveX-in-HTML"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Just like Media Player.<br>
<br>
&lt;object id="MyActiveX" width="400" height="300<br>
CLASSID="CLSID:92f6f312-b0f6-11d0-94ab-0080c74c7f95"<br>
CODEBASE="http://192.168.10.100/activex/MyActiveX.cab"<br>
STANDBY="Loading" myactivex..."<br>
&lt;param="" name="MyParam1" value="1"&gt;<br>
&lt;param name="MyParam2" value="true" /&gt;<br>
<br>
<br>
How can i interact with PARAM tag?<br>
Would you have a sample for this?<br>
<br>
Thanks<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1834103" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1834419" name="react-item_1834419" id="MRF1834419" class="reaction-result"></span><span data-objectref="3_1834419" data-votingtype="GoodOrBad" name="RateItem_1834419" id="MVF1834419" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1834419" href="https://www.codeproject.com/Messages/1834419/Re-Embed-ActiveX-in-HTML" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4762023_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="92px" class="indent"><a name="xx4762023xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4762023" parent="1834419" thread="1834103" href="https://www.codeproject.com/Messages/4762023/Re-Embed-ActiveX-in-HTML">Re: Embed ActiveX in HTML</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Elmue</span><span class="date">18-Feb-14  11:21</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=480064">Elmue</a></span></td><td class="date"><span>18-Feb-14  11:21&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F4762023_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1834419);" href="https://www.codeproject.com/Messages/1834419/Re-Embed-ActiveX-in-HTML"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That's easy.<br>
You only have to read the documentation in the MSDN:<br>
<br>
<div class="pre-lang" id="premain73222"><div></div><div class="pre-action-link"><span class="code-collapse" data-index="73222" id="preShrink73222">Shrink ▲</span> &nbsp; <span id="copycode73222" class="copy-code" data-index="73222" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div>
<pre id="pre73222" style="margin-top:0;" data-allowshrink="True" data-collapse="False" data-codeblock-processed="true" class="notranslate">IHtmlObjectElement-&gt;get_object()</pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1834103" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_4762023" name="react-item_4762023" id="MRF4762023" class="reaction-result"></span><span data-objectref="3_4762023" data-votingtype="GoodOrBad" name="RateItem_4762023" id="MVF4762023" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="4762023" href="https://www.codeproject.com/Messages/4762023/Re-Embed-ActiveX-in-HTML" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F1832930_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx1832930xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_news.gif" alt="News" title="News"></td><td class="subject hover-container"><a class="message-link" name="1832930" parent="0" thread="1832930" href="https://www.codeproject.com/Messages/1832930/More-example-code-modified">More example code [modified]</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">Jeff Glatt</span><span class="date">7-Jan-07  20:20</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=88625">Jeff Glatt</a></span></td><td class="date"><span>7-Jan-07  20:20&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F1832930_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">I'm not sure when I'll get around to finishing the next 
two planned installments of the series, so I'm releasing the source code
 for those who wish to jump in without benefit of an accompanying 
tutorial. (I very liberally comment code, so the examples should be 
quite informative even without a tutorial).<br>
<br>
The next installment concerns writing your own Script Debugger. The code is at:<br>
<br>
http://home.roadrunner.com/~jgglatt/debughost.zip<br>
<br>
After this comes the big one -- writing an ActiveX Script Engine, with 
debugging support, entirely in C. I originally looked at the 
one-and-only, publically-available example source I've ever seen; an 
engine called SampleScript from Microsoft.<br>
<br>
The sample is very, very... well, questionable. First of all, it leaks 
memory like a broken faucet. Secondly, some very important 
implementation was missing, such as no working InterruptScriptThread(), 
not being able to assign a COM object to a script variable, etc. 
Finally, a lot of the implementation was flat-out incorrect, such as 
GetScriptThreadState(), GetScriptThreadID(), and some other 
"free-threaded" functions being restricted to the base thread, 
EnumCodeContextsOfPosition() not supporting numerous contexts, stack 
frame enumeration not being reentrant nor working across "boundaries", 
etc, etc, etc. It's really, really buggy code.<br>
<br>
I fixed all of the problems, incorrect implementation, and memory leaks I
 could find. I also added some additional features to the engine, and 
rechristened it CMinus (ie, a simplified version of C, minus struct 
support, that can access COM objects).<br>
<br>
The code is at:<br>
<br>
http://home.roadrunner.com/~jgglatt/cminus.zip<br>
<br>
The CMinus engine works with the above Debugger, so you can see how 
ActiveX debugging works right down through an example engine. (MS' 
SampleScript engine crashes horribly with any script debugger. I'm not 
sure how anyone actually tested this code).<br>
<br>
<br>
<br>
<br>
 -- modified at 0:09 Tuesday 9th October, 2007<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1832930" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_1832930" name="react-item_1832930" id="MRF1832930" class="reaction-result"></span><span data-objectref="3_1832930" data-votingtype="GoodOrBad" name="RateItem_1832930" id="MVF1832930" class="rating-result"><span>2.00/5 (1 vote)</span></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="1832930" href="https://www.codeproject.com/Messages/1832930/More-example-code-modified" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3300997_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx3300997xx"></a><img height="16px" width="16px" align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="3300997" parent="1832930" thread="1832930" href="https://www.codeproject.com/Messages/3300997/Re-More-example-code">Re: More example code</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a><div class="mobile-only">
	<span class="author">AlexXF</span><span class="date">11-Dec-09  3:38</span>
</div></td><td class="icon"><img style="border:0;width:16px;height:16px" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/icn-member-16.gif" title="Member"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1260017">AlexXF</a></span></td><td class="date"><span>11-Dec-09  3:38&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3300997_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow noopener" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,1832930);" href="https://www.codeproject.com/Messages/1832930/More-example-code-modified"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Sorry, but examples missing. Error 404<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/17038/COM-in-plain-C-part-8" rel="nofollow noopener">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=1832930" title="View&nbsp;Thread" rel="nofollow noopener">View&nbsp;Thread</a></td><td style="text-align:right;"><span data-objectref="3_3300997" name="react-item_3300997" id="MRF3300997" class="reaction-result"></span><span data-objectref="3_3300997" data-votingtype="GoodOrBad" name="RateItem_3300997" id="MVF3300997" class="rating-result"></span><a class="border-none" onclick="return forumCtrl_ctl00_MessageBoard.ShowPermaLink(this);" data-permalink="true" data-msgid="3300997" href="https://www.codeproject.com/Messages/3300997/Re-More-example-code" rel="nofollow noopener"><img src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/share.png" style="width:14px;height:14px;border:0"></a>&nbsp;</td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 27-Aug-23  0:42</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/17038/COM-in-plain-C-part-8?fid=373296&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=16"><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				
				

				

                <div id="ctl00_RHSticky" class="container-article-info-sticky sticky">

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="senseai" data-country="US" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&sz=300x250&c=822724"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&sz=300x250&c=822724"  width="300px" height="250px" target="_blank"/></a></noscript></div>
					</div>

        		    

<div class="article-summary">

    <ul class="prize-list">
<li>MFC/C++ Dec 2006 </li>
</ul>
    

</div>

				    

                    

				    

				    

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Programming-LanguagesC" data-country="US" data-loadonview="true" data-tags="VC6, C++, C, Windows, Visual-Studio, Dev, COM, Intermediate,rating4.5"><noscript><a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=300x250&c=822724"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Programming-LanguagesC&sz=300x250&c=822724"  width="300px" height="250px" target="_blank"/></a></noscript></div>
					</div>

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8">Permalink</a><br>
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/17038/COM-in-plain-C-part-8?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2007 by Jeff Glatt<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2023 <br>
                <br>
				Web03 
				2.8:2023-08-14:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/DFPAudiencePixel" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript"> // IMMEDIATE script

function Join() {
    document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
    return false;
}

var dhraldoizt = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new dhraldoizt).init()}catch(i){(new dhraldoizt).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new dhraldoizt).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('<div class="small-text muted hidden">Advertisement</div>');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() > 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;
var forumCtrl_ctl00_MessageBoard_reaction;
var forumCtrl_ctl00_MessageBoard__reactionConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 373296,
};
var subscriptions_ctl00_MessageBoard;
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	MicroModal.init();
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar && sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc && !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_17038_1',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            88625,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    allowReactions      : false,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    reactionControl     : null,
	    codeblockProcessor  : new CodeBlocks(),
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in-out',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our <a href=\'/info/cookie.aspx\'>Cookie Policy</a>, <a href=\'/info/privacy.aspx\'>Privacy Policy</a>, and our <a href=\'/info/TermsOfUse.aspx\'>Terms of Service</a>.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><script type="text/javascript">if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",CloseAdImageUrl="https://cdn1.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://cdn1.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png";String.prototype.includes||(String.prototype.includes=function(n,t){"use strict";return(typeof t!="number"&&(t=0),t+n.length>this.length)?!1:this.indexOf(n,t)!==-1});var DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&&n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="<select class='reportReason' style='max-width:150px !important; padding: 0px !important'><option>Offensive<\/option><option>Abusive<\/option><option>Off topic<\/option><option>Don't like the Ad<\/option > <option>Wrong language<\/option><\/select > ",f="<input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'><\/input>";return t===728&&i===90?k(r,u,f):t===300&&i===250?d(r,u,f):t===160&&i===600?g(r,u,f):t===125&&i===125&&nt(r),(t===728&&i===90||t===300&&i===250||t===160&&i===600)&&tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'><div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'>1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here<\/div><div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"&nbsp;"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'><\/a>";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'><div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/>2. Drag and Drop or paste the screenshot here<\/div><div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '> "+i+"<\/div><div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'><\/a>";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="<div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'><div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/><br/>2. Drag and Drop or paste the screenshot here<\/div><div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"<\/div><div style='font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'><\/a>";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="<div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'><span style='color:#999;'>Thank you for the report!<\/span><\/div>";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&&n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&&(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="<br/><br/>Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&&t.height===600?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===300&&t.height===250?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":t.width===728&&t.height===90?"Your screenshot has been received – thanks! Next step: What’s wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&&(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&&(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&&r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&&(u.style.display="none");f&&(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&&n.fileList.length>0&&(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&&(l=n.clipboardData||n.originalEvent.clipboardData,s=l&&l.items||[],t=[],s&&s.length>0))for(h=!0,c=0;c<s.length;c++)a=s[c],a.kind==="file"&&(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&&t.length>0?(v=i(f),v&&(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="<br/><br/> No files found on clipboard <br/>",u(f)):(n.currentTarget.innerHTML="<br/><br/> Paste not supported on your browser <br/>",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&&n.dataTransfer.files.length>0)for(t=0;t<n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&&n.dataTransfer.files[t].type.indexOf("image")>=0&&(r[r.length]=n.dataTransfer.files[t]);r.length>0?(f&&(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="<br/><br/>The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&&t.style.display!=="none"&&t.src&&(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&&(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},i=function(t){for(var i=0,r=n.length;i<r;i++)if(n[i]&&n[i].adContainer&&n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&&window.MutationObserver&&(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&&y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")>=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i>0&&(o=new Date,o.setTime(o.getTime()+i*864e5))&&(e+="; expires="+o.toGMTString());r&&(e+="; path="+r);u&&u.indexOf(".")!==-1&&(e+="; domain="+u);f&&(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index<t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&&JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&&r.Id&&r.Id===n.Id&&(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&&c(i)},c=function(t){for(n=t;i.length>0;){var r=i.pop();typeof r=="function"&&r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={PageQueryTerms:"",PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:"",PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:"loading",PIIViolatingUrls:["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t<r.length;t++)if(i=r[t],n.indexOf(i.d)>=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r<0||r+n.length>=t.length?"":(u=t.indexOf("&",r),u<0&&(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);if(t!==""&&(i=e(f(t,n))),i===""){if(n=document.referrer.toLocaleLowerCase(),!n)return"";t=u(n);t!==""&&(i=e(f(t,n)))}DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&&n();return}DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&&(i.SearchTerms&&(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&&(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&&i.aid.length&&i.aid.length>0&&DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&&n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)}},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t<i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r<n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&&(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&&i(n))},e=null;r&&(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&&(e&&clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&&clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&&clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&&window.top.postMessage&&setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},CreateAds:function(n){this.PageRandomNumber=DMAds.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==="weLoadedGPT"?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=e.height*-1);o=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;s=i>t.left&&t.right>=0;u=o&&s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n<DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&&l(n)&&u(n)&&e(n),t.rendered&&(i++,t.sticky&&!t.stickySettings&&(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&&clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n<DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&&(s=!1),!s&&u(n)&&e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o<DMAds.Ads.length&&!r;o++)if(r=!u(o),r)break;r&&(f=setInterval(t,100))};DMAds.GPTRenderingMode==="loading"?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange");n&&document.addEventListener&&document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&&(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&&n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&&(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i<DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&&n.adContainer&&(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,f=DMAds.Ads[n].theAdDiv,u,h,s;if(i&&i.isStickyRequired&&t.getBoundingClientRect&&document.getElementsByClassName){u=document.getElementsByClassName("sticky-stop")[0];u&&(h=r(u),s=u.getBoundingClientRect());var c=r(t),e=t.getBoundingClientRect(),o,l=c.y+e.height+Math.abs(e.top)>h.y;u&&l&&s.top<e.height?o=s.top-e.height+"px":window.pageYOffset+10>=i.absoluteTop&&(o="10px");o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",f.clientHeight===0&&(f.style.height=t.clientHeight+"px"),f.clientWidth===0&&(f.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition}},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&&t.style.position!=="fixed"&&t.offsetParent?i=!0:t&&t.style.position==="fixed"&&(r=window.getComputedStyle(t),i=r&&r.display!=="none"),i&&v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&&(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length>0&&(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))},ShowAd:function(n){var t=DMAds.Ads,i;if(n&&(DMAds.GPTRenderingMode!=="weLoadedGPT"||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==="weLoadedGPT"&&DMAds.PublisherPageViewGuid){while(t&&t.length>0)i=t.pop(),DMAds.RequestQueuedAd(i);n&&DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){if(googletag){var n=function(){if(googletag.pubadsReady)DMAds.GPTRenderingMode!=="weLoadedGPT"&&(DMAds.GPTRenderingMode="gptAlreadyLoaded");else{if(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),DMAds.Ads&&DMAds.Ads[0]&&typeof DMAds.Ads[0].cookieConsent!="undefined"){var n=DMAds.Ads[0].cookieConsent?1:0;googletag.pubads().setRequestNonPersonalizedAds(n?0:1)}googletag.pubads().enableAsyncRendering();googletag.enableServices();DMAds.GPTRenderingMode="weLoadedGPT";googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})}};googletag.apiReady?n():googletag.cmd.push(function(){n()})}},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length<2048&&(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f=n.cookieConsent!==undefined,e=n.cookieConsent?1:0,o="<div id='"+t+"'>     <script type='text/javascript'>         googletag.cmd.push(function() {             if ( "+f+" && typeof googletag.pubads == 'function') {               googletag.pubads().setRequestNonPersonalizedAds("+e+" ? 0 : 1);            }            googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     <\/script> <\/div>";return"<script type='text/javascript'> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); <\/script>"+o},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\<\>\[\]]/gi,"");for(var r=t.split(","),u=[];r.length>0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&&n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r>=0&&(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&&(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=DMAds.PIIViolatingUrls.length;n<r&&t;n++)t=!(i.indexOf(DMAds.PIIViolatingUrls[n])>=0)}catch(u){console.log("Error in IsPagePIICompliant: "+u)}return t},OnSlotRendered:function(n){if(window.location.href&&window.location.href.includes("show_creative_id=1")&&n&&n.creativeId&&console.log(n.creativeId),EnableMutableAds&&n&&!n.isEmpty&&(!n.lineItemId||n.lineItemId&&n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&&n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&&(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u<s;u++)h.test(f[u].getAttribute(n))&&(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r<o;r++)s.test(u[r].className)&&(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length<=0)&&(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t<n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var u,f,r,o=n.attributes,s=o.length,i={},e=0;e<s;e++)u=o.item(e),u.nodeName.indexOf("lqm_")===0&&(f=u.nodeName.slice(4),i[f]=u.value||u.nodeValue),u.nodeName.indexOf("data-")===0&&(f=u.nodeName.slice(5),i[f]=u.value||u.nodeValue);return r={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,cookieConsent:i.cookieconsent,theAdDiv:n},r.tags&&(r.tags=decodeURIComponent(r.tags)),DMAds.DetermineTagSize(r),r.publisher&&r.publisher===CodeProjectPublisherId&&(r.articleid=DMAds.GetArticleId(r.publisher)),r},SetupAds:function(){DMAds.IsPagePIICompliant()&&(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),DMAds.CreateAds())},Initialise:function(){if(DMAds.IsPagePIICompliant())if(window.googletag)DMAds.SetupAds();else{var t="https:"===document.location.protocol,n=document.createElement("script");n.async=!0;n.type="text/javascript";n.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";n.onload=this.SetupAds;document.body.appendChild(n)}}};window.DMAds=DMAds}if(DMAds.IsPagePIICompliant())if(window.addEventListener)window.addEventListener("load",function(){DMAds.Initialise()},!1);else try{window.attachEvent("onload",function(){DMAds.Initialise()})}catch(e){DMAds.Initialise()}</script><script async="" type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/gpt.js"></script><script async="" type="text/javascript" src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/gpt.js"></script><div style="position: fixed; z-index: 9999; height: 289px;" id="credential_picker_container"><iframe src="COM%20in%20plain%20C,%20part%208%20-%20CodeProject_files/select.html" title="Sign in with Google Dialog" style="height: 289px; width: 391px; overflow: hidden;"></iframe></div><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div></body></html>